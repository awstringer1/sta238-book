<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Extended Example: Reasoning About Goodness of Fit | Probability, Statistics, and Data Analysis</title>
  <meta name="description" content="This book represents part of the course materials for STA238 at the University of Toronto" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Extended Example: Reasoning About Goodness of Fit | Probability, Statistics, and Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book represents part of the course materials for STA238 at the University of Toronto" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Extended Example: Reasoning About Goodness of Fit | Probability, Statistics, and Data Analysis" />
  
  <meta name="twitter:description" content="This book represents part of the course materials for STA238 at the University of Toronto" />
  

<meta name="author" content="Alison Gibbs and Alex Stringer" />


<meta name="date" content="2021-01-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="section-confidence-intervals-and-quantifying-uncertainty.html"/>
<link rel="next" href="section-bayesian-inference-estimation.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STA238 University of Toronto</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><i class="fa fa-check"></i><b>2</b> Introduction to Data Analysis: Data Input and Basic Summaries</a>
<ul>
<li class="chapter" data-level="2.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-old-faithful"><i class="fa fa-check"></i><b>2.1</b> Old Faithful</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-read-in-the-data"><i class="fa fa-check"></i><b>2.1.1</b> Read in the data</a></li>
<li class="chapter" data-level="2.1.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-graphical-summaries"><i class="fa fa-check"></i><b>2.1.2</b> Graphical Summaries</a></li>
<li class="chapter" data-level="2.1.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-numerical-summaries"><i class="fa fa-check"></i><b>2.1.3</b> Numerical Summaries</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-drilling"><i class="fa fa-check"></i><b>2.2</b> Drilling</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-read-in-data"><i class="fa fa-check"></i><b>2.2.1</b> Read in data</a></li>
<li class="chapter" data-level="2.2.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-graphical-summaries-1"><i class="fa fa-check"></i><b>2.2.2</b> Graphical summaries</a></li>
<li class="chapter" data-level="2.2.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-numerical-summaries-1"><i class="fa fa-check"></i><b>2.2.3</b> Numerical summaries</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-exercises"><i class="fa fa-check"></i><b>2.3</b> Exercises</a></li>
<li class="chapter" data-level="2.4" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-extended-example-smoking-and-age-and-mortality"><i class="fa fa-check"></i><b>2.4</b> Extended example: smoking and age and mortality</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-exercises-1"><i class="fa fa-check"></i><b>2.4.1</b> Exercises</a></li>
<li class="chapter" data-level="2.4.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-association-between-smoking-and-mortality"><i class="fa fa-check"></i><b>2.4.2</b> Association between smoking and mortality</a></li>
<li class="chapter" data-level="2.4.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-exercises-2"><i class="fa fa-check"></i><b>2.4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-case-study-rental-housing-in-toronto"><i class="fa fa-check"></i><b>2.5</b> Case study: rental housing in Toronto</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-load-the-data"><i class="fa fa-check"></i><b>2.5.1</b> Load the data</a></li>
<li class="chapter" data-level="2.5.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-analysis-i-what-does-the-data-look-like"><i class="fa fa-check"></i><b>2.5.2</b> Analysis I: what does the data look like?</a></li>
<li class="chapter" data-level="2.5.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-analysis-ii-do-different-wards-have-different-quality-housing"><i class="fa fa-check"></i><b>2.5.3</b> Analysis II: Do different wards have different quality housing?</a></li>
<li class="chapter" data-level="2.5.4" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-analysis-iii-trends-in-quality-over-time"><i class="fa fa-check"></i><b>2.5.4</b> Analysis III: trends in quality over time</a></li>
<li class="chapter" data-level="2.5.5" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-summary"><i class="fa fa-check"></i><b>2.5.5</b> Summary</a></li>
<li class="chapter" data-level="2.5.6" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-exercises-3"><i class="fa fa-check"></i><b>2.5.6</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><i class="fa fa-check"></i><b>3</b> Introduction to Statistics: Law of Large Numbers and Central Limit Theorem</a>
<ul>
<li class="chapter" data-level="3.1" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html#section-law-of-large-numbers-chapter-13"><i class="fa fa-check"></i><b>3.1</b> Law of Large Numbers (Chapter 13)</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html#section-extended-example-the-probability-of-heads"><i class="fa fa-check"></i><b>3.1.1</b> Extended example: the probability of heads</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html#section-central-limit-theorem-chapter-14"><i class="fa fa-check"></i><b>3.2</b> Central Limit Theorem (Chapter 14)</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html#section-extended-example-the-probability-of-heads-1"><i class="fa fa-check"></i><b>3.2.1</b> Extended example: the probability of heads</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="section-statistical-models.html"><a href="section-statistical-models.html"><i class="fa fa-check"></i><b>4</b> Statistical Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-statistical-models-chapter-17"><i class="fa fa-check"></i><b>4.1</b> Statistical models (Chapter 17)</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-linear-regression"><i class="fa fa-check"></i><b>4.1.1</b> Linear Regression</a></li>
<li class="chapter" data-level="4.1.2" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-extended-example-ttc-ridership-revenues"><i class="fa fa-check"></i><b>4.1.2</b> Extended example: TTC ridership revenues</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-unbiased-estimators-chapter-19"><i class="fa fa-check"></i><b>4.2</b> Unbiased Estimators (Chapter 19)</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-simulated-data"><i class="fa fa-check"></i><b>4.2.1</b> Simulated data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><a href="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><i class="fa fa-check"></i><b>5</b> Evaluating Estimators: Efficiency and Mean Squared Error</a>
<ul>
<li class="chapter" data-level="5.1" data-path="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><a href="section-evaluating-estimators-efficiency-and-mean-squared-error.html#section-estimating-a-uniform-maximum"><i class="fa fa-check"></i><b>5.1</b> Estimating a Uniform Maximum</a></li>
<li class="chapter" data-level="5.2" data-path="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><a href="section-evaluating-estimators-efficiency-and-mean-squared-error.html#section-efficiency"><i class="fa fa-check"></i><b>5.2</b> Efficiency</a></li>
<li class="chapter" data-level="5.3" data-path="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><a href="section-evaluating-estimators-efficiency-and-mean-squared-error.html#section-mean-squared-error"><i class="fa fa-check"></i><b>5.3</b> Mean Squared Error</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html"><i class="fa fa-check"></i><b>6</b> Introduction to Bayesian Inference</a>
<ul>
<li class="chapter" data-level="6.1" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-tutorial"><i class="fa fa-check"></i><b>6.1</b> Tutorial</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-frequentistlikelihood-perspective"><i class="fa fa-check"></i><b>6.1.1</b> Frequentist/Likelihood Perspective</a></li>
<li class="chapter" data-level="6.1.2" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-bayesian-inference-introduction"><i class="fa fa-check"></i><b>6.1.2</b> Bayesian Inference: introduction</a></li>
<li class="chapter" data-level="6.1.3" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-flipping-more-coins"><i class="fa fa-check"></i><b>6.1.3</b> Flipping More Coins</a></li>
<li class="chapter" data-level="6.1.4" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-visualization"><i class="fa fa-check"></i><b>6.1.4</b> Visualization</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-interactive-app"><i class="fa fa-check"></i><b>6.2</b> Interactive App</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="section-the-bootstrap.html"><a href="section-the-bootstrap.html"><i class="fa fa-check"></i><b>7</b> The Bootstrap</a>
<ul>
<li class="chapter" data-level="7.1" data-path="section-the-bootstrap.html"><a href="section-the-bootstrap.html#section-the-bootstrap-chapter-18"><i class="fa fa-check"></i><b>7.1</b> The Bootstrap (Chapter 18)</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="section-the-bootstrap.html"><a href="section-the-bootstrap.html#section-empirical-bootstrap-old-faithful-data"><i class="fa fa-check"></i><b>7.1.1</b> Empirical bootstrap: Old Faithful data</a></li>
<li class="chapter" data-level="7.1.2" data-path="section-the-bootstrap.html"><a href="section-the-bootstrap.html#section-parametric-bootstrap-software-data"><i class="fa fa-check"></i><b>7.1.2</b> Parametric Bootstrap: software data</a></li>
<li class="chapter" data-level="7.1.3" data-path="section-the-bootstrap.html"><a href="section-the-bootstrap.html#section-extended-example-the-standard-error-of-a-proportion"><i class="fa fa-check"></i><b>7.1.3</b> Extended example: the standard error of a proportion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html"><i class="fa fa-check"></i><b>8</b> Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="8.1" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html#section-maximum-likelihood-chapter-21"><i class="fa fa-check"></i><b>8.1</b> Maximum Likelihood (Chapter 21)</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html#section-example-two-coins"><i class="fa fa-check"></i><b>8.1.1</b> Example: two coins</a></li>
<li class="chapter" data-level="8.1.2" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html#section-example-unknown-coins-n-2"><i class="fa fa-check"></i><b>8.1.2</b> Example: unknown coins, <span class="math inline">\(n = 2\)</span></a></li>
<li class="chapter" data-level="8.1.3" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html#section-example-unknown-coins-n-bigger-than-2"><i class="fa fa-check"></i><b>8.1.3</b> Example: unknown coins, <span class="math inline">\(n\)</span> bigger than <span class="math inline">\(2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html#section-extended-example-rental-housing-in-toronto"><i class="fa fa-check"></i><b>8.2</b> Extended example: rental housing in Toronto</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html"><i class="fa fa-check"></i><b>9</b> Confidence Intervals and Quantifying Uncertainty</a>
<ul>
<li class="chapter" data-level="9.1" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-confidence-intervals-for-the-mean-chapter-23"><i class="fa fa-check"></i><b>9.1</b> Confidence Intervals for the Mean (Chapter 23)</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-simulation-an-example"><i class="fa fa-check"></i><b>9.1.1</b> Simulation: an example</a></li>
<li class="chapter" data-level="9.1.2" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-gross-calorific-value-measurements-for-osterfeld-262de27"><i class="fa fa-check"></i><b>9.1.2</b> Gross calorific value measurements for Osterfeld 262DE27</a></li>
<li class="chapter" data-level="9.1.3" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-when-you-dont-know-sigma"><i class="fa fa-check"></i><b>9.1.3</b> When you don’t know <span class="math inline">\(\sigma\)</span></a></li>
<li class="chapter" data-level="9.1.4" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-gross-calorific-value-measurements-for-daw-mill-258gb41"><i class="fa fa-check"></i><b>9.1.4</b> Gross calorific value measurements for Daw Mill 258GB41</a></li>
<li class="chapter" data-level="9.1.5" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>9.1.5</b> Bootstrap Confidence Intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html"><i class="fa fa-check"></i><b>10</b> Extended Example: Reasoning About Goodness of Fit</a>
<ul>
<li class="chapter" data-level="10.1" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-go-and-read-the-blog-post"><i class="fa fa-check"></i><b>10.1</b> Go and read the blog post</a></li>
<li class="chapter" data-level="10.2" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-distribution-of-last-digits"><i class="fa fa-check"></i><b>10.2</b> Distribution of last digits</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-read-in-the-data-1"><i class="fa fa-check"></i><b>10.2.1</b> Read in the data</a></li>
<li class="chapter" data-level="10.2.2" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-make-the-histogram"><i class="fa fa-check"></i><b>10.2.2</b> Make the histogram</a></li>
<li class="chapter" data-level="10.2.3" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-testing-goodness-of-fit-simulation"><i class="fa fa-check"></i><b>10.2.3</b> Testing goodness of fit: simulation</a></li>
<li class="chapter" data-level="10.2.4" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-testing-goodness-of-fit-math"><i class="fa fa-check"></i><b>10.2.4</b> Testing goodness of fit: math</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html"><i class="fa fa-check"></i><b>11</b> Bayesian Inference: Estimation</a>
<ul>
<li class="chapter" data-level="11.1" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-estimation-in-bayesian-inference-general-ideas"><i class="fa fa-check"></i><b>11.1</b> Estimation in Bayesian Inference: general ideas</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-the-prior"><i class="fa fa-check"></i><b>11.1.1</b> The Prior</a></li>
<li class="chapter" data-level="11.1.2" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-the-posterior"><i class="fa fa-check"></i><b>11.1.2</b> The Posterior</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-estimation-in-bayesian-inference-point-and-interval-estimation"><i class="fa fa-check"></i><b>11.2</b> Estimation in Bayesian Inference: point and interval estimation</a></li>
<li class="chapter" data-level="11.3" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-choosing-a-prior"><i class="fa fa-check"></i><b>11.3</b> Choosing a Prior</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-conjugate-priors"><i class="fa fa-check"></i><b>11.3.1</b> Conjugate Priors</a></li>
<li class="chapter" data-level="11.3.2" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-setting-hyperparameters-by-moment-matching"><i class="fa fa-check"></i><b>11.3.2</b> Setting Hyperparameters by moment-matching</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html"><i class="fa fa-check"></i><b>12</b> Predictive Modelling</a>
<ul>
<li class="chapter" data-level="12.1" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html#section-overview"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html#section-plug-in-prediction-coin-flipping"><i class="fa fa-check"></i><b>12.2</b> Plug-in prediction: coin flipping</a></li>
<li class="chapter" data-level="12.3" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html#section-bayesian-prediction-coin-flipping"><i class="fa fa-check"></i><b>12.3</b> Bayesian Prediction: coin flipping</a></li>
<li class="chapter" data-level="12.4" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html#section-extended-example-predicting-call-centre-wait-times"><i class="fa fa-check"></i><b>12.4</b> Extended example: predicting call centre wait times</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="section-installing-r-and-rstudio.html"><a href="section-installing-r-and-rstudio.html"><i class="fa fa-check"></i><b>13</b> Installing R and RStudio</a>
<ul>
<li class="chapter" data-level="13.1" data-path="section-installing-r-and-rstudio.html"><a href="section-installing-r-and-rstudio.html#section-installing-r"><i class="fa fa-check"></i><b>13.1</b> Installing R</a></li>
<li class="chapter" data-level="13.2" data-path="section-installing-r-and-rstudio.html"><a href="section-installing-r-and-rstudio.html#section-installing-rstudio"><i class="fa fa-check"></i><b>13.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="13.3" data-path="section-installing-r-and-rstudio.html"><a href="section-installing-r-and-rstudio.html#section-using-rmarkdown"><i class="fa fa-check"></i><b>13.3</b> Using RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html"><i class="fa fa-check"></i><b>14</b> Assigned Exercises from MIPS</a>
<ul>
<li class="chapter" data-level="14.1" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapters-15-and-16"><i class="fa fa-check"></i><b>14.1</b> Chapters 15 and 16</a></li>
<li class="chapter" data-level="14.2" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapters-13-and-14"><i class="fa fa-check"></i><b>14.2</b> Chapters 13 and 14</a></li>
<li class="chapter" data-level="14.3" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapters-17-and-19"><i class="fa fa-check"></i><b>14.3</b> Chapters 17 and 19</a></li>
<li class="chapter" data-level="14.4" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapter-20"><i class="fa fa-check"></i><b>14.4</b> Chapter 20</a></li>
<li class="chapter" data-level="14.5" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-evans-and-rosenthal-chapter-7.1"><i class="fa fa-check"></i><b>14.5</b> Evans and Rosenthal, Chapter 7.1</a></li>
<li class="chapter" data-level="14.6" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapter-18"><i class="fa fa-check"></i><b>14.6</b> Chapter 18</a></li>
<li class="chapter" data-level="14.7" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapter-21"><i class="fa fa-check"></i><b>14.7</b> Chapter 21</a></li>
<li class="chapter" data-level="14.8" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapter-23"><i class="fa fa-check"></i><b>14.8</b> Chapter 23</a></li>
<li class="chapter" data-level="14.9" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-evans-and-rosenthal-chapter-7.2"><i class="fa fa-check"></i><b>14.9</b> Evans and Rosenthal, Chapter 7.2</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html"><i class="fa fa-check"></i><b>15</b> Extended Example: World Population Data</a>
<ul>
<li class="chapter" data-level="15.1" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-read-in-and-prepare-the-data-for-analysis"><i class="fa fa-check"></i><b>15.1</b> Read in and prepare the data for analysis</a></li>
<li class="chapter" data-level="15.2" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-model-world-population-over-time"><i class="fa fa-check"></i><b>15.2</b> Model world population over time</a></li>
<li class="chapter" data-level="15.3" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-bayesian-model-for-world-population"><i class="fa fa-check"></i><b>15.3</b> Bayesian model for world population</a></li>
<li class="chapter" data-level="15.4" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-quantifying-uncertainty-in-estimates-of-world-population-regression-model"><i class="fa fa-check"></i><b>15.4</b> Quantifying uncertainty in estimates of world population: regression model</a></li>
<li class="chapter" data-level="15.5" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-bayesian-estimate-of-world-population"><i class="fa fa-check"></i><b>15.5</b> Bayesian estimate of world population</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-estimation-and-uncertainty-quantification"><i class="fa fa-check"></i><b>15.5.1</b> Estimation and uncertainty quantification</a></li>
<li class="chapter" data-level="15.5.2" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-estimation-by-sampling"><i class="fa fa-check"></i><b>15.5.2</b> Estimation by sampling</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-predicting-world-population"><i class="fa fa-check"></i><b>15.6</b> Predicting world population</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-why-arent-our-predictions-accurate"><i class="fa fa-check"></i><b>15.6.1</b> Why aren’t our predictions accurate?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="section-short-tutorial-on-pulling-data-for-assignment-1.html"><a href="section-short-tutorial-on-pulling-data-for-assignment-1.html"><i class="fa fa-check"></i><b>16</b> Short tutorial on pulling data for Assignment 1</a>
<ul>
<li class="chapter" data-level="16.1" data-path="section-short-tutorial-on-pulling-data-for-assignment-1.html"><a href="section-short-tutorial-on-pulling-data-for-assignment-1.html#section-toronto-open-data-portal"><i class="fa fa-check"></i><b>16.1</b> Toronto Open Data Portal</a></li>
<li class="chapter" data-level="16.2" data-path="section-short-tutorial-on-pulling-data-for-assignment-1.html"><a href="section-short-tutorial-on-pulling-data-for-assignment-1.html#section-canadian-election-study"><i class="fa fa-check"></i><b>16.2</b> Canadian Election Study</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Probability, Statistics, and Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-extended-example-reasoning-about-goodness-of-fit" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> Extended Example: Reasoning About Goodness of Fit</h1>
<p>This chapter is a bit different: we introduce the idea of “goodness of fit” through
implementing the analysis in a blog post discussing a disputed paper in a
Psychology journal. You can find the article here: <a href="http://datacolada.org/74">http://datacolada.org/74</a></p>
<div class="sourceCode" id="section-cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb316-1"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div id="section-go-and-read-the-blog-post" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Go and read the blog post</h2>
<p>To start, go read this blog post: <a href="http://datacolada.org/74">http://datacolada.org/74</a>.
This should take you at least an hour or so to do in detail, if not longer.</p>
<p><strong>Exercise</strong>: summarize this study in your own words. Two or three sentences
should suffice. What did they do, how did they do it, and what were they trying
to find out? It is important that you understand this before you move on.</p>
</div>
<div id="section-distribution-of-last-digits" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Distribution of last digits</h2>
<p>The distribution of digits in numeric data is of considerable interest in certain
fields. In forensic accounting, where investigators try to identify fraudulent
accounting practice by identifying systematic anomalies in financial records,
the relative frequency with which different digits occur can indicate potential
fraud if it differs from what you would expect. It is well-established that the
last digit, in particular, of numeric data should be distributed pretty evenly
between the numbers <span class="math inline">\(0 - 9\)</span> in any given set of data.</p>
<p><strong>Remark</strong>: this isn’t trivial; for example, <a href="https://en.wikipedia.org/wiki/Benford%27s_law"><em>Benford’s Law</em></a>
says that this is <em>not</em> true about the <em>first</em> digit in numbers in certain types of financial data.</p>
<p>So, let’s look at the last digit of the measurements from the hand sanitizer study.
The data is available from <a href="http://datacolada.org/appendix/74/">http://datacolada.org/appendix/74/</a> and their <code>R</code> code can be found <a href="http://datacolada.org/appendix/74/74%20-%20DataColada%20-%20Decoy%20Sanitizer%20-%202018%2008%2023.R">here</a>. Here we
use our own <code>R</code> code but I borrow parts from theirs.</p>
<div id="section-read-in-the-data-1" class="section level3" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Read in the data</h3>
<p>First, read in the data as usual:</p>
<div class="sourceCode" id="section-cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb317-1"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb317-1" aria-hidden="true" tabindex="-1"></a>study1 <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="section-cb317-2"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb317-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;http://datacolada.org/appendix/74/Study%201%20-%20Decoy%20Effect.csv&quot;</span>,</span>
<span id="section-cb317-3"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb317-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_names =</span> <span class="cn">TRUE</span>,</span>
<span id="section-cb317-4"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb317-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> stringr<span class="sc">::</span><span class="fu">str_c</span>(<span class="fu">rep</span>(<span class="st">&quot;n&quot;</span>,<span class="dv">42</span>),<span class="at">collapse =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="section-cb317-5"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb317-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="section-cb317-6"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb317-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(study1)</span></code></pre></div>
<pre><code>Rows: 40
Columns: 42
$ Subject                                                   &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, …
$ `Group (1=experimental condition, 0 = control condition)` &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
$ Day1                                                      &lt;dbl&gt; 55, 60, 63, 55, 60, 60, 35, 55, 45, 75, 50, 70, 60, 40, 35, 50, 50, 60, 55, 50, 50, 25, 45, 60, 70, 10, 60, 80, 55, 70, 45, 55, 25, 55, 45,…
$ Day2                                                      &lt;dbl&gt; 45, 55, 40, 50, 40, 20, 40, 40, 50, 55, 45, 55, 45, 45, 50, 55, 45, 50, 55, 60, 60, 35, 45, 65, 15, 25, 50, 60, 50, 45, 50, 50, 45, 35, 60,…
$ Day3                                                      &lt;dbl&gt; 45, 55, 50, 40, 15, 90, 85, 20, 90, 35, 55, 50, 30, 35, 60, 65, 45, 60, 60, 60, 55, 50, 60, 60, 40, 60, 60, 25, 40, 55, 25, 55, 30, 50, 40,…
$ Day4                                                      &lt;dbl&gt; 40, 55, 60, 40, 40, 60, 45, 35, 90, 45, 55, 55, 35, 35, 60, 60, 35, 45, 45, 57, 55, 45, 53, 70, 40, 37, 60, 85, 25, 37, 30, 45, 30, 50, 43,…
$ Day5                                                      &lt;dbl&gt; 45, 50, 25, 45, 75, 65, 55, 30, 55, 60, 53, 50, 50, 40, 65, 63, 47, 40, 55, 60, 53, 40, 47, 63, 47, 40, 64, 95, 43, 33, 30, 53, 25, 43, 43,…
$ Day6                                                      &lt;dbl&gt; 45, 45, 35, 60, 65, 60, 45, 50, 45, 40, 55, 50, 43, 50, 55, 65, 50, 43, 53, 63, 55, 50, 45, 43, 65, 57, 70, 75, 53, 47, 33, 55, 47, 43, 55,…
$ Day7                                                      &lt;dbl&gt; 55, 45, 55, 85, 60, 40, 40, 45, 45, 45, 50, 40, 40, 45, 55, 60, 37, 47, 55, 60, 75, 43, 47, 63, 75, 70, 73, 65, 50, 40, 35, 55, 45, 37, 50,…
$ Day8                                                      &lt;dbl&gt; 60, 40, 40, 55, 55, 37, 37, 60, 90, 50, 55, 45, 40, 30, 63, 60, 35, 35, 50, 60, 40, 34, 30, 60, 78, 60, 70, 65, 47, 30, 33, 45, 37, 32, 47,…
$ Day9                                                      &lt;dbl&gt; 45, 40, 33, 65, 60, 33, 40, 40, 100, 40, 45, 43, 37, 30, 60, 63, 30, 43, 55, 60, 60, 40, 25, 60, 60, 65, 95, 87, 65, 45, 37, 50, 43, 33, 50…
$ Day10                                                     &lt;dbl&gt; 67, 40, 50, 80, 50, 60, 45, 50, 93, 36, 40, 40, 50, 45, 60, 65, 50, 50, 53, 60, 65, 45, 50, 60, 70, 78, 83, 83, 85, 55, 49, 53, 45, 40, 55,…
$ Day11                                                     &lt;dbl&gt; 65, 56, 40, 65, 60, 80, 65, 75, 87, 50, 50, 43, 53, 50, 65, 65, 47, 55, 47, 55, 70, 40, 37, 36, 75, 78, 75, 65, 80, 55, 50, 55, 55, 40, 55,…
$ Day12                                                     &lt;dbl&gt; 70, 40, 50, 65, 60, 60, 45, 55, 80, 60, 55, 43, 45, 55, 65, 60, 55, 55, 50, 55, 70, 40, 55, 55, 75, 70, 73, 53, 88, 58, 45, 50, 40, 55, 40,…
$ Day13                                                     &lt;dbl&gt; 80, 40, 25, 70, 60, 60, 55, 75, 89, 65, 45, 40, 37, 65, 65, 70, 40, 45, 55, 47, 65, 45, 50, 30, 55, 80, 75, 55, 80, 55, 40, 55, 40, 47, 43,…
$ Day14                                                     &lt;dbl&gt; 75, 45, 45, 50, 70, 70, 55, 70, 80, 70, 50, 40, 55, 55, 60, 60, 45, 43, 47, 55, 65, 45, 47, 35, 75, 85, 75, 55, 83, 45, 37, 50, 37, 47, 50,…
$ Day15                                                     &lt;dbl&gt; 70, 50, 50, 65, 60, 65, 55, 75, 75, 75, 50, 45, 55, 55, 65, 55, 45, 55, 40, 57, 70, 45, 40, 40, 80, 80, 67, 75, 85, 50, 45, 55, 40, 45, 40,…
$ Day16                                                     &lt;dbl&gt; 80, 55, 50, 65, 60, 55, 50, 95, 80, 70, 55, 45, 55, 50, 65, 75, 40, 50, 55, 50, 80, 40, 40, 47, 75, 73, 75, 80, 87, 55, 55, 45, 40, 50, 43,…
$ Day17                                                     &lt;dbl&gt; 70, 55, 45, 65, 55, 60, 50, 85, 85, 70, 55, 40, 65, 60, 60, 70, 43, 55, 65, 47, 65, 40, 57, 45, 77, 70, 70, 80, 90, 45, 40, 45, 45, 55, 43,…
$ Day18                                                     &lt;dbl&gt; 75, 50, 45, 55, 55, 55, 45, 80, 80, 60, 50, 40, 60, 50, 55, 70, 40, 50, 55, 45, 65, 43, 57, 45, 80, 70, 70, 70, 90, 55, 45, 45, 45, 50, 45,…
$ Day19                                                     &lt;dbl&gt; 70, 45, 45, 60, 65, 75, 40, 85, 80, 65, 45, 40, 65, 45, 55, 60, 47, 43, 45, 45, 65, 43, 55, 40, 75, 70, 63, 55, 80, 45, 45, 55, 40, 45, 45,…
$ Day20                                                     &lt;dbl&gt; 65, 50, 40, 60, 70, 70, 55, 85, 75, 55, 45, 43, 55, 65, 65, 55, 55, 40, 40, 70, 65, 50, 50, 40, 75, 75, 60, 50, 85, 45, 40, 50, 40, 45, 55,…
$ `Day21 (Beginning of intervention)`                       &lt;dbl&gt; 85, 55, 65, 80, 70, 90, 65, 85, 85, 75, 55, 40, 60, 70, 65, 65, 60, 45, 45, 60, 70, 55, 55, 50, 80, 75, 65, 75, 80, 55, 40, 45, 45, 55, 50,…
$ Day22                                                     &lt;dbl&gt; 85, 75, 65, 75, 75, 45, 50, 95, 60, 55, 50, 45, 65, 55, 55, 60, 55, 55, 40, 45, 85, 60, 50, 25, 75, 85, 60, 30, 90, 45, 40, 60, 50, 55, 50,…
$ Day23                                                     &lt;dbl&gt; 90, 45, 70, 90, 65, 75, 70, 90, 80, 70, 85, 55, 70, 45, 80, 70, 45, 50, 55, 55, 75, 45, 40, 35, 75, 70, 80, 70, 90, 60, 45, 55, 55, 40, 65,…
$ Day24                                                     &lt;dbl&gt; 85, 60, 55, 120, 80, 80, 75, 90, 85, 70, 70, 55, 70, 65, 75, 70, 65, 65, 55, 60, 80, 45, 45, 55, 65, 75, 70, 90, 85, 60, 45, 50, 40, 45, 60…
$ Day25                                                     &lt;dbl&gt; 75, 50, 60, 105, 70, 100, 75, 95, 70, 75, 70, 75, 75, 60, 70, 85, 70, 45, 50, 55, 65, 55, 60, 40, 80, 70, 45, 70, 80, 45, 55, 45, 35, 55, 4…
$ Day26                                                     &lt;dbl&gt; 75, 50, 70, 100, 70, 95, 65, 85, 60, 45, 75, 80, 55, 75, 70, 90, 65, 45, 65, 65, 60, 5, 60, 40, 65, 75, 60, 75, 70, 55, 55, 55, 45, 55, 55,…
$ Day27                                                     &lt;dbl&gt; 65, 35, 55, 95, 55, 75, 60, 70, 70, 70, 80, 60, 75, 45, 75, 75, 35, 15, 60, 70, 75, 50, 55, 45, 60, 45, 35, 65, 85, 35, 50, 55, 20, 45, 40,…
$ Day28                                                     &lt;dbl&gt; 75, 55, 40, 90, 60, 80, 75, 60, 70, 75, 55, 55, 65, 45, 80, 70, 45, 65, 65, 35, 80, 25, 45, 35, 80, 60, 50, 60, 90, 60, 45, 50, 50, 40, 55,…
$ Day29                                                     &lt;dbl&gt; 75, 60, 65, 90, 80, 75, 65, 75, 85, 70, 60, 65, 80, 70, 55, 85, 60, 60, 55, 60, 70, 35, 25, 25, 75, 70, 65, 70, 70, 45, 30, 65, 55, 55, 45,…
$ Day30                                                     &lt;dbl&gt; 80, 55, 65, 80, 85, 80, 60, 70, 75, 60, 65, 70, 75, 85, 75, 70, 65, 65, 70, 60, 60, 55, 35, 40, 70, 75, 75, 85, 75, 50, 50, 45, 50, 50, 60,…
$ Day31                                                     &lt;dbl&gt; 75, 65, 70, 85, 75, 60, 55, 65, 75, 65, 60, 55, 80, 65, 60, 85, 55, 25, 80, 70, 75, 65, 45, 45, 75, 85, 70, 65, 70, 50, 40, 45, 45, 55, 55,…
$ Day32                                                     &lt;dbl&gt; 50, 45, 75, 125, 75, 65, 40, 85, 75, 55, 60, 65, 65, 50, 75, 75, 50, 40, 55, 70, 85, 45, 25, 60, 65, 70, 85, 55, 65, 55, 35, 40, 55, 45, 55…
$ Day33                                                     &lt;dbl&gt; 70, 40, 55, 120, 95, 70, 55, 80, 80, 50, 65, 70, 75, 55, 70, 65, 40, 50, 75, 60, 85, 70, 40, 55, 70, 65, 50, 65, 55, 35, 40, 45, 55, 45, 40…
$ Day34                                                     &lt;dbl&gt; 75, 55, 50, 110, 70, 60, 60, 80, 85, 55, 55, 75, 75, 60, 55, 70, 75, 55, 75, 75, 70, 70, 55, 35, 75, 75, 70, 60, 75, 50, 55, 45, 45, 50, 45…
$ Day35                                                     &lt;dbl&gt; 65, 55, 65, 90, 85, 85, 55, 95, 80, 45, 75, 55, 70, 40, 70, 70, 70, 55, 70, 75, 75, 75, 50, 30, 55, 70, 75, 60, 70, 30, 50, 50, 35, 55, 55,…
$ Day36                                                     &lt;dbl&gt; 75, 60, 45, 95, 90, 75, 60, 90, 85, 70, 65, 80, 90, 65, 65, 75, 45, 65, 75, 65, 75, 55, 45, 55, 55, 75, 55, 70, 65, 55, 45, 45, 45, 50, 45,…
$ Day37                                                     &lt;dbl&gt; 70, 50, 50, 105, 45, 65, 75, 75, 70, 35, 65, 85, 65, 70, 80, 90, 55, 55, 60, 80, 55, 60, 40, 40, 60, 65, 90, 65, 80, 65, 40, 45, 50, 40, 65…
$ Day38                                                     &lt;dbl&gt; 75, 45, 55, 110, 75, 75, 70, 70, 80, 65, 70, 80, 60, 60, 65, 85, 50, 60, 85, 70, 75, 60, 30, 35, 65, 60, 80, 60, 70, 40, 55, 40, 70, 45, 55…
$ Day39                                                     &lt;dbl&gt; 90, 65, 65, 115, 80, 80, 55, 65, 90, 60, 80, 70, 75, 55, 90, 80, 70, 65, 55, 75, 90, 55, 55, 40, 70, 65, 65, 75, 90, 60, 60, 45, 55, 55, 50…
$ Day40                                                     &lt;dbl&gt; 85, 70, 65, 105, 75, 85, 75, 70, 95, 65, 65, 75, 70, 60, 85, 80, 60, 75, 80, 90, 80, 45, 40, 45, 60, 80, 75, 55, 65, 55, 55, 60, 50, 60, 55…</code></pre>
<p><strong>Exercise</strong>: download the data by pasting the link into a web browser.
Print out the header on the command line or open the <code>.csv</code> file in Excel or
otherwise. Verify that the <code>col_names</code> and <code>col_types</code> arguments I provided
are correct.</p>
<p>The data is in “wide” format– each day has its own column. We want one column
for subject ID, one for Day, and one for measurement. Let’s reformat the data:</p>
<div class="sourceCode" id="section-cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb319-1"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb319-1" aria-hidden="true" tabindex="-1"></a>study1_long <span class="ot">&lt;-</span> study1 <span class="sc">%&gt;%</span></span>
<span id="section-cb319-2"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb319-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Day1<span class="sc">:</span>Day40,<span class="at">names_to =</span> <span class="st">&quot;day&quot;</span>,<span class="at">values_to =</span> <span class="st">&quot;measurement&quot;</span>)</span>
<span id="section-cb319-3"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb319-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(study1_long)</span></code></pre></div>
<pre><code>Rows: 1,600
Columns: 4
$ Subject                                                   &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2…
$ `Group (1=experimental condition, 0 = control condition)` &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
$ day                                                       &lt;chr&gt; &quot;Day1&quot;, &quot;Day2&quot;, &quot;Day3&quot;, &quot;Day4&quot;, &quot;Day5&quot;, &quot;Day6&quot;, &quot;Day7&quot;, &quot;Day8&quot;, &quot;Day9&quot;, &quot;Day10&quot;, &quot;Day11&quot;, &quot;Day12&quot;, &quot;Day13&quot;, &quot;Day14&quot;, &quot;Day15&quot;, &quot;Day16&quot;, &quot;Day…
$ measurement                                               &lt;dbl&gt; 55, 45, 45, 40, 45, 45, 55, 60, 45, 67, 65, 70, 80, 75, 70, 80, 70, 75, 70, 65, 85, 85, 90, 85, 75, 75, 65, 75, 75, 80, 75, 50, 70, 75, 65,…</code></pre>
<p>We previously had <span class="math inline">\(40\)</span> subjects each with <span class="math inline">\(40\)</span> columns of measurements; now we
have <span class="math inline">\(1,600\)</span> rows, which looks good to me. Let’s further clean up the data: we
need to</p>
<ol style="list-style-type: decimal">
<li>Rename the colums so they are pleasant (yes, this is important!),</li>
<li>Extract the last digit of each measurement and save it in a new column.</li>
</ol>
<p>Let’s do this. We’ll use the <code>substr</code> function to choose the last digit of each
number. Type <code>?substr</code> to learn about this function.</p>
<div class="sourceCode" id="section-cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb321-1"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb321-1" aria-hidden="true" tabindex="-1"></a>study1_clean <span class="ot">&lt;-</span> study1_long <span class="sc">%&gt;%</span></span>
<span id="section-cb321-2"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb321-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">subject =</span> Subject,</span>
<span id="section-cb321-3"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb321-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">group =</span> <span class="st">`</span><span class="at">Group (1=experimental condition, 0 = control condition)</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="section-cb321-4"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb321-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">last_digit =</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(measurement,<span class="fu">nchar</span>(measurement),<span class="fu">nchar</span>(measurement))))</span>
<span id="section-cb321-5"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb321-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="section-cb321-6"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb321-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(study1_clean)</span></code></pre></div>
<pre><code>Rows: 1,600
Columns: 5
$ subject     &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…
$ group       &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
$ day         &lt;chr&gt; &quot;Day1&quot;, &quot;Day2&quot;, &quot;Day3&quot;, &quot;Day4&quot;, &quot;Day5&quot;, &quot;Day6&quot;, &quot;Day7&quot;, &quot;Day8&quot;, &quot;Day9&quot;, &quot;Day10&quot;, &quot;Day11&quot;, &quot;Day12&quot;, &quot;Day13&quot;, &quot;Day14&quot;, &quot;Day15&quot;, &quot;Day16&quot;, &quot;Day17&quot;, &quot;Day18&quot;, &quot;Day19&quot;, &quot;Day20&quot;, &quot;Day21 (Beginn…
$ measurement &lt;dbl&gt; 55, 45, 45, 40, 45, 45, 55, 60, 45, 67, 65, 70, 80, 75, 70, 80, 70, 75, 70, 65, 85, 85, 90, 85, 75, 75, 65, 75, 75, 80, 75, 50, 70, 75, 65, 75, 70, 75, 90, 85, 60, 55, 55, 55, 50, 45, 4…
$ last_digit  &lt;dbl&gt; 5, 5, 5, 0, 5, 5, 5, 0, 5, 7, 5, 0, 0, 5, 0, 0, 0, 5, 0, 5, 5, 5, 0, 5, 5, 5, 5, 5, 5, 0, 5, 0, 0, 5, 5, 5, 0, 5, 0, 5, 0, 5, 5, 5, 0, 5, 5, 0, 0, 0, 6, 0, 0, 5, 0, 5, 5, 0, 5, 0, 5, 5,…</code></pre>
<p>Looks clean to me!</p>
</div>
<div id="section-make-the-histogram" class="section level3" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Make the histogram</h3>
<p>Okay, now consider Figure 1 in the blog post. <strong>They filter out observations ending in <span class="math inline">\(0\)</span> or <span class="math inline">\(5\)</span></strong>
(remember this later), because the authors of the disputed paper claim to have
occasionally used a scale with <span class="math inline">\(5\)</span>-gram precision, and occasionally one with
<span class="math inline">\(1\)</span>-gram precision (this alone is suspect…). They then make a histogram
of all the last digits. We can do this too:</p>
<div class="sourceCode" id="section-cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb323-1"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb323-1" aria-hidden="true" tabindex="-1"></a>study1_clean <span class="sc">%&gt;%</span></span>
<span id="section-cb323-2"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb323-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(last_digit <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))) <span class="sc">%&gt;%</span></span>
<span id="section-cb323-3"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb323-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> last_digit)) <span class="sc">+</span></span>
<span id="section-cb323-4"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb323-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="section-cb323-5"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb323-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;count&quot;</span>,<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="section-cb323-6"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb323-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>),<span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="section-cb323-7"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb323-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Study 1: Last digit strikingly not uniform&quot;</span>,</span>
<span id="section-cb323-8"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb323-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Last Digit (0&#39;s and 5&#39;s removed)&quot;</span>,</span>
<span id="section-cb323-9"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb323-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Frequency&quot;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/digits-hist-1-1.png" width="672" /></p>
<p>I called this plot a “histogram” (which it is), but I used <code>geom_bar(stat = "count")</code> to create
it. I did this because I wanted the bins to be at specific values. It’s still a histogram (why?).</p>
</div>
<div id="section-testing-goodness-of-fit-simulation" class="section level3" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Testing goodness of fit: simulation</h3>
<p>If you expect the last digits of a set of numbers to be evenly-distributed across
the values <span class="math inline">\(0 - 9\)</span>, then this plot might look surprising. But can we conclude
that something is wrong, just by looking at a plot? What if the real underlying
distribution of digits is actually evenly-distributed, and we just got a weird
sample– we’d be making an incorrect harsh judgement.</p>
<p>We’re going to ask the question: <strong>if the underlying distribution of last digits
really was evenly distributed, what is the probability of seeing the data that
we saw, or a dataset that is even more extreme under this hypothesis?</strong>.</p>
<p>That’s a mouthful! But it’s a good question to ask. If it’s really, really unlikely
that we see what we saw (or something even further) if the claim of even distribution
is true, then this provides <strong>evidence</strong> against the notion that the digits are
actually evenly distributed. And this provides evidence that there is something
funny in the data.</p>
<p>We are going to do a simulation to investigate this claim. We are going to</p>
<ol style="list-style-type: decimal">
<li>Generate a bunch of datasets the same size as ours but where the distribution of the last digit
actually is evenly distributed across <span class="math inline">\(0 - 9\)</span>, and</li>
<li>Record the proportion of digits in each that are <span class="math inline">\(3\)</span> or <span class="math inline">\(7\)</span>, and</li>
<li>Compute the proportion of our simulated datasets that have a proportion
of 3’s or 7’s as high, or higher, as what we saw in our sample.</li>
</ol>
<p>There are a few details that we can’t get exactly right here: the real data was
generated by sampling a bunch of values that ended in <span class="math inline">\(0&#39;s\)</span> or <span class="math inline">\(5&#39;s\)</span> and then filtering
these out, which is behaviour that I don’t know how to replicate exactly. We also
could consider the distribution of <span class="math inline">\(3&#39;s\)</span> and <span class="math inline">\(7&#39;s\)</span> separately, or jointly (using
“and” instead of “or”).</p>
<p>The first question is, how do we generate data that has last digits evenly distributed?
Well, <em>any</em> random numbers should work, but to keep things consistent with the real
data, let’s try generating from a normal distribution with mean and variance equal
to the sample mean and variance of our data, rounded to the nearest integer:</p>
<div class="sourceCode" id="section-cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb324-1"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb324-1" aria-hidden="true" tabindex="-1"></a>mn <span class="ot">&lt;-</span> <span class="fu">mean</span>(study1_clean<span class="sc">$</span>measurement)</span>
<span id="section-cb324-2"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb324-2" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">sd</span>(study1_clean<span class="sc">$</span>measurement)</span>
<span id="section-cb324-3"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb324-3" aria-hidden="true" tabindex="-1"></a>testnumbers <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">10000</span>,mn,ss))</span>
<span id="section-cb324-4"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb324-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a chart of the last digits</span></span>
<span id="section-cb324-5"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb324-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> testnumbers) <span class="sc">%&gt;%</span></span>
<span id="section-cb324-6"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb324-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">last_digit =</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(x,<span class="fu">nchar</span>(x),<span class="fu">nchar</span>(x)))) <span class="sc">%&gt;%</span></span>
<span id="section-cb324-7"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb324-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> last_digit)) <span class="sc">+</span></span>
<span id="section-cb324-8"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb324-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="section-cb324-9"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb324-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;count&quot;</span>,<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="section-cb324-10"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb324-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>),<span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="section-cb324-11"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb324-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Last digits of normal random sample&quot;</span>,</span>
<span id="section-cb324-12"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb324-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Last Digit&quot;</span>,</span>
<span id="section-cb324-13"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb324-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Frequency&quot;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/even-dist-1-1.png" width="672" /></p>
<p>Looks pretty uniform to me! Let’s proceed with our simulation:</p>
<div class="sourceCode" id="section-cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb325-1"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789685</span>)</span>
<span id="section-cb325-2"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function that simulates a dataset</span></span>
<span id="section-cb325-3"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-3" aria-hidden="true" tabindex="-1"></a><span class="co"># and returns the proportion of last digits</span></span>
<span id="section-cb325-4"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-4" aria-hidden="true" tabindex="-1"></a><span class="co"># that are either 3 or 7</span></span>
<span id="section-cb325-5"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-5" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(study1_clean <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(last_digit <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">0</span>)))) <span class="co"># Size of dataset to simulate</span></span>
<span id="section-cb325-6"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-6" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fl">1e04</span> <span class="co"># Number of simulations to do</span></span>
<span id="section-cb325-7"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-7" aria-hidden="true" tabindex="-1"></a>mn <span class="ot">&lt;-</span> <span class="fu">mean</span>(study1_clean<span class="sc">$</span>measurement)</span>
<span id="section-cb325-8"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-8" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">sd</span>(study1_clean<span class="sc">$</span>measurement)</span>
<span id="section-cb325-9"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-9" aria-hidden="true" tabindex="-1"></a>simulate_proportion <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="section-cb325-10"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-10" aria-hidden="true" tabindex="-1"></a>  ds <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(N,mn,ss))</span>
<span id="section-cb325-11"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-11" aria-hidden="true" tabindex="-1"></a>  last_digits <span class="ot">&lt;-</span> <span class="fu">substr</span>(ds,<span class="fu">nchar</span>(ds),<span class="fu">nchar</span>(ds))</span>
<span id="section-cb325-12"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(last_digits <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;3&quot;</span>,<span class="st">&quot;7&quot;</span>))</span>
<span id="section-cb325-13"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="section-cb325-14"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-14" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the proportion of 3&#39;s and 7&#39;s in our data,</span></span>
<span id="section-cb325-15"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-15" aria-hidden="true" tabindex="-1"></a><span class="co"># after filtering out 5&#39;s and 0&#39;s?</span></span>
<span id="section-cb325-16"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-16" aria-hidden="true" tabindex="-1"></a>study_proportion <span class="ot">&lt;-</span> study1_clean <span class="sc">%&gt;%</span></span>
<span id="section-cb325-17"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(last_digit <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="section-cb325-18"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">p =</span> <span class="fu">mean</span>(last_digit <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">7</span>))) <span class="sc">%&gt;%</span></span>
<span id="section-cb325-19"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(p) </span>
<span id="section-cb325-20"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb325-20" aria-hidden="true" tabindex="-1"></a>study_proportion</span></code></pre></div>
<pre><code>[1] 0.88148</code></pre>
<div class="sourceCode" id="section-cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb327-1"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb327-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 88.1%. Wow.</span></span>
<span id="section-cb327-2"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb327-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="section-cb327-3"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb327-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the simulation:</span></span>
<span id="section-cb327-4"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb327-4" aria-hidden="true" tabindex="-1"></a>sim_results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="section-cb327-5"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb327-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) sim_results[b] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">simulate_proportion</span>() <span class="sc">&gt;=</span> study_proportion)</span>
<span id="section-cb327-6"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb327-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="section-cb327-7"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb327-7" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a vector of 0/1 which says whether each simulation&#39;s proportion of</span></span>
<span id="section-cb327-8"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb327-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 3&#39;s and 7&#39;s exceeded the study proportion. Its mean is the simulated probability</span></span>
<span id="section-cb327-9"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb327-9" aria-hidden="true" tabindex="-1"></a><span class="co"># of seeing what we saw in the study, if the digits are actually evenly distributed:</span></span>
<span id="section-cb327-10"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb327-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(sim_results)</span></code></pre></div>
<pre><code>[1] 0</code></pre>
<div class="sourceCode" id="section-cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb329-1"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb329-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Okay... how many?</span></span>
<span id="section-cb329-2"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb329-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(sim_results)</span></code></pre></div>
<pre><code>[1] 0</code></pre>
<p>In <span class="math inline">\(B = 10,000\)</span> simulations, I didn’t even get a single dataset that was as extreme
as ours. This provides strong evidence against the notion that the digits are, in
fact, evenly distributed.</p>
<p><strong>Exercise</strong>: how many simulations do you need before you get even one that is as
extreme as our dataset?</p>
<p><strong>Exercise</strong>: investigate the manner in which we generated these random digits. Try the following:</p>
<ol style="list-style-type: decimal">
<li><p>Simulate from a continuous uniform distribution with mean and variance equal to the sample
mean and variance (you have to figure out how to do this),</p></li>
<li><p>Simulate from a discrete uniform distribution with mean and variance equal to the
sample mean and variance,</p></li>
<li><p>(<em>Advanced</em>) Simulate from a discrete uniform distribution as above, but then, chop off the last
digit and replace it with one simulated from a discrete uniform distribution on <span class="math inline">\(\left\{0,\ldots,9\right\}\)</span>.</p></li>
</ol>
<p><strong>Exercise</strong>: repeate the simulation, but filter out numbers ending in <span class="math inline">\(0\)</span> or <span class="math inline">\(5\)</span> from
the simulated datasets. Do the results change at all?</p>
</div>
<div id="section-testing-goodness-of-fit-math" class="section level3" number="10.2.4">
<h3><span class="header-section-number">10.2.4</span> Testing goodness of fit: math</h3>
<p>We may also use mathematics and statistical modelling to answer the question:
<strong>if the underlying distribution of last digits
really was evenly distributed, what is the probability of seeing the data that
we saw, or a dataset that is even more extreme under this hypothesis?</strong>.</p>
<p>We do this in a clever way: we construct a statistical model that represents the
truth, <em>if</em> the truth is what we say it is. Namely, we will define a probability
distribution that <em>should</em> represent the distribution of the last digits of our
measurements, <em>if</em> the last digits are evenly distributed. We then see how probable
our data is under this model. If, under this model, it is very unlikely to see
a dataset like ours, then this provides evidence that the model isn’t representative
of the truth. And since the model was built under the premise that the digits are
evenly distributed, a lack of fit of the model to the observed data provides
evidence against the notion that the digits are evenly distributed.</p>
<p>Let’s develop a model. Define <span class="math inline">\(y_{ij} = 1\)</span> if the last digit of the <span class="math inline">\(i^{th}\)</span> measurement
equals <span class="math inline">\(j\)</span>, for <span class="math inline">\(j \in J = \left\{1,2,3,4,6,7,8,9\right\}\)</span> (remember: they filtered out
measurements ending in <span class="math inline">\(0\)</span> or <span class="math inline">\(5\)</span>), and equals <span class="math inline">\(0\)</span> otherwise. So for example,
if the <span class="math inline">\(i^{th}\)</span> measurement is <span class="math inline">\(42\)</span> then <span class="math inline">\(y_{i1} = 0\)</span> and <span class="math inline">\(y_{i2} = 1\)</span> and <span class="math inline">\(y_{i3} = 0\)</span>
and so on. Define <span class="math inline">\(y_{i} = (y_{i1},\ldots,y_{i9})\)</span>, a vector containing all zeroes
except for exactly one <span class="math inline">\(1\)</span>. Then the <span class="math inline">\(y_{i}\)</span> are independent draws from a <strong>Multinomial</strong>
distribution, <span class="math inline">\(y_{i}\overset{iid}{\sim}\text{Multinomial}(1,p_{1},\ldots,p_{9})\)</span>,
with <span class="math inline">\(\mathbb{E}(y_{ij}) = \mathbb{P}(y_{ij} = 1) = p_{j}\)</span> and <span class="math inline">\(\sum_{j\in J}p_{j} = 1\)</span>.
The vectors <span class="math inline">\(y_{i}\)</span> have the following (joint) density function:
<span class="math display">\[\begin{equation}
\mathbb{P}(y_{i} = (y_{i1},\ldots,y_{i9})) = p_{1}^{y_{i1}}\times\cdots\times p_{9}^{y_{i9}}
\end{equation}\]</span>
The multinomial is the generalization of the binomial/bernoulli to multiple possible
outcomes on each trial. If the bernoulli is thought of as flipping a coin (two possible
outcomes), then the multinomial should be thought of as rolling a die (six possible outcomes).</p>
<p>How does this help us answer the question? If the digits are actually evenly distributed,
then this means <span class="math inline">\(p_{1} = \cdots = p_{9} = 1/8\)</span> (why?).</p>
<p>However, the data might tell us something different. We estimate the <span class="math inline">\(p_{j}\)</span> from
out data <span class="math inline">\(y_{1},\ldots,y_{n}\)</span> by computing the maximum likelihood estimator:
<span class="math display">\[\begin{equation}
\hat{p}_{j} \ \frac{1}{n}\sum_{i=1}^{n}y_{ij}
\end{equation}\]</span>
which are simply the sample proportions of digits that equal each value of <span class="math inline">\(j\)</span>.</p>
<p>We assess how close the MLEs are to what the true values <em>ought</em> to be using the
<strong>likelihood ratio</strong>. For <span class="math inline">\(p_{0} = (1/8,\ldots,1/8)\)</span>, <span class="math inline">\(\hat{p} = (\hat{p}_{1},\ldots,\hat{p}_{9})\)</span>,
and <span class="math inline">\(L(\cdot)\)</span> the likelihood based off of the multinomial density,
<span class="math display">\[\begin{equation}
\Lambda = \frac{L(p_{0})}{L(\hat{p})}
\end{equation}\]</span>
Remember the definition of the likelihood, for discrete data: for any <span class="math inline">\(p\)</span>, <span class="math inline">\(L(p)\)</span> is the relative
frequency with which the observed data would be seen in repeated sampling, if the true
parameter value were <span class="math inline">\(p\)</span>. The likelihood ratio <span class="math inline">\(\Lambda\)</span> is the ratio of how often
our data would be seen if <span class="math inline">\(p = p_{0}\)</span>, against how often it would be seen if <span class="math inline">\(p = \hat{p}\)</span>.
If <span class="math inline">\(\Lambda = 0.5\)</span>, for example, that means that our data would occur half as often
if <span class="math inline">\(p = p_{0}\)</span>, compared to if <span class="math inline">\(p = \hat{p}\)</span>. Note that <span class="math inline">\(0 &lt; \Lambda \leq 1\)</span> (why?).</p>
<p>Lower values of <span class="math inline">\(\Lambda\)</span> mean that there is stronger evidence <em>against</em> the notion
that <span class="math inline">\(p_{0}\)</span> is a plausible value for <span class="math inline">\(p\)</span>– that is, that the digits are evenly
distributed. But how do we quantify how much less likely is less likely enough?
Here is where our previous question comes back. We ask: <strong>if the digits were
evenly distributed, what is the probability of seeing the data we saw, or something
with an even more extreme distribution of digits</strong>? To compute this, we need to
be able to compute probabilities involving <span class="math inline">\(\Lambda\)</span>.</p>
<p>It turns out that using <span class="math inline">\(\Lambda\)</span> is very clever, because well, we can do this.
There is a Big Theorem which states that if <span class="math inline">\(p\in\mathbb{R}^{d}\)</span> and <span class="math inline">\(p = p_{0}\)</span>,
<span class="math display">\[\begin{equation}
-2\log\Lambda \overset{\cdot}{\sim} \chi_{d-1}^{2}
\end{equation}\]</span>
So, if the digits are evenly distributed, then <em>our</em> value of <span class="math inline">\(-2\log\Lambda\)</span> should
be a realization of a <span class="math inline">\(\chi^{2}_{7}\)</span> random variable. We therefore compute
<span class="math display">\[\begin{equation}
\nu = \mathbb{P}\left(\chi^{2}_{7} \geq -2\log\Lambda\right)
\end{equation}\]</span>
The quantity <span class="math inline">\(\nu\)</span> is the probability of observing a distribution of digits
as or more extreme than the one we observed in our data, <em>if the distribution
of digits truly is even</em>. It’s called a <strong>p-value</strong>, and it’s one helpful
summary statistic in problems where the research question concerns comparing
observations to some sort of reference, like we’re doing here.</p>
<p>Let’s compute the likelihood ratio for our data:</p>
<div class="sourceCode" id="section-cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb331-1"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the MLEs</span></span>
<span id="section-cb331-2"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb331-2" aria-hidden="true" tabindex="-1"></a>study1_filtered <span class="ot">&lt;-</span> study1_clean <span class="sc">%&gt;%</span></span>
<span id="section-cb331-3"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb331-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(last_digit <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">0</span>))) <span class="co"># Should have done this before...</span></span>
<span id="section-cb331-4"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb331-4" aria-hidden="true" tabindex="-1"></a>pmledat <span class="ot">&lt;-</span> study1_filtered <span class="sc">%&gt;%</span></span>
<span id="section-cb331-5"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb331-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(last_digit) <span class="sc">%&gt;%</span></span>
<span id="section-cb331-6"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb331-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">cnt =</span> <span class="fu">n</span>(),</span>
<span id="section-cb331-7"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb331-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">pp =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">nrow</span>(study1_filtered))</span></code></pre></div>
<pre><code>`summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="section-cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb333-1"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb333-1" aria-hidden="true" tabindex="-1"></a>obsvec <span class="ot">&lt;-</span> pmledat<span class="sc">$</span>cnt</span>
<span id="section-cb333-2"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb333-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(obsvec) <span class="ot">&lt;-</span> pmledat<span class="sc">$</span>last_digit</span>
<span id="section-cb333-3"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb333-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="section-cb333-4"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb333-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice how there are no digits ending in 1 in the data</span></span>
<span id="section-cb333-5"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb333-5" aria-hidden="true" tabindex="-1"></a><span class="co"># So the MLE for p1 is zero.</span></span>
<span id="section-cb333-6"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb333-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Need to account for this manually</span></span>
<span id="section-cb333-7"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb333-7" aria-hidden="true" tabindex="-1"></a>pmle <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>)</span>
<span id="section-cb333-8"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb333-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pmle) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)</span>
<span id="section-cb333-9"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb333-9" aria-hidden="true" tabindex="-1"></a>pmlevals <span class="ot">&lt;-</span> pmledat<span class="sc">$</span>pp</span>
<span id="section-cb333-10"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb333-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pmlevals) <span class="ot">&lt;-</span> pmledat<span class="sc">$</span>last_digit</span>
<span id="section-cb333-11"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb333-11" aria-hidden="true" tabindex="-1"></a>pmle[<span class="fu">names</span>(pmlevals)] <span class="ot">&lt;-</span> pmlevals</span>
<span id="section-cb333-12"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb333-12" aria-hidden="true" tabindex="-1"></a>pmle</span></code></pre></div>
<pre><code>        1         2         3         4         6         7         8         9 
0.0000000 0.0074074 0.5259259 0.0148148 0.0222222 0.3555556 0.0518519 0.0222222 </code></pre>
<div class="sourceCode" id="section-cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb335-1"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb335-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Truth, if digits evenly distributed</span></span>
<span id="section-cb335-2"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb335-2" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(pmle)) <span class="sc">/</span> <span class="fu">length</span>(pmle)</span>
<span id="section-cb335-3"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb335-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(p0) <span class="ot">&lt;-</span> <span class="fu">names</span>(pmle)</span>
<span id="section-cb335-4"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb335-4" aria-hidden="true" tabindex="-1"></a>p0</span></code></pre></div>
<pre><code>    1     2     3     4     6     7     8     9 
0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125 </code></pre>
<div class="sourceCode" id="section-cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb337-1"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb337-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute minus twice the likelihood ratio</span></span>
<span id="section-cb337-2"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb337-2" aria-hidden="true" tabindex="-1"></a>multinom_log_likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(x,p) {</span>
<span id="section-cb337-3"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb337-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x: named vector where the name is j and the value is the count of </span></span>
<span id="section-cb337-4"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb337-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># times y_ij = 1 in the sample</span></span>
<span id="section-cb337-5"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb337-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># p: named vector with names equal to the unique values of x,</span></span>
<span id="section-cb337-6"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb337-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># containing probabilities of each</span></span>
<span id="section-cb337-7"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb337-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(x <span class="sc">*</span> <span class="fu">log</span>(p[<span class="fu">names</span>(x)]))</span>
<span id="section-cb337-8"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb337-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="section-cb337-9"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb337-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="section-cb337-10"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb337-10" aria-hidden="true" tabindex="-1"></a>lr <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (<span class="fu">multinom_log_likelihood</span>(obsvec,p0) <span class="sc">-</span> <span class="fu">multinom_log_likelihood</span>(obsvec,pmle))</span>
<span id="section-cb337-11"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb337-11" aria-hidden="true" tabindex="-1"></a>lr</span></code></pre></div>
<pre><code>[1] 257.16</code></pre>
<div class="sourceCode" id="section-cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb339-1"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb339-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the probability that a chisquare random variable is greater than this</span></span>
<span id="section-cb339-2"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb339-2" aria-hidden="true" tabindex="-1"></a><span class="co"># value:</span></span>
<span id="section-cb339-3"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb339-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(lr,<span class="at">df =</span> <span class="fu">length</span>(pmle) <span class="sc">-</span> <span class="dv">1</span>) <span class="co"># zero.</span></span></code></pre></div>
<pre><code>[1] 0</code></pre>
<p><strong>Exercise</strong>: write your own function to implement the multinomial loglikelihood,
using the <code>dmultinom</code> function and a <code>for</code> loop. Compare your results to mine.</p>
<p>We would interpret this result as: the observed data provides strong evidence against the notion
that the digits are evenly distributed.</p>
<p>The fact that there is essentially <em>zero chance</em> of seeing what we saw if our
claim that the digits are evenly distributed agrees with our simulation. We just
did some statistical forensics! Pretty cool. This type of reasoning is abundant
in the scientific literature, as are these p-value things. They are useful, but
we want you, as stats majors and specialists, to leave this course understanding
than statistics is so very much more than just a ritual or toolbox!</p>

<div class="sourceCode" id="section-cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb341-1"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="section-confidence-intervals-and-quantifying-uncertainty.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="section-bayesian-inference-estimation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book.pdf", "book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
