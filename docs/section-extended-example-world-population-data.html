<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 15 Extended Example: World Population Data | Probability, Statistics, and Data Analysis</title>
  <meta name="description" content="This book represents part of the course materials for STA238 at the University of Toronto" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 15 Extended Example: World Population Data | Probability, Statistics, and Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book represents part of the course materials for STA238 at the University of Toronto" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 15 Extended Example: World Population Data | Probability, Statistics, and Data Analysis" />
  
  <meta name="twitter:description" content="This book represents part of the course materials for STA238 at the University of Toronto" />
  

<meta name="author" content="Alison Gibbs and Alex Stringer" />


<meta name="date" content="2021-01-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="section-assigned-exercises-from-mips.html"/>
<link rel="next" href="section-short-tutorial-on-pulling-data-for-assignment-1.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STA238 University of Toronto</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><i class="fa fa-check"></i><b>2</b> Introduction to Data Analysis: Data Input and Basic Summaries</a>
<ul>
<li class="chapter" data-level="2.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-old-faithful"><i class="fa fa-check"></i><b>2.1</b> Old Faithful</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-read-in-the-data"><i class="fa fa-check"></i><b>2.1.1</b> Read in the data</a></li>
<li class="chapter" data-level="2.1.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-graphical-summaries"><i class="fa fa-check"></i><b>2.1.2</b> Graphical Summaries</a></li>
<li class="chapter" data-level="2.1.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-numerical-summaries"><i class="fa fa-check"></i><b>2.1.3</b> Numerical Summaries</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-drilling"><i class="fa fa-check"></i><b>2.2</b> Drilling</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-read-in-data"><i class="fa fa-check"></i><b>2.2.1</b> Read in data</a></li>
<li class="chapter" data-level="2.2.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-graphical-summaries-1"><i class="fa fa-check"></i><b>2.2.2</b> Graphical summaries</a></li>
<li class="chapter" data-level="2.2.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-numerical-summaries-1"><i class="fa fa-check"></i><b>2.2.3</b> Numerical summaries</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-exercises"><i class="fa fa-check"></i><b>2.3</b> Exercises</a></li>
<li class="chapter" data-level="2.4" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-extended-example-smoking-and-age-and-mortality"><i class="fa fa-check"></i><b>2.4</b> Extended example: smoking and age and mortality</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-exercises-1"><i class="fa fa-check"></i><b>2.4.1</b> Exercises</a></li>
<li class="chapter" data-level="2.4.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-association-between-smoking-and-mortality"><i class="fa fa-check"></i><b>2.4.2</b> Association between smoking and mortality</a></li>
<li class="chapter" data-level="2.4.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-exercises-2"><i class="fa fa-check"></i><b>2.4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-case-study-rental-housing-in-toronto"><i class="fa fa-check"></i><b>2.5</b> Case study: rental housing in Toronto</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-load-the-data"><i class="fa fa-check"></i><b>2.5.1</b> Load the data</a></li>
<li class="chapter" data-level="2.5.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-analysis-i-what-does-the-data-look-like"><i class="fa fa-check"></i><b>2.5.2</b> Analysis I: what does the data look like?</a></li>
<li class="chapter" data-level="2.5.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-analysis-ii-do-different-wards-have-different-quality-housing"><i class="fa fa-check"></i><b>2.5.3</b> Analysis II: Do different wards have different quality housing?</a></li>
<li class="chapter" data-level="2.5.4" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-analysis-iii-trends-in-quality-over-time"><i class="fa fa-check"></i><b>2.5.4</b> Analysis III: trends in quality over time</a></li>
<li class="chapter" data-level="2.5.5" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-summary"><i class="fa fa-check"></i><b>2.5.5</b> Summary</a></li>
<li class="chapter" data-level="2.5.6" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-exercises-3"><i class="fa fa-check"></i><b>2.5.6</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><i class="fa fa-check"></i><b>3</b> Introduction to Statistics: Law of Large Numbers and Central Limit Theorem</a>
<ul>
<li class="chapter" data-level="3.1" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html#section-law-of-large-numbers-chapter-13"><i class="fa fa-check"></i><b>3.1</b> Law of Large Numbers (Chapter 13)</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html#section-extended-example-the-probability-of-heads"><i class="fa fa-check"></i><b>3.1.1</b> Extended example: the probability of heads</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html#section-central-limit-theorem-chapter-14"><i class="fa fa-check"></i><b>3.2</b> Central Limit Theorem (Chapter 14)</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html#section-extended-example-the-probability-of-heads-1"><i class="fa fa-check"></i><b>3.2.1</b> Extended example: the probability of heads</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="section-statistical-models.html"><a href="section-statistical-models.html"><i class="fa fa-check"></i><b>4</b> Statistical Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-statistical-models-chapter-17"><i class="fa fa-check"></i><b>4.1</b> Statistical models (Chapter 17)</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-linear-regression"><i class="fa fa-check"></i><b>4.1.1</b> Linear Regression</a></li>
<li class="chapter" data-level="4.1.2" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-extended-example-ttc-ridership-revenues"><i class="fa fa-check"></i><b>4.1.2</b> Extended example: TTC ridership revenues</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-unbiased-estimators-chapter-19"><i class="fa fa-check"></i><b>4.2</b> Unbiased Estimators (Chapter 19)</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-simulated-data"><i class="fa fa-check"></i><b>4.2.1</b> Simulated data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><a href="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><i class="fa fa-check"></i><b>5</b> Evaluating Estimators: Efficiency and Mean Squared Error</a>
<ul>
<li class="chapter" data-level="5.1" data-path="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><a href="section-evaluating-estimators-efficiency-and-mean-squared-error.html#section-estimating-a-uniform-maximum"><i class="fa fa-check"></i><b>5.1</b> Estimating a Uniform Maximum</a></li>
<li class="chapter" data-level="5.2" data-path="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><a href="section-evaluating-estimators-efficiency-and-mean-squared-error.html#section-efficiency"><i class="fa fa-check"></i><b>5.2</b> Efficiency</a></li>
<li class="chapter" data-level="5.3" data-path="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><a href="section-evaluating-estimators-efficiency-and-mean-squared-error.html#section-mean-squared-error"><i class="fa fa-check"></i><b>5.3</b> Mean Squared Error</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html"><i class="fa fa-check"></i><b>6</b> Introduction to Bayesian Inference</a>
<ul>
<li class="chapter" data-level="6.1" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-tutorial"><i class="fa fa-check"></i><b>6.1</b> Tutorial</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-frequentistlikelihood-perspective"><i class="fa fa-check"></i><b>6.1.1</b> Frequentist/Likelihood Perspective</a></li>
<li class="chapter" data-level="6.1.2" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-bayesian-inference-introduction"><i class="fa fa-check"></i><b>6.1.2</b> Bayesian Inference: introduction</a></li>
<li class="chapter" data-level="6.1.3" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-flipping-more-coins"><i class="fa fa-check"></i><b>6.1.3</b> Flipping More Coins</a></li>
<li class="chapter" data-level="6.1.4" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-visualization"><i class="fa fa-check"></i><b>6.1.4</b> Visualization</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-interactive-app"><i class="fa fa-check"></i><b>6.2</b> Interactive App</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="section-the-bootstrap.html"><a href="section-the-bootstrap.html"><i class="fa fa-check"></i><b>7</b> The Bootstrap</a>
<ul>
<li class="chapter" data-level="7.1" data-path="section-the-bootstrap.html"><a href="section-the-bootstrap.html#section-the-bootstrap-chapter-18"><i class="fa fa-check"></i><b>7.1</b> The Bootstrap (Chapter 18)</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="section-the-bootstrap.html"><a href="section-the-bootstrap.html#section-empirical-bootstrap-old-faithful-data"><i class="fa fa-check"></i><b>7.1.1</b> Empirical bootstrap: Old Faithful data</a></li>
<li class="chapter" data-level="7.1.2" data-path="section-the-bootstrap.html"><a href="section-the-bootstrap.html#section-parametric-bootstrap-software-data"><i class="fa fa-check"></i><b>7.1.2</b> Parametric Bootstrap: software data</a></li>
<li class="chapter" data-level="7.1.3" data-path="section-the-bootstrap.html"><a href="section-the-bootstrap.html#section-extended-example-the-standard-error-of-a-proportion"><i class="fa fa-check"></i><b>7.1.3</b> Extended example: the standard error of a proportion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html"><i class="fa fa-check"></i><b>8</b> Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="8.1" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html#section-maximum-likelihood-chapter-21"><i class="fa fa-check"></i><b>8.1</b> Maximum Likelihood (Chapter 21)</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html#section-example-two-coins"><i class="fa fa-check"></i><b>8.1.1</b> Example: two coins</a></li>
<li class="chapter" data-level="8.1.2" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html#section-example-unknown-coins-n-2"><i class="fa fa-check"></i><b>8.1.2</b> Example: unknown coins, <span class="math inline">\(n = 2\)</span></a></li>
<li class="chapter" data-level="8.1.3" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html#section-example-unknown-coins-n-bigger-than-2"><i class="fa fa-check"></i><b>8.1.3</b> Example: unknown coins, <span class="math inline">\(n\)</span> bigger than <span class="math inline">\(2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html#section-extended-example-rental-housing-in-toronto"><i class="fa fa-check"></i><b>8.2</b> Extended example: rental housing in Toronto</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html"><i class="fa fa-check"></i><b>9</b> Confidence Intervals and Quantifying Uncertainty</a>
<ul>
<li class="chapter" data-level="9.1" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-confidence-intervals-for-the-mean-chapter-23"><i class="fa fa-check"></i><b>9.1</b> Confidence Intervals for the Mean (Chapter 23)</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-simulation-an-example"><i class="fa fa-check"></i><b>9.1.1</b> Simulation: an example</a></li>
<li class="chapter" data-level="9.1.2" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-gross-calorific-value-measurements-for-osterfeld-262de27"><i class="fa fa-check"></i><b>9.1.2</b> Gross calorific value measurements for Osterfeld 262DE27</a></li>
<li class="chapter" data-level="9.1.3" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-when-you-dont-know-sigma"><i class="fa fa-check"></i><b>9.1.3</b> When you don’t know <span class="math inline">\(\sigma\)</span></a></li>
<li class="chapter" data-level="9.1.4" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-gross-calorific-value-measurements-for-daw-mill-258gb41"><i class="fa fa-check"></i><b>9.1.4</b> Gross calorific value measurements for Daw Mill 258GB41</a></li>
<li class="chapter" data-level="9.1.5" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>9.1.5</b> Bootstrap Confidence Intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html"><i class="fa fa-check"></i><b>10</b> Extended Example: Reasoning About Goodness of Fit</a>
<ul>
<li class="chapter" data-level="10.1" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-go-and-read-the-blog-post"><i class="fa fa-check"></i><b>10.1</b> Go and read the blog post</a></li>
<li class="chapter" data-level="10.2" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-distribution-of-last-digits"><i class="fa fa-check"></i><b>10.2</b> Distribution of last digits</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-read-in-the-data-1"><i class="fa fa-check"></i><b>10.2.1</b> Read in the data</a></li>
<li class="chapter" data-level="10.2.2" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-make-the-histogram"><i class="fa fa-check"></i><b>10.2.2</b> Make the histogram</a></li>
<li class="chapter" data-level="10.2.3" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-testing-goodness-of-fit-simulation"><i class="fa fa-check"></i><b>10.2.3</b> Testing goodness of fit: simulation</a></li>
<li class="chapter" data-level="10.2.4" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-testing-goodness-of-fit-math"><i class="fa fa-check"></i><b>10.2.4</b> Testing goodness of fit: math</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html"><i class="fa fa-check"></i><b>11</b> Bayesian Inference: Estimation</a>
<ul>
<li class="chapter" data-level="11.1" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-estimation-in-bayesian-inference-general-ideas"><i class="fa fa-check"></i><b>11.1</b> Estimation in Bayesian Inference: general ideas</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-the-prior"><i class="fa fa-check"></i><b>11.1.1</b> The Prior</a></li>
<li class="chapter" data-level="11.1.2" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-the-posterior"><i class="fa fa-check"></i><b>11.1.2</b> The Posterior</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-estimation-in-bayesian-inference-point-and-interval-estimation"><i class="fa fa-check"></i><b>11.2</b> Estimation in Bayesian Inference: point and interval estimation</a></li>
<li class="chapter" data-level="11.3" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-choosing-a-prior"><i class="fa fa-check"></i><b>11.3</b> Choosing a Prior</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-conjugate-priors"><i class="fa fa-check"></i><b>11.3.1</b> Conjugate Priors</a></li>
<li class="chapter" data-level="11.3.2" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-setting-hyperparameters-by-moment-matching"><i class="fa fa-check"></i><b>11.3.2</b> Setting Hyperparameters by moment-matching</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html"><i class="fa fa-check"></i><b>12</b> Predictive Modelling</a>
<ul>
<li class="chapter" data-level="12.1" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html#section-overview"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html#section-plug-in-prediction-coin-flipping"><i class="fa fa-check"></i><b>12.2</b> Plug-in prediction: coin flipping</a></li>
<li class="chapter" data-level="12.3" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html#section-bayesian-prediction-coin-flipping"><i class="fa fa-check"></i><b>12.3</b> Bayesian Prediction: coin flipping</a></li>
<li class="chapter" data-level="12.4" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html#section-extended-example-predicting-call-centre-wait-times"><i class="fa fa-check"></i><b>12.4</b> Extended example: predicting call centre wait times</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="section-installing-r-and-rstudio.html"><a href="section-installing-r-and-rstudio.html"><i class="fa fa-check"></i><b>13</b> Installing R and RStudio</a>
<ul>
<li class="chapter" data-level="13.1" data-path="section-installing-r-and-rstudio.html"><a href="section-installing-r-and-rstudio.html#section-installing-r"><i class="fa fa-check"></i><b>13.1</b> Installing R</a></li>
<li class="chapter" data-level="13.2" data-path="section-installing-r-and-rstudio.html"><a href="section-installing-r-and-rstudio.html#section-installing-rstudio"><i class="fa fa-check"></i><b>13.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="13.3" data-path="section-installing-r-and-rstudio.html"><a href="section-installing-r-and-rstudio.html#section-using-rmarkdown"><i class="fa fa-check"></i><b>13.3</b> Using RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html"><i class="fa fa-check"></i><b>14</b> Assigned Exercises from MIPS</a>
<ul>
<li class="chapter" data-level="14.1" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapters-15-and-16"><i class="fa fa-check"></i><b>14.1</b> Chapters 15 and 16</a></li>
<li class="chapter" data-level="14.2" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapters-13-and-14"><i class="fa fa-check"></i><b>14.2</b> Chapters 13 and 14</a></li>
<li class="chapter" data-level="14.3" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapters-17-and-19"><i class="fa fa-check"></i><b>14.3</b> Chapters 17 and 19</a></li>
<li class="chapter" data-level="14.4" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapter-20"><i class="fa fa-check"></i><b>14.4</b> Chapter 20</a></li>
<li class="chapter" data-level="14.5" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-evans-and-rosenthal-chapter-7.1"><i class="fa fa-check"></i><b>14.5</b> Evans and Rosenthal, Chapter 7.1</a></li>
<li class="chapter" data-level="14.6" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapter-18"><i class="fa fa-check"></i><b>14.6</b> Chapter 18</a></li>
<li class="chapter" data-level="14.7" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapter-21"><i class="fa fa-check"></i><b>14.7</b> Chapter 21</a></li>
<li class="chapter" data-level="14.8" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapter-23"><i class="fa fa-check"></i><b>14.8</b> Chapter 23</a></li>
<li class="chapter" data-level="14.9" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-evans-and-rosenthal-chapter-7.2"><i class="fa fa-check"></i><b>14.9</b> Evans and Rosenthal, Chapter 7.2</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html"><i class="fa fa-check"></i><b>15</b> Extended Example: World Population Data</a>
<ul>
<li class="chapter" data-level="15.1" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-read-in-and-prepare-the-data-for-analysis"><i class="fa fa-check"></i><b>15.1</b> Read in and prepare the data for analysis</a></li>
<li class="chapter" data-level="15.2" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-model-world-population-over-time"><i class="fa fa-check"></i><b>15.2</b> Model world population over time</a></li>
<li class="chapter" data-level="15.3" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-bayesian-model-for-world-population"><i class="fa fa-check"></i><b>15.3</b> Bayesian model for world population</a></li>
<li class="chapter" data-level="15.4" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-quantifying-uncertainty-in-estimates-of-world-population-regression-model"><i class="fa fa-check"></i><b>15.4</b> Quantifying uncertainty in estimates of world population: regression model</a></li>
<li class="chapter" data-level="15.5" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-bayesian-estimate-of-world-population"><i class="fa fa-check"></i><b>15.5</b> Bayesian estimate of world population</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-estimation-and-uncertainty-quantification"><i class="fa fa-check"></i><b>15.5.1</b> Estimation and uncertainty quantification</a></li>
<li class="chapter" data-level="15.5.2" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-estimation-by-sampling"><i class="fa fa-check"></i><b>15.5.2</b> Estimation by sampling</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-predicting-world-population"><i class="fa fa-check"></i><b>15.6</b> Predicting world population</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-why-arent-our-predictions-accurate"><i class="fa fa-check"></i><b>15.6.1</b> Why aren’t our predictions accurate?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="section-short-tutorial-on-pulling-data-for-assignment-1.html"><a href="section-short-tutorial-on-pulling-data-for-assignment-1.html"><i class="fa fa-check"></i><b>16</b> Short tutorial on pulling data for Assignment 1</a>
<ul>
<li class="chapter" data-level="16.1" data-path="section-short-tutorial-on-pulling-data-for-assignment-1.html"><a href="section-short-tutorial-on-pulling-data-for-assignment-1.html#section-toronto-open-data-portal"><i class="fa fa-check"></i><b>16.1</b> Toronto Open Data Portal</a></li>
<li class="chapter" data-level="16.2" data-path="section-short-tutorial-on-pulling-data-for-assignment-1.html"><a href="section-short-tutorial-on-pulling-data-for-assignment-1.html#section-canadian-election-study"><i class="fa fa-check"></i><b>16.2</b> Canadian Election Study</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Probability, Statistics, and Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-extended-example-world-population-data" class="section level1" number="15">
<h1><span class="header-section-number">Chapter 15</span> Extended Example: World Population Data</h1>
<p>In this chapter, we analyze the United Nations’ <a href="https://population.un.org/wpp/Download/Standard/Population/">World Population Prospects</a> data. These
data contain estimated population sizes for each country for single years from
1950–2020, and projections for five year blocks from 2025–2100.</p>
<p>We will apply methods from each chapter of this course to answer questions
about these data, the underlying true population of the world, and what the
population will look like in the future. More specifically, we will:</p>
<ol style="list-style-type: decimal">
<li><p>Read in and prepare the data for analysis (<strong>Chapter 2</strong>),</p></li>
<li><p>Build a simple linear regression model for the total world population over time
(<strong>Chapter 4</strong>),</p></li>
<li><p>Develop a Bayesian model for total world population (<strong>Chapter 6</strong>),</p></li>
<li><p>Quantify uncertainty in our estimate for total world population (<strong>Chapter 9</strong>),</p></li>
<li><p>Develop a Bayesian estimator for total world population (<strong>Chapter 11</strong>),</p></li>
<li><p>Predict the population to the year 2100 and compare our predictions and
uncertainty quantification with those reported by the UN (<strong>Chapter 12</strong>).</p></li>
</ol>
<div id="section-read-in-and-prepare-the-data-for-analysis" class="section level2" number="15.1">
<h2><span class="header-section-number">15.1</span> Read in and prepare the data for analysis</h2>
<p>The <a href="https://population.un.org/wpp/Download/Standard/Population/">World Population Prospects</a> data
contain estimated population sizes for each country for single years from
1950–2020, and projections for five year blocks from 2025–2100. They are available
for free download from that link. They are not in any form suitable for analysis,
however. The data are contained in a spreadsheet with variables in both rows and
columns, and summary statistics mixed in with the raw data.</p>
<p>I have done a bit of manual editing and posted the files to the book data folder
at <code>data/worldpop/*</code>. Let’s read in the data corresponding to the world population
estimates from 1950–2020. First, look at it, either in excel or on the command line:</p>
<div class="sourceCode" id="section-cb394"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="section-cb394-1"><a href="section-extended-example-world-population-data.html#section-cb394-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> data/worldpop/worldpop-estimates.csv</span></code></pre></div>
<pre><code>﻿country,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020
WORLD, 2 536 431, 2 584 034, 2 630 862, 2 677 609, 2 724 847, 2 773 020, 2 822 443, 2 873 306, 2 925 687, 2 979 576, 3 034 950, 3 091 844, 3 150 421, 3 211 001, 3 273 978, 3 339 584, 3 407 923, 3 478 770, 3 551 599, 3 625 681, 3 700 437, 3 775 760, 3 851 651, 3 927 781, 4 003 794, 4 079 480, 4 154 667, 4 229 506, 4 304 534, 4 380 506, 4 458 003, 4 536 997, 4 617 387, 4 699 569, 4 784 012, 4 870 922, 4 960 568, 5 052 522, 5 145 426, 5 237 441, 5 327 231, 5 414 289, 5 498 920, 5 581 598, 5 663 150, 5 744 213, 5 824 892, 5 905 046, 5 984 794, 6 064 239, 6 143 494, 6 222 627, 6 301 773, 6 381 185, 6 461 159, 6 541 907, 6 623 518, 6 705 947, 6 789 089, 6 872 767, 6 956 824, 7 041 194, 7 125 828, 7 210 582, 7 295 291, 7 379 797, 7 464 022, 7 547 859, 7 631 091, 7 713 468, 7 794 799
Burundi,  2 309,  2 360,  2 406,  2 449,  2 492,  2 537,  2 585,  2 636,  2 689,  2 743,  2 798,  2 852,  2 907,  2 964,  3 026,  3 094,  3 170,  3 253,  3 337,  3 414,  3 479,  3 530,  3 570,  3 605,  3 646,  3 701,  3 771,  3 854,  3 949,  4 051,  4 157,  4 267,  4 380,  4 498,  4 621,  4 751,  4 887,  5 027,  5 169,  5 307,  5 439,  5 565,  5 686,  5 798,  5 899,  5 987,  6 060,  6 122,  6 186,  6 267,  6 379,  6 526,  6 704,  6 909,  7 132,  7 365,  7 608,  7 862,  8 126,  8 398,  8 676,  8 958,  9 246,  9 540,  9 844,  10 160,  10 488,  10 827,  11 175,  11 531,  11 891
Comoros,   159,   163,   167,   170,   173,   176,   179,   182,   185,   188,   191,   194,   197,   200,   204,   207,   211,   216,   221,   225,   230,   235,   239,   244,   250,   257,   266,   276,   287,   297,   308,   318,   327,   336,   345,   355,   366,   377,   388,   400,   412,   424,   436,   449,   462,   475,   489,   502,   515,   529,   542,   556,   569,   583,   597,   612,   626,   642,   657,   673,   690,   707,   724,   742,   759,   777,   796,   814,   832,   851,   870
Djibouti,   62,   63,   65,   66,   68,   70,   71,   74,   76,   80,   84,   89,   94,   101,   108,   115,   123,   131,   140,   150,   160,   169,   179,   191,   205,   224,   249,   277,   308,   336,   359,   375,   385,   394,   406,   426,   454,   490,   529,   564,   590,   607,   615,   619,   622,   630,   644,   661,   680,   700,   718,   733,   747,   760,   772,   783,   795,   805,   816,   828,   840,   854,   868,   883,   899,   914,   929,   944,   959,   974,   988
Eritrea,   822,   835,   849,   865,   882,   900,   919,   939,   961,   983,  1 008,  1 033,  1 060,  1 089,  1 118,  1 148,  1 179,  1 210,  1 243,  1 276,  1 311,  1 347,  1 385,  1 424,  1 464,  1 505,  1 548,  1 592,  1 637,  1 684,  1 733,  1 785,  1 837,  1 891,  1 946,  2 004,  2 065,  2 127,  2 186,  2 231,  2 259,  2 266,  2 258,  2 239,  2 218,  2 204,  2 196,  2 195,  2 206,  2 237,  2 292,  2 375,  2 481,  2 601,  2 720,  2 827,  2 918,  2 997,  3 063,  3 120,  3 170,  3 214,  3 250,  3 281,  3 311,  3 343,  3 377,  3 413,  3 453,  3 497,  3 546
Ethiopia,  18 128,  18 467,  18 820,  19 184,  19 560,  19 947,  20 348,  20 764,  21 201,  21 662,  22 151,  22 671,  23 221,  23 798,  24 397,  25 014,  25 641,  26 280,  26 944,  27 653,  28 415,  29 249,  30 141,  31 037,  31 861,  32 567,  33 128,  33 577,  33 993,  34 488,  35 142,  35 985,  36 995,  38 143,  39 374,  40 652,  41 966,  43 329,  44 757,  46 272,  47 888,  49 610,  51 424,  53 296,  55 181,  57 048,  58 884,  60 697,  62 508,  64 343,  66 225,  68 159,  70 142,  72 171,  74 240,  76 346,  78 489,  80 674,  82 916,  85 234,  87 640,  90 140,  92 727,  95 386,  98 094,  100 835,  103 603,  106 400,  109 224,  112 079,  114 964
Kenya,  6 077,  6 242,  6 416,  6 598,  6 789,  6 988,  7 195,  7 412,  7 638,  7 874,  8 120,  8 378,  8 647,  8 929,  9 223,  9 530,  9 851,  10 187,  10 540,  10 911,  11 301,  11 713,  12 146,  12 601,  13 077,  13 576,  14 096,  14 639,  15 205,  15 798,  16 417,  17 064,  17 736,  18 432,  19 146,  19 877,  20 623,  21 382,  22 154,  22 935,  23 725,  24 522,  25 326,  26 136,  26 951,  27 768,  28 589,  29 416,  30 250,  31 099,  31 965,  32 849,  33 752,  34 679,  35 635,  36 625,  37 649,  38 706,  39 792,  40 902,  42 031,  43 178,  44 343,  45 520,  46 700,  47 878,  49 052,  50 221,  51 393,  52 574,  53 771
Madagascar,  4 084,  4 168,  4 257,  4 349,  4 444,  4 544,  4 647,  4 754,  4 865,  4 980,  5 099,  5 224,  5 352,  5 486,  5 625,  5 769,  5 919,  6 074,  6 234,  6 402,  6 576,  6 758,  6 947,  7 143,  7 346,  7 556,  7 773,  7 998,  8 230,  8 470,  8 717,  8 971,  9 234,  9 504,  9 781,  10 063,  10 352,  10 648,  10 952,  11 269,  11 599,  11 943,  12 301,  12 675,  13 067,  13 475,  13 903,  14 348,  14 809,  15 283,  15 767,  16 261,  16 765,  17 279,  17 803,  18 337,  18 880,  19 434,  19 996,  20 569,  21 152,  21 744,  22 347,  22 961,  23 590,  24 234,  24 894,  25 571,  26 262,  26 969,  27 691
Malawi,  2 954,  3 012,  3 072,  3 136,  3 202,  3 271,  3 342,  3 417,  3 495,  3 576,  3 660,  3 748,  3 839,  3 934,  4 032,  4 134,  4 240,  4 350,  4 464,  4 582,  4 704,  4 829,  4 959,  5 093,  5 235,  5 385,  5 546,  5 718,  5 897,  6 075,  6 250,  6 412,  6 566,  6 738,  6 965,  7 268,  7 666,  8 141,  8 637,  9 076,  9 404,  9 600,  9 686,  9 710,  9 746,  9 844,  10 023,  10 265,  10 552,  10 854,  11 149,  11 432,  11 714,  12 000,  12 302,  12 626,  12 974,  13 342,  13 728,  14 128,  14 540,  14 962,  15 396,  15 839,  16 290,  16 745,  17 205,  17 670,  18 143,  18 629,  19 130</code></pre>
<p>There is one character column containing the country and then <span class="math inline">\((2020 - 1950 + 1) = 71\)</span>
numeric columns containing population counts.</p>
<p>Let’s read it in with those specs:</p>
<div class="sourceCode" id="section-cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb396-1"><a href="section-extended-example-world-population-data.html#section-cb396-1" aria-hidden="true" tabindex="-1"></a>worldpop <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="section-cb396-2"><a href="section-extended-example-world-population-data.html#section-cb396-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;data/worldpop/worldpop-estimates.csv&quot;</span>,</span>
<span id="section-cb396-3"><a href="section-extended-example-world-population-data.html#section-cb396-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_names =</span> <span class="cn">TRUE</span>,</span>
<span id="section-cb396-4"><a href="section-extended-example-world-population-data.html#section-cb396-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> stringr<span class="sc">::</span><span class="fu">str_c</span>(<span class="fu">c</span>(<span class="st">&quot;c&quot;</span>,<span class="fu">rep</span>(<span class="st">&quot;n&quot;</span>,<span class="dv">71</span>)),<span class="at">collapse =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="section-cb396-5"><a href="section-extended-example-world-population-data.html#section-cb396-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="section-cb396-6"><a href="section-extended-example-world-population-data.html#section-cb396-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(worldpop)</span></code></pre></div>
<pre><code>Rows: 236
Columns: 72
$ country &lt;chr&gt; &quot;WORLD&quot;, &quot;Burundi&quot;, &quot;Comoros&quot;, &quot;Djibouti&quot;, &quot;Eritrea&quot;, &quot;Ethiopia&quot;, &quot;Kenya&quot;, &quot;Madagascar&quot;, &quot;Malawi&quot;, &quot;Mauritius&quot;, &quot;Mayotte&quot;, &quot;Mozambique&quot;, &quot;Réunion&quot;, &quot;Rwanda&quot;, &quot;Seychelles&quot;, &quot;Somalia&quot;, &quot;South…
$ `1950`  &lt;dbl&gt; 2, 2, 159, 62, 822, 18, 6, 4, 2, 493, 15, 5, 248, 2, 36, 2, 2, 5, 7, 2, 2, 4, 4, 1, 2, 827, 12, 226, 473, 60, 413, 273, 705, 514, 13, 2, 4, 178, 2, 305, 5, 3, 535, 930, 4, 651, 2, 37, 5, 2,…
$ `1951`  &lt;dbl&gt; 2, 2, 163, 63, 835, 18, 6, 4, 3, 506, 16, 6, 259, 2, 37, 2, 2, 5, 7, 2, 2, 4, 4, 1, 2, 842, 12, 231, 476, 59, 424, 279, 717, 524, 13, 2, 4, 186, 2, 309, 5, 3, 544, 944, 4, 667, 2, 38, 5, 2,…
$ `1952`  &lt;dbl&gt; 2, 2, 167, 65, 849, 18, 6, 4, 3, 521, 16, 6, 268, 2, 37, 2, 2, 5, 8, 2, 2, 4, 4, 1, 2, 858, 12, 234, 479, 59, 435, 285, 729, 534, 14, 2, 4, 191, 2, 314, 5, 3, 553, 959, 4, 683, 2, 39, 5, 2,…
$ `1953`  &lt;dbl&gt; 2, 2, 170, 66, 865, 19, 6, 4, 3, 537, 17, 6, 277, 2, 38, 2, 2, 5, 8, 2, 3, 4, 4, 1, 2, 875, 12, 236, 481, 58, 445, 291, 741, 545, 14, 2, 4, 195, 2, 318, 5, 3, 560, 975, 4, 700, 2, 39, 5, 2,…
$ `1954`  &lt;dbl&gt; 2, 2, 173, 68, 882, 19, 6, 4, 3, 554, 18, 6, 284, 2, 39, 2, 2, 5, 8, 2, 3, 4, 4, 1, 2, 893, 13, 238, 482, 58, 455, 297, 754, 556, 14, 2, 4, 196, 2, 324, 5, 3, 568, 993, 4, 719, 2, 40, 5, 2,…
$ `1955`  &lt;dbl&gt; 2, 2, 176, 70, 900, 19, 6, 4, 3, 571, 19, 6, 292, 2, 39, 2, 2, 5, 8, 2, 3, 5, 4, 1, 2, 911, 13, 240, 484, 59, 463, 303, 767, 568, 15, 2, 4, 197, 3, 330, 5, 3, 576, 1, 4, 738, 2, 41, 5, 2, 2…
$ `1956`  &lt;dbl&gt; 2, 2, 179, 71, 919, 20, 7, 4, 3, 588, 20, 6, 300, 2, 39, 2, 2, 6, 8, 2, 3, 5, 4, 1, 2, 930, 13, 242, 487, 60, 471, 309, 780, 580, 15, 2, 4, 197, 3, 336, 5, 3, 584, 1, 5, 759, 3, 41, 5, 2, 2…
$ `1957`  &lt;dbl&gt; 2, 2, 182, 74, 939, 20, 7, 4, 3, 605, 21, 6, 308, 2, 40, 2, 2, 6, 9, 2, 3, 5, 4, 1, 2, 951, 14, 245, 489, 61, 479, 316, 794, 593, 15, 2, 4, 198, 3, 343, 6, 3, 593, 1, 5, 780, 3, 42, 5, 2, 2…
$ `1958`  &lt;dbl&gt; 2, 2, 185, 76, 961, 21, 7, 4, 3, 623, 22, 6, 317, 2, 40, 2, 2, 6, 9, 2, 3, 5, 4, 1, 2, 972, 14, 248, 493, 62, 486, 323, 808, 606, 16, 2, 4, 198, 3, 350, 6, 3, 601, 1, 5, 803, 3, 43, 5, 3, 2…
$ `1959`  &lt;dbl&gt; 2, 2, 188, 80, 983, 21, 7, 4, 3, 641, 23, 7, 326, 2, 41, 2, 2, 6, 9, 2, 3, 5, 5, 1, 2, 995, 14, 252, 497, 64, 494, 330, 822, 620, 16, 2, 4, 199, 3, 358, 6, 3, 609, 1, 5, 826, 3, 44, 5, 3, 2…
$ `1960`  &lt;dbl&gt; 3, 2, 191, 84, 1, 22, 8, 5, 3, 660, 24, 7, 336, 2, 42, 2, 2, 6, 10, 3, 3, 5, 5, 1, 3, 1, 15, 255, 501, 64, 503, 337, 837, 634, 17, 2, 4, 202, 3, 365, 6, 3, 616, 1, 5, 850, 3, 45, 5, 3, 2, 1…
$ `1961`  &lt;dbl&gt; 3, 2, 194, 89, 1, 22, 8, 5, 3, 679, 25, 7, 345, 2, 42, 2, 2, 6, 10, 3, 3, 5, 5, 1, 3, 1, 15, 259, 506, 65, 513, 343, 853, 649, 17, 2, 4, 205, 3, 372, 6, 3, 623, 1, 5, 876, 3, 46, 5, 3, 2, 1…
$ `1962`  &lt;dbl&gt; 3, 2, 197, 94, 1, 23, 8, 5, 3, 698, 27, 7, 355, 3, 43, 2, 2, 7, 10, 3, 4, 5, 5, 1, 3, 1, 16, 262, 511, 64, 524, 350, 869, 665, 17, 2, 4, 210, 3, 380, 7, 3, 629, 1, 5, 902, 3, 47, 5, 3, 2, 1…
$ `1963`  &lt;dbl&gt; 3, 2, 200, 101, 1, 23, 8, 5, 3, 717, 28, 7, 366, 3, 45, 2, 3, 7, 10, 3, 4, 5, 5, 1, 3, 1, 16, 266, 518, 64, 536, 357, 886, 682, 18, 2, 5, 216, 3, 388, 7, 3, 635, 1, 5, 929, 3, 48, 5, 3, 2, …
$ `1964`  &lt;dbl&gt; 3, 3, 204, 108, 1, 24, 9, 5, 4, 736, 29, 7, 378, 3, 46, 3, 3, 7, 11, 3, 4, 5, 5, 1, 3, 1, 16, 271, 525, 64, 548, 365, 904, 699, 18, 2, 5, 223, 4, 396, 7, 3, 642, 1, 5, 957, 3, 49, 5, 3, 2, …
$ `1965`  &lt;dbl&gt; 3, 3, 207, 115, 1, 25, 9, 5, 4, 753, 31, 8, 391, 3, 47, 3, 3, 7, 11, 3, 4, 5, 5, 1, 3, 1, 17, 276, 533, 65, 560, 374, 922, 717, 19, 2, 5, 230, 4, 405, 7, 3, 650, 1, 5, 986, 3, 50, 5, 3, 2, …
$ `1966`  &lt;dbl&gt; 3, 3, 211, 123, 1, 25, 9, 5, 4, 770, 32, 8, 405, 3, 48, 3, 3, 8, 11, 3, 4, 5, 5, 1, 3, 1, 17, 284, 543, 66, 572, 384, 942, 735, 19, 2, 5, 239, 4, 415, 7, 3, 659, 1, 5, 1, 4, 51, 5, 3, 2, 1,…
$ `1967`  &lt;dbl&gt; 3, 3, 216, 131, 1, 26, 10, 6, 4, 785, 33, 8, 421, 3, 49, 3, 3, 8, 12, 3, 4, 5, 6, 1, 3, 1, 18, 292, 554, 68, 584, 395, 962, 754, 20, 2, 5, 248, 4, 427, 8, 3, 669, 1, 5, 1, 4, 52, 5, 3, 2, 1…
$ `1968`  &lt;dbl&gt; 3, 3, 221, 140, 1, 26, 10, 6, 4, 799, 34, 8, 437, 3, 50, 3, 3, 8, 12, 3, 4, 5, 6, 1, 3, 1, 18, 299, 566, 70, 597, 407, 984, 773, 20, 2, 5, 256, 4, 439, 8, 4, 680, 1, 5, 1, 4, 53, 6, 4, 2, 1…
$ `1969`  &lt;dbl&gt; 3, 3, 225, 150, 1, 27, 10, 6, 4, 813, 36, 8, 451, 3, 51, 3, 3, 9, 13, 4, 5, 5, 6, 1, 3, 1, 19, 304, 578, 73, 611, 419, 1, 795, 21, 2, 5, 263, 4, 451, 8, 4, 692, 1, 5, 1, 4, 54, 6, 4, 2, 2, …
$ `1970`  &lt;dbl&gt; 3, 3, 230, 160, 1, 28, 11, 6, 4, 826, 37, 9, 462, 3, 52, 3, 3, 9, 13, 4, 5, 5, 6, 1, 3, 1, 20, 304, 589, 75, 628, 431, 1, 817, 22, 2, 5, 269, 5, 464, 8, 4, 705, 1, 5, 1, 4, 55, 6, 4, 2, 2, …
$ `1971`  &lt;dbl&gt; 3, 3, 235, 169, 1, 29, 11, 6, 4, 840, 39, 9, 470, 3, 54, 3, 3, 9, 13, 4, 5, 6, 6, 1, 3, 1, 20, 299, 601, 76, 646, 444, 1, 842, 22, 2, 5, 271, 5, 478, 8, 4, 718, 1, 6, 1, 4, 57, 6, 4, 2, 2, …
$ `1972`  &lt;dbl&gt; 3, 3, 239, 179, 1, 30, 12, 6, 4, 852, 40, 9, 475, 3, 55, 3, 3, 9, 14, 4, 5, 6, 6, 1, 3, 1, 21, 290, 612, 78, 667, 457, 1, 869, 23, 3, 5, 272, 5, 492, 9, 4, 733, 1, 6, 1, 4, 58, 6, 4, 2, 2, …
$ `1973`  &lt;dbl&gt; 3, 3, 244, 191, 1, 31, 12, 7, 5, 865, 42, 9, 479, 4, 57, 3, 3, 10, 14, 4, 5, 6, 7, 1, 3, 1, 21, 278, 623, 79, 690, 471, 1, 896, 23, 3, 5, 271, 5, 507, 9, 4, 746, 1, 6, 1, 4, 60, 6, 4, 2, 2,…
$ `1974`  &lt;dbl&gt; 4, 3, 250, 205, 1, 31, 13, 7, 5, 878, 44, 9, 482, 4, 58, 3, 3, 10, 15, 4, 6, 6, 7, 1, 4, 1, 22, 266, 635, 81, 715, 485, 1, 923, 24, 3, 6, 270, 6, 523, 9, 4, 758, 1, 6, 1, 5, 61, 6, 4, 2, 2,…
$ `1975`  &lt;dbl&gt; 4, 3, 257, 224, 1, 32, 13, 7, 5, 892, 45, 10, 485, 4, 60, 3, 3, 10, 15, 4, 6, 7, 7, 1, 4, 1, 22, 256, 648, 83, 741, 500, 1, 948, 25, 3, 6, 270, 6, 540, 9, 4, 766, 1, 6, 1, 5, 63, 6, 4, 3, 2…
$ `1976`  &lt;dbl&gt; 4, 3, 266, 249, 1, 33, 14, 7, 5, 907, 47, 10, 488, 4, 61, 4, 4, 11, 16, 5, 6, 7, 7, 1, 4, 1, 23, 248, 661, 85, 770, 516, 1, 971, 25, 3, 6, 271, 6, 558, 10, 4, 770, 1, 6, 1, 5, 65, 6, 5, 3, …
$ `1977`  &lt;dbl&gt; 4, 3, 276, 277, 1, 33, 14, 7, 5, 922, 49, 10, 492, 4, 62, 4, 4, 11, 16, 5, 6, 7, 7, 2, 4, 1, 24, 242, 676, 88, 801, 532, 1, 993, 26, 3, 6, 273, 7, 577, 10, 4, 772, 1, 6, 1, 5, 67, 6, 5, 3, …
$ `1978`  &lt;dbl&gt; 4, 3, 287, 308, 1, 33, 15, 8, 5, 938, 51, 11, 497, 4, 64, 5, 4, 11, 17, 5, 6, 7, 8, 2, 4, 1, 24, 240, 692, 91, 832, 550, 1, 1, 27, 3, 6, 276, 7, 597, 10, 4, 772, 1, 6, 1, 5, 69, 6, 5, 3, 2,…
$ `1979`  &lt;dbl&gt; 4, 4, 297, 336, 1, 34, 15, 8, 6, 953, 53, 11, 502, 4, 65, 5, 4, 12, 17, 5, 7, 8, 8, 2, 4, 1, 25, 242, 709, 93, 865, 568, 1, 1, 27, 3, 6, 280, 7, 617, 10, 4, 775, 1, 6, 1, 5, 71, 7, 5, 3, 2,…
$ `1980`  &lt;dbl&gt; 4, 4, 308, 359, 1, 35, 16, 8, 6, 966, 55, 11, 509, 5, 66, 6, 4, 12, 18, 5, 7, 8, 8, 2, 4, 1, 26, 250, 726, 96, 898, 588, 1, 1, 28, 3, 6, 284, 8, 637, 11, 4, 782, 1, 7, 1, 5, 73, 7, 5, 3, 2,…
$ `1981`  &lt;dbl&gt; 4, 4, 318, 375, 1, 35, 17, 8, 6, 978, 58, 11, 517, 5, 67, 6, 4, 12, 19, 6, 7, 8, 8, 2, 4, 1, 27, 264, 745, 98, 930, 608, 1, 1, 29, 3, 6, 289, 8, 658, 11, 4, 794, 1, 7, 1, 6, 75, 7, 5, 3, 2,…
$ `1982`  &lt;dbl&gt; 4, 4, 327, 385, 1, 36, 17, 9, 6, 989, 61, 12, 527, 5, 68, 6, 4, 13, 19, 6, 7, 8, 9, 2, 4, 1, 27, 285, 764, 99, 963, 630, 1, 1, 30, 3, 7, 294, 8, 678, 11, 5, 810, 1, 7, 1, 6, 77, 7, 5, 3, 2,…
$ `1983`  &lt;dbl&gt; 4, 4, 336, 394, 1, 38, 18, 9, 6, 999, 64, 12, 537, 5, 69, 6, 4, 13, 20, 6, 8, 9, 9, 2, 4, 1, 28, 308, 784, 101, 996, 652, 1, 1, 30, 4, 7, 300, 9, 700, 12, 5, 830, 2, 7, 1, 6, 79, 7, 6, 3, 3…
$ `1984`  &lt;dbl&gt; 4, 4, 345, 406, 1, 39, 19, 9, 6, 1, 68, 12, 548, 5, 69, 6, 5, 14, 20, 6, 8, 9, 9, 2, 4, 1, 29, 332, 805, 103, 1, 675, 1, 1, 31, 4, 7, 306, 9, 726, 12, 5, 851, 2, 7, 1, 6, 81, 7, 6, 3, 3, 21…
$ `1985`  &lt;dbl&gt; 4, 4, 355, 426, 2, 40, 19, 10, 7, 1, 72, 12, 559, 6, 70, 6, 5, 14, 21, 6, 8, 9, 10, 2, 5, 2, 29, 352, 827, 105, 1, 699, 1, 1, 32, 4, 7, 312, 9, 756, 12, 5, 872, 2, 7, 1, 6, 83, 7, 6, 3, 3, …
$ `1986`  &lt;dbl&gt; 4, 4, 366, 454, 2, 41, 20, 10, 7, 1, 76, 12, 569, 6, 70, 6, 5, 15, 22, 7, 9, 10, 10, 2, 5, 2, 30, 369, 850, 107, 1, 724, 1, 1, 33, 4, 7, 317, 10, 791, 13, 5, 893, 2, 7, 1, 7, 85, 7, 6, 3, 3…
$ `1987`  &lt;dbl&gt; 5, 5, 377, 490, 2, 43, 21, 10, 8, 1, 80, 12, 579, 6, 70, 6, 5, 15, 22, 7, 9, 10, 10, 2, 5, 2, 31, 383, 874, 110, 1, 749, 1, 1, 34, 4, 8, 321, 10, 831, 13, 5, 913, 2, 8, 1, 7, 88, 7, 6, 4, 3…
$ `1988`  &lt;dbl&gt; 5, 5, 388, 529, 2, 44, 22, 10, 8, 1, 85, 12, 589, 7, 70, 7, 5, 16, 23, 7, 9, 11, 11, 2, 5, 2, 32, 395, 898, 113, 1, 774, 1, 1, 35, 4, 8, 326, 11, 873, 13, 5, 933, 2, 8, 1, 7, 90, 7, 7, 4, 3…
$ `1989`  &lt;dbl&gt; 5, 5, 400, 564, 2, 46, 22, 11, 9, 1, 90, 12, 599, 7, 70, 7, 5, 16, 24, 7, 10, 11, 11, 2, 5, 2, 33, 407, 924, 116, 1, 798, 1, 1, 35, 4, 8, 331, 11, 916, 14, 6, 954, 2, 8, 1, 7, 92, 7, 7, 4, …
$ `1990`  &lt;dbl&gt; 5, 5, 412, 590, 2, 47, 23, 11, 9, 1, 95, 12, 611, 7, 71, 7, 5, 17, 25, 8, 10, 11, 11, 2, 5, 2, 34, 419, 949, 119, 1, 822, 1, 1, 36, 4, 8, 338, 11, 956, 14, 6, 975, 2, 8, 2, 8, 95, 7, 7, 4, …
$ `1991`  &lt;dbl&gt; 5, 5, 424, 607, 2, 49, 24, 11, 9, 1, 100, 13, 622, 7, 71, 7, 5, 17, 26, 8, 10, 12, 12, 2, 6, 2, 35, 433, 976, 122, 1, 845, 1, 1, 37, 5, 9, 346, 12, 993, 15, 6, 998, 2, 8, 2, 8, 97, 7, 7, 4,…
$ `1992`  &lt;dbl&gt; 5, 5, 436, 615, 2, 51, 25, 12, 9, 1, 106, 13, 635, 6, 73, 7, 5, 18, 26, 8, 10, 12, 12, 2, 6, 2, 37, 447, 1, 125, 1, 867, 1, 1, 38, 5, 9, 356, 12, 1, 15, 6, 1, 2, 8, 2, 8, 100, 6, 7, 4, 3, 2…
$ `1993`  &lt;dbl&gt; 5, 5, 449, 619, 2, 53, 26, 12, 9, 1, 112, 14, 648, 6, 74, 7, 5, 19, 27, 8, 11, 13, 12, 3, 6, 2, 38, 463, 1, 127, 1, 888, 1, 1, 39, 5, 9, 366, 13, 1, 16, 6, 1, 1, 9, 2, 8, 102, 6, 8, 4, 4, 2…
$ `1994`  &lt;dbl&gt; 5, 5, 462, 622, 2, 55, 26, 13, 9, 1, 117, 14, 661, 5, 75, 7, 5, 19, 28, 8, 11, 13, 13, 3, 6, 2, 40, 479, 1, 129, 1, 908, 1, 1, 40, 5, 9, 376, 13, 1, 16, 7, 1, 1, 9, 2, 9, 105, 6, 8, 4, 4, 2…
$ `1995`  &lt;dbl&gt; 5, 5, 475, 630, 2, 57, 27, 13, 9, 1, 123, 15, 674, 5, 77, 7, 5, 20, 29, 9, 11, 13, 13, 3, 7, 2, 41, 497, 1, 132, 1, 927, 1, 1, 41, 5, 10, 386, 14, 1, 17, 7, 1, 2, 9, 2, 9, 107, 6, 8, 4, 4, …
$ `1996`  &lt;dbl&gt; 5, 6, 489, 644, 2, 58, 28, 13, 10, 1, 129, 15, 686, 6, 78, 7, 5, 21, 30, 9, 11, 14, 13, 3, 7, 2, 42, 516, 1, 134, 1, 946, 1, 1, 42, 6, 10, 396, 14, 1, 17, 7, 1, 2, 9, 2, 9, 110, 6, 8, 4, 4,…
$ `1997`  &lt;dbl&gt; 5, 6, 502, 661, 2, 60, 29, 14, 10, 1, 134, 16, 699, 6, 78, 7, 5, 21, 31, 9, 11, 14, 14, 3, 7, 2, 43, 536, 1, 136, 1, 963, 1, 1, 42, 6, 10, 404, 15, 1, 17, 7, 1, 2, 10, 2, 10, 113, 6, 9, 4, …
$ `1998`  &lt;dbl&gt; 5, 6, 515, 680, 2, 62, 30, 14, 10, 1, 140, 16, 712, 6, 79, 8, 5, 22, 31, 9, 11, 15, 14, 3, 7, 2, 44, 558, 1, 138, 1, 980, 1, 1, 43, 6, 10, 413, 15, 1, 18, 7, 1, 2, 10, 2, 10, 116, 6, 9, 4, …
$ `1999`  &lt;dbl&gt; 6, 6, 529, 700, 2, 64, 31, 15, 10, 1, 145, 17, 724, 7, 80, 8, 5, 22, 32, 10, 11, 15, 15, 3, 8, 3, 45, 582, 1, 140, 1, 994, 2, 1, 44, 6, 11, 420, 16, 1, 18, 8, 1, 2, 10, 2, 10, 119, 6, 9, 4,…
$ `2000`  &lt;dbl&gt; 6, 6, 542, 718, 2, 66, 31, 15, 11, 1, 150, 17, 737, 7, 81, 8, 6, 23, 33, 10, 11, 16, 15, 3, 8, 3, 47, 606, 1, 142, 1, 1, 2, 1, 44, 6, 11, 428, 16, 1, 19, 8, 1, 2, 10, 2, 11, 122, 6, 9, 4, 4…
$ `2001`  &lt;dbl&gt; 6, 6, 556, 733, 2, 68, 32, 16, 11, 1, 156, 18, 749, 8, 82, 9, 6, 24, 34, 10, 11, 16, 15, 3, 8, 3, 48, 632, 1, 145, 1, 1, 2, 1, 45, 7, 11, 436, 16, 1, 19, 8, 1, 2, 11, 2, 11, 125, 6, 10, 4, …
$ `2002`  &lt;dbl&gt; 6, 6, 569, 747, 2, 70, 33, 16, 11, 1, 161, 18, 760, 8, 84, 9, 6, 25, 35, 10, 11, 17, 16, 3, 9, 3, 49, 658, 1, 147, 1, 1, 2, 1, 46, 7, 12, 443, 17, 1, 20, 8, 1, 3, 11, 2, 12, 128, 6, 10, 4, …
$ `2003`  &lt;dbl&gt; 6, 6, 583, 760, 2, 72, 34, 17, 12, 1, 167, 19, 771, 8, 86, 9, 6, 25, 36, 11, 11, 18, 16, 3, 9, 3, 51, 687, 1, 150, 1, 1, 2, 1, 46, 7, 12, 450, 17, 1, 20, 8, 1, 3, 11, 2, 12, 131, 6, 10, 5, …
$ `2004`  &lt;dbl&gt; 6, 7, 597, 772, 2, 74, 35, 17, 12, 1, 172, 19, 782, 8, 87, 10, 7, 26, 37, 11, 12, 18, 17, 3, 9, 3, 53, 717, 1, 154, 1, 1, 2, 1, 47, 7, 13, 457, 17, 1, 21, 8, 1, 3, 12, 2, 13, 135, 5, 10, 5,…
$ `2005`  &lt;dbl&gt; 6, 7, 612, 783, 2, 76, 36, 18, 12, 1, 178, 20, 792, 8, 89, 10, 7, 27, 38, 11, 12, 19, 17, 4, 10, 3, 54, 750, 1, 157, 1, 1, 1, 1, 47, 7, 13, 463, 18, 1, 21, 9, 1, 3, 12, 3, 13, 138, 5, 11, 5…
$ `2006`  &lt;dbl&gt; 6, 7, 626, 795, 2, 78, 37, 18, 12, 1, 184, 21, 801, 9, 90, 10, 7, 28, 39, 12, 12, 20, 18, 4, 10, 3, 56, 784, 1, 162, 1, 1, 1, 1, 48, 8, 13, 469, 18, 1, 22, 9, 1, 3, 13, 3, 14, 142, 5, 11, 5…
$ `2007`  &lt;dbl&gt; 6, 7, 642, 805, 2, 80, 38, 19, 13, 1, 190, 21, 809, 9, 90, 11, 8, 29, 40, 12, 12, 20, 18, 4, 10, 3, 58, 822, 1, 166, 1, 1, 1, 2, 49, 8, 14, 475, 19, 1, 22, 9, 1, 3, 13, 3, 14, 146, 5, 11, 5…
$ `2008`  &lt;dbl&gt; 6, 8, 657, 816, 3, 82, 39, 19, 13, 1, 196, 22, 816, 9, 90, 11, 8, 30, 41, 12, 12, 21, 19, 4, 11, 4, 60, 861, 1, 171, 1, 1, 1, 2, 49, 8, 14, 481, 19, 1, 23, 9, 1, 3, 14, 3, 15, 150, 5, 12, 6…
$ `2009`  &lt;dbl&gt; 6, 8, 673, 828, 3, 85, 40, 20, 14, 1, 202, 22, 824, 9, 91, 11, 9, 31, 43, 13, 12, 22, 19, 4, 11, 4, 62, 902, 1, 176, 1, 1, 1, 2, 50, 8, 15, 487, 20, 1, 24, 9, 1, 3, 14, 3, 15, 154, 5, 12, 6…
$ `2010`  &lt;dbl&gt; 6, 8, 690, 840, 3, 87, 42, 21, 14, 1, 209, 23, 831, 10, 91, 12, 9, 32, 44, 13, 12, 23, 20, 4, 11, 4, 64, 944, 1, 180, 1, 1, 1, 2, 51, 9, 15, 493, 20, 1, 24, 10, 1, 3, 15, 3, 16, 158, 5, 12,…
$ `2011`  &lt;dbl&gt; 7, 8, 707, 854, 3, 90, 43, 21, 14, 1, 215, 24, 837, 10, 92, 12, 9, 33, 45, 14, 12, 24, 20, 4, 12, 4, 66, 987, 1, 185, 2, 1, 2, 2, 52, 9, 16, 499, 21, 1, 25, 10, 1, 4, 15, 3, 17, 162, 5, 13,…
$ `2012`  &lt;dbl&gt; 7, 9, 724, 868, 3, 92, 44, 22, 15, 1, 221, 24, 844, 10, 93, 12, 10, 34, 47, 14, 13, 25, 21, 4, 12, 4, 69, 1, 1, 188, 2, 1, 2, 2, 52, 9, 16, 505, 21, 1, 25, 10, 1, 4, 15, 3, 17, 167, 5, 13, …
$ `2013`  &lt;dbl&gt; 7, 9, 742, 883, 3, 95, 45, 22, 15, 1, 227, 25, 851, 10, 93, 13, 10, 35, 48, 14, 13, 26, 22, 4, 13, 4, 71, 1, 1, 192, 2, 1, 2, 2, 53, 10, 17, 512, 22, 1, 26, 10, 1, 4, 16, 3, 18, 171, 6, 13,…
$ `2014`  &lt;dbl&gt; 7, 9, 759, 899, 3, 98, 46, 23, 16, 1, 234, 26, 857, 11, 94, 13, 10, 36, 49, 15, 13, 26, 22, 4, 13, 4, 73, 1, 1, 196, 2, 1, 2, 2, 54, 10, 17, 518, 22, 2, 27, 11, 1, 4, 16, 3, 19, 176, 6, 14,…
$ `2015`  &lt;dbl&gt; 7, 10, 777, 914, 3, 100, 47, 24, 16, 1, 240, 27, 863, 11, 95, 13, 10, 38, 51, 15, 13, 27, 23, 4, 14, 4, 76, 1, 1, 199, 2, 1, 2, 2, 55, 10, 18, 525, 23, 2, 27, 11, 1, 4, 17, 4, 20, 181, 6, 1…
$ `2016`  &lt;dbl&gt; 7, 10, 796, 929, 3, 103, 49, 24, 17, 1, 246, 27, 870, 11, 96, 14, 10, 39, 53, 16, 14, 28, 23, 4, 14, 4, 78, 1, 2, 203, 2, 1, 2, 2, 56, 10, 18, 531, 23, 2, 28, 11, 1, 4, 17, 4, 20, 185, 6, 1…
$ `2017`  &lt;dbl&gt; 7, 10, 814, 944, 3, 106, 50, 25, 17, 1, 253, 28, 876, 11, 96, 14, 10, 41, 54, 16, 14, 29, 24, 4, 15, 5, 81, 1, 2, 207, 2, 1, 2, 2, 57, 11, 19, 537, 24, 2, 29, 12, 1, 4, 18, 4, 21, 190, 6, 1…
$ `2018`  &lt;dbl&gt; 7, 11, 832, 959, 3, 109, 51, 26, 18, 1, 260, 29, 883, 12, 97, 15, 10, 42, 56, 17, 14, 30, 25, 4, 15, 5, 84, 1, 2, 211, 2, 1, 2, 2, 57, 11, 19, 544, 25, 2, 29, 12, 1, 4, 19, 4, 22, 195, 6, 1…
$ `2019`  &lt;dbl&gt; 7, 11, 851, 974, 3, 112, 52, 26, 18, 1, 266, 30, 889, 12, 98, 15, 11, 44, 58, 17, 14, 31, 25, 4, 15, 5, 86, 1, 2, 215, 2, 1, 2, 2, 58, 11, 20, 550, 25, 2, 30, 12, 1, 4, 19, 4, 23, 200, 6, 1…
$ `2020`  &lt;dbl&gt; 7, 11, 870, 988, 3, 114, 53, 27, 19, 1, 273, 31, 895, 12, 98, 15, 11, 45, 59, 18, 14, 32, 26, 4, 16, 5, 89, 1, 2, 219, 2, 1, 2, 2, 59, 12, 20, 556, 26, 2, 31, 13, 1, 5, 20, 4, 24, 206, 6, 1…</code></pre>
<p>Does that look correct to you?</p>
<p>No. Why is the world population only 2 for 1950? If you read the documentation
for the data, you may notice that population is recorded in thousands, but I still
think that there were more than <span class="math inline">\(2,000\)</span> people in the world in 1950. Also, I’m
pretty sure the single country of Comoros shouldn’t have more people than the
entire world.</p>
<p>Always look at the data when you read it in.</p>
<p>The problem is debugged by printing the data out on the command line like we did above,
and noticing that in the original file, numbers are stored with spaces in them.
We have to remove these spaces for <code>R</code> to read in the data correctly. This kind
of simple but annoying thing happens <em>all the time</em> when analyzing data “in the wild.”</p>
<p>To remove the spaces (this works for any annoying character like a period, or a
dollar sign, or whatever), read the data in with all columns as character, process
the data in <code>R</code>, and then convert to numeric. Check it out:</p>
<div class="sourceCode" id="section-cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb398-1"><a href="section-extended-example-world-population-data.html#section-cb398-1" aria-hidden="true" tabindex="-1"></a>remove_space <span class="ot">&lt;-</span> <span class="cf">function</span>(x) stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(x,<span class="st">&quot; &quot;</span>)</span>
<span id="section-cb398-2"><a href="section-extended-example-world-population-data.html#section-cb398-2" aria-hidden="true" tabindex="-1"></a>worldpop <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="section-cb398-3"><a href="section-extended-example-world-population-data.html#section-cb398-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;data/worldpop/worldpop-estimates.csv&quot;</span>,</span>
<span id="section-cb398-4"><a href="section-extended-example-world-population-data.html#section-cb398-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_names =</span> <span class="cn">TRUE</span>,</span>
<span id="section-cb398-5"><a href="section-extended-example-world-population-data.html#section-cb398-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> stringr<span class="sc">::</span><span class="fu">str_c</span>(<span class="fu">rep</span>(<span class="st">&quot;c&quot;</span>,<span class="dv">72</span>),<span class="at">collapse =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="section-cb398-6"><a href="section-extended-example-world-population-data.html#section-cb398-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="section-cb398-7"><a href="section-extended-example-world-population-data.html#section-cb398-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove the space</span></span>
<span id="section-cb398-8"><a href="section-extended-example-world-population-data.html#section-cb398-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="st">`</span><span class="at">1950</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2020</span><span class="st">`</span>),remove_space) <span class="sc">%&gt;%</span></span>
<span id="section-cb398-9"><a href="section-extended-example-world-population-data.html#section-cb398-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to numeric</span></span>
<span id="section-cb398-10"><a href="section-extended-example-world-population-data.html#section-cb398-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="st">`</span><span class="at">1950</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2020</span><span class="st">`</span>),as.numeric)</span>
<span id="section-cb398-11"><a href="section-extended-example-world-population-data.html#section-cb398-11" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(worldpop)</span></code></pre></div>
<pre><code>Rows: 236
Columns: 72
$ country &lt;chr&gt; &quot;WORLD&quot;, &quot;Burundi&quot;, &quot;Comoros&quot;, &quot;Djibouti&quot;, &quot;Eritrea&quot;, &quot;Ethiopia&quot;, &quot;Kenya&quot;, &quot;Madagascar&quot;, &quot;Malawi&quot;, &quot;Mauritius&quot;, &quot;Mayotte&quot;, &quot;Mozambique&quot;, &quot;Réunion&quot;, &quot;Rwanda&quot;, &quot;Seychelles&quot;, &quot;Somalia&quot;, &quot;South…
$ `1950`  &lt;dbl&gt; 2536431, 2309, 159, 62, 822, 18128, 6077, 4084, 2954, 493, 15, 5959, 248, 2186, 36, 2264, 2482, 5158, 7650, 2310, 2747, 4548, 4307, 1327, 2502, 827, 12184, 226, 473, 60, 413, 273, 705, 514,…
$ `1951`  &lt;dbl&gt; 2584034, 2360, 163, 63, 835, 18467, 6242, 4168, 3012, 506, 16, 6059, 259, 2251, 37, 2308, 2502, 5308, 7845, 2369, 2832, 4617, 4384, 1342, 2544, 842, 12429, 231, 476, 59, 424, 279, 717, 524,…
$ `1952`  &lt;dbl&gt; 2630862, 2406, 167, 65, 849, 18820, 6416, 4257, 3072, 521, 16, 6165, 268, 2314, 37, 2352, 2525, 5453, 8051, 2431, 2922, 4713, 4462, 1356, 2589, 858, 12681, 234, 479, 59, 435, 285, 729, 534,…
$ `1953`  &lt;dbl&gt; 2677609, 2449, 170, 66, 865, 19184, 6598, 4349, 3136, 537, 17, 6275, 277, 2380, 38, 2397, 2553, 5596, 8267, 2498, 3016, 4823, 4542, 1371, 2636, 875, 12944, 236, 481, 58, 445, 291, 741, 545,…
$ `1954`  &lt;dbl&gt; 2724847, 2492, 173, 68, 882, 19560, 6789, 4444, 3202, 554, 18, 6390, 284, 2450, 39, 2444, 2585, 5741, 8494, 2570, 3113, 4936, 4623, 1385, 2685, 893, 13223, 238, 482, 58, 455, 297, 754, 556,…
$ `1955`  &lt;dbl&gt; 2773020, 2537, 176, 70, 900, 19947, 6988, 4544, 3271, 571, 19, 6508, 292, 2527, 39, 2492, 2620, 5889, 8730, 2645, 3213, 5043, 4707, 1401, 2735, 911, 13518, 240, 484, 59, 463, 303, 767, 568,…
$ `1956`  &lt;dbl&gt; 2822443, 2585, 179, 71, 919, 20348, 7195, 4647, 3342, 588, 20, 6632, 300, 2610, 39, 2541, 2658, 6043, 8975, 2724, 3317, 5141, 4793, 1418, 2786, 930, 13830, 242, 487, 60, 471, 309, 780, 580,…
$ `1957`  &lt;dbl&gt; 2873306, 2636, 182, 74, 939, 20764, 7412, 4754, 3417, 605, 21, 6760, 308, 2696, 40, 2592, 2700, 6206, 9230, 2806, 3425, 5228, 4883, 1437, 2838, 951, 14161, 245, 489, 61, 479, 316, 794, 593,…
$ `1958`  &lt;dbl&gt; 2925687, 2689, 185, 76, 961, 21201, 7638, 4865, 3495, 623, 22, 6894, 317, 2782, 40, 2645, 2745, 6379, 9494, 2892, 3537, 5307, 4976, 1457, 2891, 972, 14509, 248, 493, 62, 486, 323, 808, 606,…
$ `1959`  &lt;dbl&gt; 2979576, 2743, 188, 80, 983, 21662, 7874, 4980, 3576, 641, 23, 7036, 326, 2863, 41, 2700, 2792, 6566, 9768, 2980, 3654, 5381, 5074, 1479, 2945, 995, 14872, 252, 497, 64, 494, 330, 822, 620,…
$ `1960`  &lt;dbl&gt; 3034950, 2798, 191, 84, 1008, 22151, 8120, 5099, 3660, 660, 24, 7185, 336, 2936, 42, 2756, 2843, 6767, 10052, 3071, 3777, 5455, 5177, 1502, 3002, 1018, 15248, 255, 501, 64, 503, 337, 837, 6…
$ `1961`  &lt;dbl&gt; 3091844, 2852, 194, 89, 1033, 22671, 8378, 5224, 3748, 679, 25, 7342, 345, 2998, 42, 2814, 2896, 6984, 10347, 3164, 3905, 5531, 5285, 1526, 3060, 1043, 15638, 259, 506, 65, 513, 343, 853, 6…
$ `1962`  &lt;dbl&gt; 3150421, 2907, 197, 94, 1060, 23221, 8647, 5352, 3839, 698, 27, 7507, 355, 3053, 43, 2874, 2951, 7216, 10652, 3261, 4039, 5608, 5399, 1552, 3121, 1069, 16041, 262, 511, 64, 524, 350, 869, 6…
$ `1963`  &lt;dbl&gt; 3211001, 2964, 200, 101, 1089, 23798, 8929, 5486, 3934, 717, 28, 7679, 366, 3105, 45, 2936, 3009, 7462, 10968, 3360, 4179, 5679, 5518, 1579, 3184, 1097, 16462, 266, 518, 64, 536, 357, 886, …
$ `1964`  &lt;dbl&gt; 3273978, 3026, 204, 108, 1118, 24397, 9223, 5625, 4032, 736, 29, 7857, 378, 3164, 46, 3001, 3070, 7719, 11296, 3463, 4323, 5735, 5643, 1609, 3247, 1125, 16904, 271, 525, 64, 548, 365, 904, …
$ `1965`  &lt;dbl&gt; 3339584, 3094, 207, 115, 1148, 25014, 9530, 5769, 4134, 753, 31, 8039, 391, 3236, 47, 3068, 3133, 7986, 11635, 3570, 4471, 5771, 5774, 1640, 3310, 1155, 17370, 276, 533, 65, 560, 374, 922, …
$ `1966`  &lt;dbl&gt; 3407923, 3170, 211, 123, 1179, 25641, 9851, 5919, 4240, 770, 32, 8226, 405, 3322, 48, 3144, 3199, 8263, 11985, 3682, 4623, 5781, 5910, 1673, 3372, 1187, 17862, 284, 543, 66, 572, 384, 942, …
$ `1967`  &lt;dbl&gt; 3478770, 3253, 216, 131, 1210, 26280, 10187, 6074, 4350, 785, 33, 8418, 421, 3421, 49, 3228, 3268, 8550, 12348, 3798, 4780, 5774, 6052, 1708, 3435, 1220, 18379, 292, 554, 68, 584, 395, 962,…
$ `1968`  &lt;dbl&gt; 3551599, 3337, 221, 140, 1243, 26944, 10540, 6234, 4464, 799, 34, 8614, 437, 3530, 50, 3313, 3340, 8841, 12726, 3919, 4942, 5772, 6201, 1744, 3499, 1254, 18914, 299, 566, 70, 597, 407, 984,…
$ `1969`  &lt;dbl&gt; 3625681, 3414, 225, 150, 1276, 27653, 10911, 6402, 4582, 813, 36, 8816, 451, 3643, 51, 3387, 3416, 9128, 13121, 4046, 5111, 5804, 6357, 1779, 3568, 1290, 19460, 304, 578, 73, 611, 419, 1006…
$ `1970`  &lt;dbl&gt; 3700437, 3479, 230, 160, 1311, 28415, 11301, 6576, 4704, 826, 37, 9023, 462, 3757, 52, 3445, 3494, 9406, 13535, 4179, 5289, 5890, 6520, 1811, 3644, 1327, 20011, 304, 589, 75, 628, 431, 1029…
$ `1971`  &lt;dbl&gt; 3775760, 3530, 235, 169, 1347, 29249, 11713, 6758, 4829, 840, 39, 9233, 470, 3871, 54, 3472, 3576, 9672, 13972, 4319, 5477, 6041, 6690, 1841, 3726, 1366, 20564, 299, 601, 76, 646, 444, 1053…
$ `1972`  &lt;dbl&gt; 3851651, 3570, 239, 179, 1385, 30141, 12146, 6947, 4959, 852, 40, 9446, 475, 3987, 55, 3480, 3661, 9930, 14428, 4466, 5674, 6249, 6867, 1868, 3815, 1407, 21121, 290, 612, 78, 667, 457, 1077…
$ `1973`  &lt;dbl&gt; 3927781, 3605, 244, 191, 1424, 31037, 12601, 7143, 5093, 865, 42, 9669, 479, 4106, 57, 3513, 3751, 10186, 14902, 4620, 5878, 6497, 7053, 1895, 3908, 1449, 21690, 278, 623, 79, 690, 471, 110…
$ `1974`  &lt;dbl&gt; 4003794, 3646, 250, 205, 1464, 31861, 13077, 7346, 5235, 878, 44, 9907, 482, 4232, 58, 3633, 3844, 10453, 15389, 4779, 6085, 6762, 7247, 1924, 4000, 1492, 22282, 266, 635, 81, 715, 485, 113…
$ `1975`  &lt;dbl&gt; 4079480, 3701, 257, 224, 1505, 32567, 13576, 7556, 5385, 892, 45, 10165, 485, 4365, 60, 3880, 3942, 10737, 15885, 4943, 6294, 7024, 7451, 1958, 4089, 1537, 22904, 256, 648, 83, 741, 500, 11…
$ `1976`  &lt;dbl&gt; 4154667, 3771, 266, 249, 1548, 33128, 14096, 7773, 5546, 907, 47, 10444, 488, 4506, 61, 4279, 4042, 11043, 16390, 5113, 6503, 7280, 7664, 1997, 4173, 1582, 23560, 248, 661, 85, 770, 516, 11…
$ `1977`  &lt;dbl&gt; 4229506, 3854, 276, 277, 1592, 33577, 14639, 7998, 5718, 922, 49, 10739, 492, 4655, 62, 4802, 4145, 11369, 16905, 5288, 6713, 7534, 7888, 2040, 4255, 1629, 24249, 242, 676, 88, 801, 532, 12…
$ `1978`  &lt;dbl&gt; 4304534, 3949, 287, 308, 1637, 33993, 15205, 8230, 5897, 938, 51, 11041, 497, 4813, 64, 5375, 4253, 11713, 17433, 5468, 6930, 7791, 8121, 2088, 4337, 1677, 24956, 240, 692, 91, 832, 550, 12…
$ `1979`  &lt;dbl&gt; 4380506, 4051, 297, 336, 1684, 34488, 15798, 8470, 6075, 953, 53, 11341, 502, 4979, 65, 5893, 4372, 12071, 17976, 5656, 7160, 8058, 8366, 2141, 4423, 1727, 25664, 242, 709, 93, 865, 568, 13…
$ `1980`  &lt;dbl&gt; 4458003, 4157, 308, 359, 1733, 35142, 16417, 8717, 6250, 966, 55, 11630, 509, 5153, 66, 6281, 4503, 12442, 18538, 5852, 7409, 8341, 8621, 2199, 4514, 1778, 26359, 250, 726, 96, 898, 588, 13…
$ `1981`  &lt;dbl&gt; 4536997, 4267, 318, 375, 1785, 35985, 17064, 8971, 6412, 978, 58, 11913, 517, 5329, 67, 6511, 4646, 12825, 19121, 6055, 7676, 8640, 8889, 2264, 4613, 1831, 27040, 264, 745, 98, 930, 608, 13…
$ `1982`  &lt;dbl&gt; 4617387, 4380, 327, 385, 1837, 36995, 17736, 9234, 6566, 989, 61, 12190, 527, 5505, 68, 6608, 4799, 13222, 19723, 6266, 7958, 8953, 9167, 2335, 4718, 1885, 27717, 285, 764, 99, 963, 630, 14…
$ `1983`  &lt;dbl&gt; 4699569, 4498, 336, 394, 1891, 38143, 18432, 9504, 6738, 999, 64, 12440, 537, 5691, 69, 6619, 4953, 13639, 20345, 6482, 8255, 9278, 9456, 2408, 4832, 1940, 28404, 308, 784, 101, 996, 652, 1…
$ `1984`  &lt;dbl&gt; 4784012, 4621, 345, 406, 1946, 39374, 19146, 9781, 6965, 1008, 68, 12636, 548, 5903, 69, 6615, 5096, 14083, 20982, 6702, 8562, 9615, 9758, 2478, 4958, 1997, 29120, 332, 805, 103, 1031, 675,…
$ `1985`  &lt;dbl&gt; 4870922, 4751, 355, 426, 2004, 40652, 19877, 10063, 7268, 1016, 72, 12764, 559, 6147, 70, 6649, 5221, 14559, 21634, 6923, 8877, 9962, 10071, 2542, 5095, 2054, 29881, 352, 827, 105, 1070, 69…
$ `1986`  &lt;dbl&gt; 4960568, 4887, 366, 454, 2065, 41966, 20623, 10352, 7666, 1023, 76, 12809, 569, 6444, 70, 6737, 5328, 15070, 22296, 7147, 9200, 10320, 10395, 2598, 5247, 2112, 30684, 369, 850, 107, 1111, 7…
$ `1987`  &lt;dbl&gt; 5052522, 5027, 377, 490, 2127, 43329, 21382, 10648, 8141, 1030, 80, 12786, 579, 6780, 70, 6862, 5420, 15613, 22971, 7373, 9527, 10689, 10731, 2647, 5413, 2171, 31529, 383, 874, 110, 1155, 7…
$ `1988`  &lt;dbl&gt; 5145426, 5169, 388, 529, 2186, 44757, 22154, 10952, 8637, 1037, 85, 12758, 589, 7088, 70, 7005, 5485, 16180, 23671, 7598, 9849, 11068, 11075, 2694, 5590, 2231, 32444, 395, 898, 113, 1200, 7…
$ `1989`  &lt;dbl&gt; 5237441, 5307, 400, 564, 2231, 46272, 22935, 11269, 9076, 1046, 90, 12806, 599, 7277, 70, 7133, 5512, 16763, 24412, 7820, 10154, 11455, 11426, 2746, 5774, 2293, 33465, 407, 924, 116, 1244, …
$ `1990`  &lt;dbl&gt; 5327231, 5439, 412, 590, 2259, 47888, 23725, 11599, 9404, 1056, 95, 12987, 611, 7289, 71, 7225, 5493, 17354, 25204, 8037, 10432, 11848, 11780, 2807, 5963, 2357, 34612, 419, 949, 119, 1287, …
$ `1991`  &lt;dbl&gt; 5414289, 5565, 424, 607, 2266, 49610, 24522, 11943, 9600, 1068, 100, 13328, 622, 7084, 71, 7274, 5420, 17954, 26057, 8247, 10681, 12249, 12138, 2879, 6157, 2422, 35908, 433, 976, 122, 1326,…
$ `1992`  &lt;dbl&gt; 5498920, 5686, 436, 615, 2258, 51424, 25326, 12301, 9686, 1083, 106, 13806, 635, 6702, 73, 7295, 5305, 18562, 26961, 8451, 10901, 12657, 12499, 2959, 6357, 2490, 37334, 447, 1003, 125, 1364…
$ `1993`  &lt;dbl&gt; 5581598, 5798, 449, 619, 2239, 53296, 26136, 12675, 9710, 1099, 112, 14371, 648, 6264, 74, 7316, 5186, 19176, 27887, 8656, 11093, 13075, 12864, 3046, 6564, 2560, 38816, 463, 1030, 127, 1399…
$ `1994`  &lt;dbl&gt; 5663150, 5899, 462, 622, 2218, 55181, 26951, 13067, 9746, 1114, 117, 14948, 661, 5936, 75, 7373, 5111, 19794, 28793, 8870, 11262, 13504, 13231, 3135, 6781, 2632, 40253, 479, 1057, 129, 1434…
$ `1995`  &lt;dbl&gt; 5744213, 5987, 475, 630, 2204, 57048, 27768, 13475, 9844, 1129, 123, 15483, 674, 5836, 77, 7492, 5118, 20413, 29649, 9097, 11411, 13945, 13600, 3223, 7010, 2708, 41576, 497, 1085, 132, 1469…
$ `1996`  &lt;dbl&gt; 5824892, 6060, 489, 644, 2196, 58884, 28589, 13903, 10023, 1142, 129, 15960, 686, 6013, 78, 7683, 5222, 21033, 30445, 9340, 11541, 14401, 13971, 3308, 7251, 2786, 42757, 516, 1113, 134, 150…
$ `1997`  &lt;dbl&gt; 5905046, 6122, 502, 661, 2195, 60697, 29416, 14348, 10265, 1154, 134, 16397, 699, 6420, 78, 7936, 5412, 21655, 31193, 9598, 11653, 14872, 14344, 3392, 7503, 2867, 43827, 536, 1141, 136, 154…
$ `1998`  &lt;dbl&gt; 5984794, 6186, 515, 680, 2206, 62508, 30250, 14809, 10552, 1165, 140, 16814, 712, 6963, 79, 8235, 5662, 22291, 31924, 9866, 11747, 15360, 14724, 3475, 7770, 2952, 44850, 558, 1170, 138, 157…
$ `1999`  &lt;dbl&gt; 6064239, 6267, 529, 700, 2237, 64343, 31099, 15283, 10854, 1176, 145, 17244, 724, 7501, 80, 8554, 5934, 22952, 32682, 10141, 11823, 15867, 15113, 3558, 8054, 3038, 45920, 582, 1199, 140, 16…
$ `2000`  &lt;dbl&gt; 6143494, 6379, 542, 718, 2292, 66225, 31965, 15767, 11149, 1185, 150, 17712, 737, 7934, 81, 8872, 6199, 23650, 33499, 10416, 11881, 16395, 15514, 3640, 8356, 3127, 47106, 606, 1228, 142, 16…
$ `2001`  &lt;dbl&gt; 6222627, 6526, 556, 733, 2375, 68159, 32849, 16261, 11432, 1194, 156, 18222, 749, 8231, 82, 9187, 6448, 24389, 34386, 10692, 11924, 16946, 15929, 3722, 8678, 3218, 48429, 632, 1258, 145, 16…
$ `2002`  &lt;dbl&gt; 6301773, 6704, 569, 747, 2481, 70142, 33752, 16765, 11714, 1202, 161, 18764, 760, 8427, 84, 9501, 6688, 25167, 35335, 10972, 11954, 17519, 16358, 3802, 9019, 3310, 49872, 658, 1288, 147, 17…
$ `2003`  &lt;dbl&gt; 6381185, 6909, 583, 760, 2601, 72171, 34679, 17279, 12000, 1209, 167, 19331, 771, 8557, 86, 9815, 6936, 25981, 36338, 11257, 11982, 18121, 16801, 3881, 9374, 3407, 51426, 687, 1320, 150, 17…
$ `2004`  &lt;dbl&gt; 6461159, 7132, 597, 772, 2720, 74240, 35635, 17803, 12302, 1216, 172, 19911, 782, 8681, 87, 10130, 7213, 26821, 37380, 11551, 12020, 18758, 17259, 3960, 9735, 3510, 53069, 717, 1354, 154, 1…
$ `2005`  &lt;dbl&gt; 6541907, 7365, 612, 783, 2827, 76346, 36625, 18337, 12626, 1222, 178, 20494, 792, 8840, 89, 10447, 7536, 27685, 38450, 11856, 12077, 19434, 17733, 4038, 10097, 3623, 54786, 750, 1391, 157, …
$ `2006`  &lt;dbl&gt; 6623518, 7608, 626, 795, 2918, 78489, 37649, 18880, 12974, 1228, 184, 21080, 801, 9043, 90, 10764, 7907, 28571, 39549, 12174, 12155, 20150, 18224, 4118, 10457, 3745, 56578, 784, 1430, 162, …
$ `2007`  &lt;dbl&gt; 6705947, 7862, 642, 805, 2997, 80674, 38706, 19434, 13342, 1234, 190, 21673, 809, 9274, 90, 11080, 8315, 29486, 40681, 12503, 12256, 20905, 18730, 4198, 10818, 3876, 58454, 822, 1473, 166, …
$ `2008`  &lt;dbl&gt; 6789089, 8126, 657, 816, 3063, 82916, 39792, 19996, 13728, 1239, 196, 22277, 816, 9525, 90, 11397, 8737, 30432, 41854, 12849, 12380, 21696, 19253, 4273, 11184, 4011, 60411, 861, 1519, 171, …
$ `2009`  &lt;dbl&gt; 6872767, 8398, 673, 828, 3120, 85234, 40902, 20569, 14128, 1244, 202, 22895, 824, 9783, 91, 11718, 9142, 31411, 43074, 13215, 12527, 22514, 19790, 4338, 11560, 4145, 62449, 902, 1569, 176, …
$ `2010`  &lt;dbl&gt; 6956824, 8676, 690, 840, 3170, 87640, 42031, 21152, 14540, 1248, 209, 23532, 831, 10039, 91, 12044, 9508, 32428, 44347, 13606, 12698, 23356, 20341, 4387, 11952, 4274, 64564, 944, 1624, 180,…
$ `2011`  &lt;dbl&gt; 7041194, 8958, 707, 854, 3214, 90140, 43178, 21744, 14962, 1251, 215, 24188, 837, 10293, 92, 12376, 9831, 33477, 45674, 14023, 12894, 24221, 20906, 4419, 12361, 4395, 66755, 987, 1685, 185,…
$ `2012`  &lt;dbl&gt; 7125828, 9246, 724, 868, 3250, 92727, 44343, 22347, 15396, 1253, 221, 24863, 844, 10550, 93, 12715, 10114, 34559, 47053, 14465, 13115, 25108, 21485, 4436, 12785, 4510, 69021, 1031, 1750, 18…
$ `2013`  &lt;dbl&gt; 7210582, 9540, 742, 883, 3281, 95386, 45520, 22961, 15839, 1255, 227, 25561, 851, 10812, 93, 13064, 10355, 35695, 48483, 14927, 13350, 26016, 22077, 4448, 13220, 4623, 71359, 1076, 1817, 19…
$ `2014`  &lt;dbl&gt; 7295291, 9844, 759, 899, 3311, 98094, 46700, 23590, 16290, 1257, 234, 26286, 857, 11084, 94, 13424, 10555, 36912, 49961, 15400, 13587, 26942, 22682, 4464, 13664, 4737, 73767, 1122, 1884, 19…
$ `2015`  &lt;dbl&gt; 7379797, 10160, 777, 914, 3343, 100835, 47878, 24234, 16745, 1259, 240, 27042, 863, 11369, 95, 13797, 10716, 38225, 51483, 15879, 13815, 27884, 23298, 4493, 14111, 4856, 76245, 1169, 1948, …
$ `2016`  &lt;dbl&gt; 7464022, 10488, 796, 929, 3377, 103603, 49052, 24894, 17205, 1262, 246, 27830, 870, 11669, 96, 14186, 10833, 39649, 53049, 16363, 14030, 28842, 23927, 4538, 14562, 4981, 78789, 1215, 2008, …
$ `2017`  &lt;dbl&gt; 7547859, 10827, 814, 944, 3413, 106400, 50221, 25571, 17670, 1264, 253, 28649, 876, 11981, 96, 14589, 10911, 41167, 54660, 16854, 14237, 29817, 24566, 4596, 15017, 5111, 81399, 1262, 2065, …
$ `2018`  &lt;dbl&gt; 7631091, 11175, 832, 959, 3453, 109224, 51393, 26262, 18143, 1267, 260, 29496, 883, 12302, 97, 15008, 10976, 42729, 56313, 17352, 14439, 30810, 25216, 4666, 15478, 5244, 84068, 1309, 2119, …
$ `2019`  &lt;dbl&gt; 7713468, 11531, 851, 974, 3497, 112079, 52574, 26969, 18629, 1270, 266, 30366, 889, 12627, 98, 15443, 11062, 44270, 58005, 17861, 14645, 31825, 25876, 4745, 15947, 5381, 86791, 1356, 2173, …
$ `2020`  &lt;dbl&gt; 7794799, 11891, 870, 988, 3546, 114964, 53771, 27691, 19130, 1272, 273, 31255, 895, 12952, 98, 15893, 11194, 45741, 59734, 18384, 14863, 32866, 26546, 4830, 16426, 5518, 89561, 1403, 2226, …</code></pre>
<p>Good. Verify that a few values of your choosing match their entries in the original
text data.</p>
<p>The data are in wide format, with the “year” variable contained in the columns. We
want the data in long format for analysis, with two variables, <code>country</code> and <code>year</code>,
and a variable containing the population count.</p>
<p>We can do that:</p>
<div class="sourceCode" id="section-cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb400-1"><a href="section-extended-example-world-population-data.html#section-cb400-1" aria-hidden="true" tabindex="-1"></a>worldpop <span class="ot">&lt;-</span> worldpop <span class="sc">%&gt;%</span></span>
<span id="section-cb400-2"><a href="section-extended-example-world-population-data.html#section-cb400-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="section-cb400-3"><a href="section-extended-example-world-population-data.html#section-cb400-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">1950</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2020</span><span class="st">`</span>,</span>
<span id="section-cb400-4"><a href="section-extended-example-world-population-data.html#section-cb400-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="section-cb400-5"><a href="section-extended-example-world-population-data.html#section-cb400-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;population&quot;</span></span>
<span id="section-cb400-6"><a href="section-extended-example-world-population-data.html#section-cb400-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="section-cb400-7"><a href="section-extended-example-world-population-data.html#section-cb400-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.numeric</span>(year))</span>
<span id="section-cb400-8"><a href="section-extended-example-world-population-data.html#section-cb400-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(worldpop)</span></code></pre></div>
<pre><code>Rows: 16,756
Columns: 3
$ country    &lt;chr&gt; &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD…
$ year       &lt;dbl&gt; 1950, 1951, 1952, 1953, 1954, 1955, 1956, 1957, 1958, 1959, 1960, 1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969, 1970, 1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980, …
$ population &lt;dbl&gt; 2536431, 2584034, 2630862, 2677609, 2724847, 2773020, 2822443, 2873306, 2925687, 2979576, 3034950, 3091844, 3150421, 3211001, 3273978, 3339584, 3407923, 3478770, 3551599, 3625681, 370043…</code></pre>
<p>That looks better! Do the following exercises:</p>
<p><strong>Exercises</strong>:</p>
<ol style="list-style-type: decimal">
<li><p>What is the estimated world population in 2020 (remember, the recorded
values are in <strong>thousands</strong> of people. Answer this question in terms of
<strong>number of people</strong>)?</p></li>
<li><p>What is the estimated world population in Canada in 1975? Use the <code>filter</code> function.</p></li>
<li><p>The total world population should equal the sum of the population in each country.
Check this. Do the following:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Compute the world population by summing the population of each country.
Use the <code>filter</code> function to remove the <code>WORLD</code> row from each year. Then use
<code>group_by</code> and <code>summarize</code> to sum <code>population</code> over <code>country</code>. Save the result
in a dataframe called <code>worldpop_summed</code>.</p></li>
<li><p>Pull the UN’s estimated world population by using the <code>filter</code> function to
<em>keep</em> only the <code>WORLD</code> row from each year. Save this in a dataframe called
<code>worldpop_un</code>.</p></li>
<li><p>Join them, and make a plot of the <em>difference</em> between the sum of the countries’
populations and the UN’s estimate, for each year. Here’s what I got for both the
data and the plot:</p></li>
</ol></li>
</ol>
<pre><code>`summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>Rows: 71
Columns: 4
$ year       &lt;dbl&gt; 1950, 1951, 1952, 1953, 1954, 1955, 1956, 1957, 1958, 1959, 1960, 1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969, 1970, 1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980, …
$ worldpop   &lt;dbl&gt; 2536428, 2584029, 2630861, 2677604, 2724850, 2773023, 2822442, 2873305, 2925685, 2979581, 3034959, 3091839, 3150407, 3211001, 3273979, 3339582, 3407923, 3478772, 3551605, 3625689, 370044…
$ country    &lt;chr&gt; &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD…
$ population &lt;dbl&gt; 2536431, 2584034, 2630862, 2677609, 2724847, 2773020, 2822443, 2873306, 2925687, 2979576, 3034950, 3091844, 3150421, 3211001, 3273978, 3339584, 3407923, 3478770, 3551599, 3625681, 370043…</code></pre>
<p><img src="book_files/figure-html/worldpopexercise-1-1.png" width="672" /></p>
<p><em>Hints</em>: use <code>scale_x_discrete(breaks = as.character(seq(1950,2020,by=5)))</code> to get
the five-year axis, and use <code>theme(axis.text.x = element_text(angle = 90))</code> to make the axis text
sideways. Use <code>geom_bar(stat = "identity")</code> to get the bar plot. Or, make another
type of plot of your choosing! Don’t be afraid to have some fun.</p>
<p>Now, for later in this chapter, we’re going to need data on the world population projections
from 2020–2100. The median and “95% intervals” (you’ll learn what this means later)
are all stored in seperate files. I’ll read in the “median” one and then you’ll read
in the “interval” ones and then join them all together.</p>
<p>The prediction data is mostly in the same format as the population estimates. The
numbers are now stored with quotes and with thousands separated by commas, however.
Like when it was stored with thousands separated by spaces, we have to read it in
as a character, and then process the data in <code>R</code> and convert to numeric.</p>
<div class="sourceCode" id="section-cb404"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="section-cb404-1"><a href="section-extended-example-world-population-data.html#section-cb404-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> data/worldpop/worldpop-pred-median.csv</span></code></pre></div>
<pre><code>﻿country,2020,2025,2030,2035,2040,2045,2050,2055,2060,2065,2070,2075,2080,2085,2090,2095,2100
WORLD,&quot;7,794,799&quot;,&quot;8,184,437&quot;,&quot;8,548,487&quot;,&quot;8,887,524&quot;,&quot;9,198,847&quot;,&quot;9,481,803&quot;,&quot;9,735,034&quot;,&quot;9,958,099&quot;,&quot;10,151,470&quot;,&quot;10,317,879&quot;,&quot;10,459,240&quot;,&quot;10,577,288&quot;,&quot;10,673,904&quot;,&quot;10,750,662&quot;,&quot;10,809,892&quot;,&quot;10,851,860&quot;,&quot;10,875,394&quot;
Eastern Africa,&quot;445,406&quot;,&quot;505,292&quot;,&quot;569,705&quot;,&quot;637,437&quot;,&quot;707,393&quot;,&quot;778,916&quot;,&quot;851,218&quot;,&quot;923,483&quot;,&quot;994,888&quot;,&quot;1,064,642&quot;,&quot;1,131,895&quot;,&quot;1,195,953&quot;,&quot;1,256,219&quot;,&quot;1,312,230&quot;,&quot;1,363,577&quot;,&quot;1,410,118&quot;,&quot;1,451,842&quot;
Burundi,&quot;11,891&quot;,&quot;13,764&quot;,&quot;15,773&quot;,&quot;17,932&quot;,&quot;20,253&quot;,&quot;22,728&quot;,&quot;25,325&quot;,&quot;27,995&quot;,&quot;30,701&quot;,&quot;33,408&quot;,&quot;36,107&quot;,&quot;38,790&quot;,&quot;41,427&quot;,&quot;43,993&quot;,&quot;46,451&quot;,&quot;48,761&quot;,&quot;50,904&quot;
Comoros,870,965,&quot;1,063&quot;,&quot;1,164&quot;,&quot;1,266&quot;,&quot;1,370&quot;,&quot;1,472&quot;,&quot;1,571&quot;,&quot;1,666&quot;,&quot;1,756&quot;,&quot;1,841&quot;,&quot;1,919&quot;,&quot;1,990&quot;,&quot;2,052&quot;,&quot;2,106&quot;,&quot;2,151&quot;,&quot;2,187&quot;
Djibouti,988,&quot;1,056&quot;,&quot;1,117&quot;,&quot;1,170&quot;,&quot;1,217&quot;,&quot;1,259&quot;,&quot;1,295&quot;,&quot;1,325&quot;,&quot;1,346&quot;,&quot;1,358&quot;,&quot;1,364&quot;,&quot;1,365&quot;,&quot;1,363&quot;,&quot;1,359&quot;,&quot;1,353&quot;,&quot;1,343&quot;,&quot;1,332&quot;
Eritrea,&quot;3,546&quot;,&quot;3,866&quot;,&quot;4,240&quot;,&quot;4,664&quot;,&quot;5,114&quot;,&quot;5,567&quot;,&quot;6,005&quot;,&quot;6,427&quot;,&quot;6,836&quot;,&quot;7,231&quot;,&quot;7,605&quot;,&quot;7,946&quot;,&quot;8,248&quot;,&quot;8,510&quot;,&quot;8,731&quot;,&quot;8,915&quot;,&quot;9,062&quot;
Ethiopia,&quot;114,964&quot;,&quot;129,749&quot;,&quot;144,944&quot;,&quot;160,231&quot;,&quot;175,466&quot;,&quot;190,611&quot;,&quot;205,411&quot;,&quot;219,639&quot;,&quot;232,994&quot;,&quot;245,316&quot;,&quot;256,441&quot;,&quot;266,190&quot;,&quot;274,558&quot;,&quot;281,512&quot;,&quot;287,056&quot;,&quot;291,317&quot;,&quot;294,393&quot;
Kenya,&quot;53,771&quot;,&quot;59,981&quot;,&quot;66,450&quot;,&quot;73,026&quot;,&quot;79,470&quot;,&quot;85,669&quot;,&quot;91,575&quot;,&quot;97,175&quot;,&quot;102,398&quot;,&quot;107,170&quot;,&quot;111,411&quot;,&quot;115,093&quot;,&quot;118,214&quot;,&quot;120,777&quot;,&quot;122,807&quot;,&quot;124,341&quot;,&quot;125,424&quot;
Madagascar,&quot;27,691&quot;,&quot;31,510&quot;,&quot;35,622&quot;,&quot;39,949&quot;,&quot;44,471&quot;,&quot;49,175&quot;,&quot;54,048&quot;,&quot;59,033&quot;,&quot;64,059&quot;,&quot;69,074&quot;,&quot;74,035&quot;,&quot;78,897&quot;,&quot;83,598&quot;,&quot;88,090&quot;,&quot;92,343&quot;,&quot;96,310&quot;,&quot;99,957&quot;</code></pre>
<div class="sourceCode" id="section-cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb406-1"><a href="section-extended-example-world-population-data.html#section-cb406-1" aria-hidden="true" tabindex="-1"></a>remove_comma <span class="ot">&lt;-</span> <span class="cf">function</span>(x) stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(x,<span class="st">&quot;,&quot;</span>)</span>
<span id="section-cb406-2"><a href="section-extended-example-world-population-data.html#section-cb406-2" aria-hidden="true" tabindex="-1"></a>worldpop_pred_median <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="section-cb406-3"><a href="section-extended-example-world-population-data.html#section-cb406-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;data/worldpop/worldpop-pred-median.csv&quot;</span>,</span>
<span id="section-cb406-4"><a href="section-extended-example-world-population-data.html#section-cb406-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_names =</span> <span class="cn">TRUE</span>,</span>
<span id="section-cb406-5"><a href="section-extended-example-world-population-data.html#section-cb406-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> stringr<span class="sc">::</span><span class="fu">str_c</span>(<span class="fu">rep</span>(<span class="st">&quot;c&quot;</span>,<span class="dv">18</span>),<span class="at">collapse =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="section-cb406-6"><a href="section-extended-example-world-population-data.html#section-cb406-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="section-cb406-7"><a href="section-extended-example-world-population-data.html#section-cb406-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove the commas. R already removed the quotes.</span></span>
<span id="section-cb406-8"><a href="section-extended-example-world-population-data.html#section-cb406-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="st">`</span><span class="at">2020</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2100</span><span class="st">`</span>),remove_comma) <span class="sc">%&gt;%</span></span>
<span id="section-cb406-9"><a href="section-extended-example-world-population-data.html#section-cb406-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to numeric</span></span>
<span id="section-cb406-10"><a href="section-extended-example-world-population-data.html#section-cb406-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="st">`</span><span class="at">2020</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2100</span><span class="st">`</span>),as.numeric) <span class="sc">%&gt;%</span></span>
<span id="section-cb406-11"><a href="section-extended-example-world-population-data.html#section-cb406-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pivot to long format</span></span>
<span id="section-cb406-12"><a href="section-extended-example-world-population-data.html#section-cb406-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="section-cb406-13"><a href="section-extended-example-world-population-data.html#section-cb406-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2020</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2100</span><span class="st">`</span>,</span>
<span id="section-cb406-14"><a href="section-extended-example-world-population-data.html#section-cb406-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="section-cb406-15"><a href="section-extended-example-world-population-data.html#section-cb406-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;population&quot;</span></span>
<span id="section-cb406-16"><a href="section-extended-example-world-population-data.html#section-cb406-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="section-cb406-17"><a href="section-extended-example-world-population-data.html#section-cb406-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.numeric</span>(year))</span>
<span id="section-cb406-18"><a href="section-extended-example-world-population-data.html#section-cb406-18" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(worldpop_pred_median)</span></code></pre></div>
<pre><code>Rows: 4,029
Columns: 3
$ country    &lt;chr&gt; &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;Eastern Africa&quot;, &quot;Eastern Africa…
$ year       &lt;dbl&gt; 2020, 2025, 2030, 2035, 2040, 2045, 2050, 2055, 2060, 2065, 2070, 2075, 2080, 2085, 2090, 2095, 2100, 2020, 2025, 2030, 2035, 2040, 2045, 2050, 2055, 2060, 2065, 2070, 2075, 2080, 2085, …
$ population &lt;dbl&gt; 7794799, 8184437, 8548487, 8887524, 9198847, 9481803, 9735034, 9958099, 10151470, 10317879, 10459240, 10577288, 10673904, 10750662, 10809892, 10851860, 10875394, 445406, 505292, 569705, …</code></pre>
<p><strong>Exercise</strong>: read in the <code>worldpop-pred-lower95.csv</code> and <code>worldpop-pred-upper95.csv</code>
datasets into dataframes called <code>worldpop_pred_lower95</code> and <code>worldpop_pred_upper95</code>,
with the <code>population</code> variable named <code>population_lower95</code> and <code>population_upper95</code>.
Join the three dataframes into a dataframe <code>worldpop_pred</code> which looks like this:</p>
<pre><code>Rows: 4,012
Columns: 5
$ country            &lt;chr&gt; &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;Burundi&quot;, &quot;Burundi&quot;, &quot;Bu…
$ year               &lt;dbl&gt; 2020, 2025, 2030, 2035, 2040, 2045, 2050, 2055, 2060, 2065, 2070, 2075, 2080, 2085, 2090, 2095, 2100, 2020, 2025, 2030, 2035, 2040, 2045, 2050, 2055, 2060, 2065, 2070, 2075, 2080…
$ population         &lt;dbl&gt; 7794799, 8184437, 8548487, 8887524, 9198847, 9481803, 9735034, 9958099, 10151470, 10317879, 10459240, 10577288, 10673904, 10750662, 10809892, 10851860, 10875394, 11891, 13764, 15…
$ population_lower95 &lt;dbl&gt; 7794799, 8144343, 8460182, 8746077, 8996324, 9213142, 9396006, 9534887, 9636991, 9703980, 9739584, 9748508, 9726522, 9677887, 9618846, 9529601, 9424391, 11891, 13554, 15194, 1679…
$ population_upper95 &lt;dbl&gt; 7794799, 8223574, 8636041, 9029502, 9396987, 9744879, 10078535, 10392599, 10690489, 10976553, 11243358, 11500320, 11743120, 11988844, 12227664, 12448936, 12663070, 11891, 13960, …</code></pre>
<p>We’ll use these data later in this chapter.</p>
</div>
<div id="section-model-world-population-over-time" class="section level2" number="15.2">
<h2><span class="header-section-number">15.2</span> Model world population over time</h2>
<p>Look at the world population across years:</p>
<div class="sourceCode" id="section-cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb409-1"><a href="section-extended-example-world-population-data.html#section-cb409-1" aria-hidden="true" tabindex="-1"></a>worldpopplot <span class="ot">&lt;-</span> worldpop <span class="sc">%&gt;%</span></span>
<span id="section-cb409-2"><a href="section-extended-example-world-population-data.html#section-cb409-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country<span class="sc">==</span><span class="st">&#39;WORLD&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="section-cb409-3"><a href="section-extended-example-world-population-data.html#section-cb409-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year,<span class="at">y =</span> population)) <span class="sc">+</span></span>
<span id="section-cb409-4"><a href="section-extended-example-world-population-data.html#section-cb409-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="section-cb409-5"><a href="section-extended-example-world-population-data.html#section-cb409-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="section-cb409-6"><a href="section-extended-example-world-population-data.html#section-cb409-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="section-cb409-7"><a href="section-extended-example-world-population-data.html#section-cb409-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;World population over time&quot;</span>,</span>
<span id="section-cb409-8"><a href="section-extended-example-world-population-data.html#section-cb409-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="section-cb409-9"><a href="section-extended-example-world-population-data.html#section-cb409-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;World Population (Billions)&quot;</span>) <span class="sc">+</span></span>
<span id="section-cb409-10"><a href="section-extended-example-world-population-data.html#section-cb409-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1950</span>,<span class="dv">2020</span>,<span class="at">by=</span><span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="section-cb409-11"><a href="section-extended-example-world-population-data.html#section-cb409-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) x<span class="sc">*</span><span class="fl">1e-06</span>)</span>
<span id="section-cb409-12"><a href="section-extended-example-world-population-data.html#section-cb409-12" aria-hidden="true" tabindex="-1"></a>worldpopplot</span></code></pre></div>
<p><img src="book_files/figure-html/countryhist-1.png" width="672" /></p>
<p>It looks like population may be growing at a pretty constant rate, or
equivalently (sort of- bear with me), may be increasing by a constant
amount each year. What is this rate/increase?</p>
<p>This is an <strong>inference problem</strong>. We have <strong>data</strong> (population counts for each year)
and a <strong>model</strong> (population grows at a constant rate from year to year) and we
need to <strong>infer</strong> the value of an unknown <strong>parameter</strong> (the rate at which population
grows).</p>
<p>In order to do this, we need to write down our model more formally. Let <span class="math inline">\(Y_{i}\)</span>
be the random variable representing the world population in year <span class="math inline">\(i\)</span> with <span class="math inline">\(i = 1950,\ldots,2020\)</span>.
We think the population increases by the same amount per year on average, but want
to allow for a bit of variability. We can model:
<span class="math display">\[
Y_{i+1} - Y_{i} \overset{iid}{\sim}\text{Normal}\left(\Delta,\sigma^{2}\right)
\]</span>
and then infer <span class="math inline">\(\Delta\)</span>, the average increase in population.</p>
<p><strong>Exercise</strong>: estimate <span class="math inline">\(\Delta\)</span> using the <strong>sample mean</strong> of the <em>differences</em>
in population. You can use the <code>diff</code> function, or the <code>lag</code> function to
compute the differences– look up their documentation for help. I got the following:</p>
<pre><code>Mean:  75120 </code></pre>
<p>So it looks like the population increases by about 7.5 million on average (remember,
population here is in thousands).</p>
<p>It turns out that what we just did is similar to the following
<strong>linear regression model</strong>:
<span class="math display">\[
Y_{i} = \beta_{0} + \Delta i + \epsilon_{i}, \ \epsilon_{i} \overset{iid}{\sim}\text{Normal}\left(0,\sigma^{2}/2\right)
\]</span>
This is because:
<span class="math display">\[\begin{equation}\begin{aligned}
Y_{i} &amp;= \beta_{0} + \Delta i + \epsilon_{i} \\
Y_{i+1} &amp;= \beta_{0} + \Delta (i+1) + \epsilon_{i+1} \\
\implies Y_{i+1} - Y_{i} &amp;= \Delta + \left(\epsilon_{i+1} - \epsilon_{i}\right)
\end{aligned}\end{equation}\]</span>
and <span class="math inline">\(\left(\epsilon_{i+1} - \epsilon_{i}\right)\overset{iid}{\sim}\text{Normal}\left(0,\sigma^{2}\right)\)</span>.</p>
<div class="sourceCode" id="section-cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb411-1"><a href="section-extended-example-world-population-data.html#section-cb411-1" aria-hidden="true" tabindex="-1"></a>diffmod <span class="ot">&lt;-</span> <span class="fu">lm</span>(population <span class="sc">~</span> <span class="fu">as.numeric</span>(year),<span class="at">data =</span> <span class="fu">filter</span>(worldpop,country <span class="sc">==</span> <span class="st">&#39;WORLD&#39;</span>))</span>
<span id="section-cb411-2"><a href="section-extended-example-world-population-data.html#section-cb411-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(diffmod)</span></code></pre></div>
<pre><code>
Call:
lm(formula = population ~ as.numeric(year), data = filter(worldpop, 
    country == &quot;WORLD&quot;))

Residuals:
    Min      1Q  Median      3Q     Max 
-119897  -89256     964   52493  294834 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      -1.50e+08   1.12e+06    -134   &lt;2e-16 ***
as.numeric(year)  7.79e+04   5.63e+02     138   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 97200 on 69 degrees of freedom
Multiple R-squared:  0.996, Adjusted R-squared:  0.996 
F-statistic: 1.91e+04 on 1 and 69 DF,  p-value: &lt;2e-16</code></pre>
<div class="sourceCode" id="section-cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb413-1"><a href="section-extended-example-world-population-data.html#section-cb413-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unname</span>(<span class="fu">coef</span>(diffmod)[<span class="dv">2</span>]) <span class="co"># Should be close to the mean difference</span></span></code></pre></div>
<pre><code>[1] 77877</code></pre>
<p>The estimated slope of the regression line is <span class="math inline">\(\hat{\Delta} = 77877\)</span>, close to
the mean difference (estimating the standard deviation is a bit trickier).</p>
<p>Plot the model:</p>
<div class="sourceCode" id="section-cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb415-1"><a href="section-extended-example-world-population-data.html#section-cb415-1" aria-hidden="true" tabindex="-1"></a>worldpopplot <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="fu">coef</span>(diffmod)[<span class="dv">2</span>],<span class="at">intercept =</span> <span class="fu">coef</span>(diffmod)[<span class="dv">1</span>])</span></code></pre></div>
<p><img src="book_files/figure-html/plotdiffmod1-1.png" width="672" /></p>
<p>It’s ok. It looks like maybe the growth isn’t by some constant value each year,
but rather maybe the <em>rate</em> of growth is constant.</p>
<p>We can build a linear regression model for that, too. Consider the following
growth model:
<span class="math display">\[
Y_{i+1} = Y_{i}(1+\Delta)
\]</span>
where the parameter <span class="math inline">\(\Delta\)</span> is now the <em>rate</em> of population growth.
We can model this approximately as a linear regression model:
<span class="math display">\[
Y_{i} = \exp\left( \beta_{0} + \Delta i + \epsilon_{i}\right)
\]</span>
This gives
<span class="math display">\[
Y_{i+1}/Y_{i} = \exp\left(\Delta + \epsilon_{i+1} - \epsilon_{i}\right)
\]</span>
which, ignoring the errors, gives <span class="math inline">\(\exp(\Delta) \approx 1 + \Delta\)</span>. You may or may
not recall that the approximation <span class="math inline">\(e^{x} \approx 1 + x\)</span> is a first-order Taylor
expansion of <span class="math inline">\(e^{x}\)</span>.</p>
<p>Wait, how is this even a <em>linear</em> regression model? That’s obtained by taking logs:
<span class="math display">\[
\log Y_{i} = \beta_{0} + \Delta i + \epsilon_{i}
\]</span>
so we fit this model by computing a new variable <span class="math inline">\(\log Y_{i}\)</span> in the data, and then
doing a linear regression model for that.</p>
<p><strong>Exercise</strong>: fit this model:</p>
<ol style="list-style-type: decimal">
<li><p>Create a new variable <code>logpopulation</code> using <code>mutate()</code>,</p></li>
<li><p>Do a linear regression as above, like <code>lm(logpopulation ~ ...)</code>.</p></li>
</ol>
<p>Here’s what I got, calling my model object <code>logmodel</code>:</p>
<div class="sourceCode" id="section-cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb416-1"><a href="section-extended-example-world-population-data.html#section-cb416-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logmodel)</span></code></pre></div>
<pre><code>
Call:
lm(formula = logpopulation ~ year, data = logpopdat)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.07032 -0.02804  0.00389  0.02891  0.04295 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -1.73e+01   3.66e-01   -47.3   &lt;2e-16 ***
year         1.65e-02   1.85e-04    89.2   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.0319 on 69 degrees of freedom
Multiple R-squared:  0.991, Adjusted R-squared:  0.991 
F-statistic: 7.96e+03 on 1 and 69 DF,  p-value: &lt;2e-16</code></pre>
<div class="sourceCode" id="section-cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb418-1"><a href="section-extended-example-world-population-data.html#section-cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">unname</span>(<span class="fu">coef</span>(logmodel)[<span class="dv">2</span>])) <span class="sc">-</span> <span class="dv">1</span> <span class="co"># Delta</span></span></code></pre></div>
<pre><code>[1] 0.016599</code></pre>
<p>So it looks like population increases by about <span class="math inline">\(1.66\%\)</span> each year on average.</p>
<p>Check out how it looks (I called my new data <code>logpopdat</code>):</p>
<div class="sourceCode" id="section-cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb420-1"><a href="section-extended-example-world-population-data.html#section-cb420-1" aria-hidden="true" tabindex="-1"></a>logpopdat <span class="sc">%&gt;%</span></span>
<span id="section-cb420-2"><a href="section-extended-example-world-population-data.html#section-cb420-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year,<span class="at">y =</span> logpopulation)) <span class="sc">+</span></span>
<span id="section-cb420-3"><a href="section-extended-example-world-population-data.html#section-cb420-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="section-cb420-4"><a href="section-extended-example-world-population-data.html#section-cb420-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="section-cb420-5"><a href="section-extended-example-world-population-data.html#section-cb420-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="fu">coef</span>(logmodel)[<span class="dv">2</span>],<span class="at">intercept =</span> <span class="fu">coef</span>(logmodel)[<span class="dv">1</span>]) <span class="sc">+</span> </span>
<span id="section-cb420-6"><a href="section-extended-example-world-population-data.html#section-cb420-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_trans</span>(<span class="at">y =</span> <span class="st">&quot;exp&quot;</span>) <span class="sc">+</span> </span>
<span id="section-cb420-7"><a href="section-extended-example-world-population-data.html#section-cb420-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="section-cb420-8"><a href="section-extended-example-world-population-data.html#section-cb420-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;World population over time&quot;</span>,</span>
<span id="section-cb420-9"><a href="section-extended-example-world-population-data.html#section-cb420-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="section-cb420-10"><a href="section-extended-example-world-population-data.html#section-cb420-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;World Population (Billions)&quot;</span>) <span class="sc">+</span></span>
<span id="section-cb420-11"><a href="section-extended-example-world-population-data.html#section-cb420-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1950</span>,<span class="dv">2020</span>,<span class="at">by=</span><span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="section-cb420-12"><a href="section-extended-example-world-population-data.html#section-cb420-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">log</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">8</span> <span class="sc">*</span> <span class="fl">1e06</span>),<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x)<span class="sc">*</span><span class="fl">1e-06</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/logmodel3-1.png" width="672" /></p>
<p>We don’t yet have the tools to tell if one model is “better” than the other!</p>
</div>
<div id="section-bayesian-model-for-world-population" class="section level2" number="15.3">
<h2><span class="header-section-number">15.3</span> Bayesian model for world population</h2>
<p>The reported world populations are just estimates. We saw that when you sum up
the populations for each country, the answer does not exactly equal the reported
world population. Here we will describe a Bayesian method for estimating the
total world population in a given year, based on the reported value for that year,
attempting to account for error.</p>
<p>For any chosen year, let <span class="math inline">\(Y\)</span> represent the reported world population. Let <span class="math inline">\(\lambda\)</span> be the true world population. We might have <span class="math inline">\(Y &gt; \lambda\)</span> or <span class="math inline">\(Y &lt; \lambda\)</span> due to
reporting error– <span class="math inline">\(Y\)</span> is random, <span class="math inline">\(\lambda\)</span> is fixed and unknown. We want
to write down a <strong>statistical model</strong> for <span class="math inline">\(Y\)</span> which depends on <span class="math inline">\(\lambda\)</span>
and then use <span class="math inline">\(Y\)</span> to <strong>infer</strong> <span class="math inline">\(\lambda\)</span>. One such model is
<span class="math display">\[
Y \sim \text{Poisson}(\lambda)
\]</span>
To do Bayesian inference, we require a prior distribution on <span class="math inline">\(\lambda\)</span>. How do we
choose this? This is completely subjective, and it might seem like we have absolutely
no information (without looking at the data, of course). But this isn’t true: we
know <span class="math inline">\(\lambda &gt; 0\)</span> (there can’t, on average, be less than zero people on earth)
and we know that <span class="math inline">\(\lambda\)</span> can’t be something absurd like <span class="math inline">\(10^{100}\)</span>. We want to
choose what is called a <em>weakly informative</em> prior: one that restricts <span class="math inline">\(\lambda\)</span>
to be in a not-absurd range. Let’s try a Gamma distribution with <span class="math inline">\(95^{th}\)</span> percentile
equal to <span class="math inline">\(10\)</span>billion and <span class="math inline">\(5^{th}\)</span> percentile equal to <span class="math inline">\(1\)</span> billion. Measuring
<span class="math inline">\(\lambda\)</span> in billions, this corresponds to parameters of about
<span class="math inline">\(\alpha = 3.358\)</span> and <span class="math inline">\(\beta = 0.778\)</span>:
<span class="math display">\[
\lambda \sim\text{Gamma}(3.358,0.778)
\]</span>
Let’s plot this prior to see what it looks like:</p>
<div class="sourceCode" id="section-cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb421-1"><a href="section-extended-example-world-population-data.html#section-cb421-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">3.358</span></span>
<span id="section-cb421-2"><a href="section-extended-example-world-population-data.html#section-cb421-2" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.778</span></span>
<span id="section-cb421-3"><a href="section-extended-example-world-population-data.html#section-cb421-3" aria-hidden="true" tabindex="-1"></a>priorplot <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">xx =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="at">length.out =</span> <span class="dv">10000</span>)) <span class="sc">%&gt;%</span></span>
<span id="section-cb421-4"><a href="section-extended-example-world-population-data.html#section-cb421-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> xx)) <span class="sc">+</span></span>
<span id="section-cb421-5"><a href="section-extended-example-world-population-data.html#section-cb421-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="section-cb421-6"><a href="section-extended-example-world-population-data.html#section-cb421-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dgamma,<span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape =</span> alpha,<span class="at">rate =</span> beta)) <span class="sc">+</span></span>
<span id="section-cb421-7"><a href="section-extended-example-world-population-data.html#section-cb421-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Prior on total world population&quot;</span>,</span>
<span id="section-cb421-8"><a href="section-extended-example-world-population-data.html#section-cb421-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Total world population (billions)&quot;</span>,</span>
<span id="section-cb421-9"><a href="section-extended-example-world-population-data.html#section-cb421-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Prior density&quot;</span>) <span class="sc">+</span> </span>
<span id="section-cb421-10"><a href="section-extended-example-world-population-data.html#section-cb421-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="at">by =</span> <span class="dv">1</span>),<span class="at">labels =</span> <span class="cf">function</span>(x) scales<span class="sc">::</span><span class="fu">comma</span>(x))</span>
<span id="section-cb421-11"><a href="section-extended-example-world-population-data.html#section-cb421-11" aria-hidden="true" tabindex="-1"></a>priorplot</span></code></pre></div>
<p><img src="book_files/figure-html/plotgamma1-1.png" width="672" /></p>
<p>Now, you have to get the posterior for <span class="math inline">\(\lambda|Y\)</span>. The likelihood is
<span class="math display">\[
P(Y = y|\lambda) = \frac{\lambda^{y}e^{-\lambda}}{y!}
\]</span>
The prior is
<span class="math display">\[
\pi(\lambda) = \frac{\beta^{\alpha}}{\Gamma(\alpha)}\lambda^{\alpha-1}e^{-\beta\lambda}
\]</span>
<strong>Exercise</strong>: show that the posterior is
<span class="math display">\[
\lambda|Y \sim\Gamma\left( \alpha + y,\beta + 1\right)
\]</span>
Now, with the posterior determined, we can infer the world population for any given
year. For <span class="math inline">\(2010\)</span>, say, we can plot the posterior (note that <span class="math inline">\(Y\)</span> is now converted to billions,
from thousands):</p>
<div class="sourceCode" id="section-cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb422-1"><a href="section-extended-example-world-population-data.html#section-cb422-1" aria-hidden="true" tabindex="-1"></a>observedpop <span class="ot">&lt;-</span> worldpop <span class="sc">%&gt;%</span> <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&#39;WORLD&#39;</span>,year <span class="sc">==</span> <span class="dv">2010</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(population)</span>
<span id="section-cb422-2"><a href="section-extended-example-world-population-data.html#section-cb422-2" aria-hidden="true" tabindex="-1"></a>observedpop <span class="ot">&lt;-</span> observedpop <span class="sc">*</span> <span class="fl">1e-06</span> <span class="co"># Convert to billions, from thousands</span></span>
<span id="section-cb422-3"><a href="section-extended-example-world-population-data.html#section-cb422-3" aria-hidden="true" tabindex="-1"></a>priorplot <span class="sc">+</span></span>
<span id="section-cb422-4"><a href="section-extended-example-world-population-data.html#section-cb422-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dgamma,<span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape =</span> alpha <span class="sc">+</span> observedpop,<span class="at">rate =</span> beta<span class="sc">+</span><span class="dv">1</span>),<span class="at">colour =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">+</span></span>
<span id="section-cb422-5"><a href="section-extended-example-world-population-data.html#section-cb422-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> observedpop,<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>,<span class="at">colour=</span><span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="section-cb422-6"><a href="section-extended-example-world-population-data.html#section-cb422-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Prior (black) and posterior (orange) for total world population&quot;</span>,</span>
<span id="section-cb422-7"><a href="section-extended-example-world-population-data.html#section-cb422-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Red line: observed world population&quot;</span>,</span>
<span id="section-cb422-8"><a href="section-extended-example-world-population-data.html#section-cb422-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/plotgammapost1-1.png" width="672" /></p>
<p>We will see later how to use this to estimate the world population in a given year.</p>
<p><strong>Exercise</strong>: the prior pulls the posterior to the left of the observed values,
favouring the notion that the reported world population is an <em>overestimate</em> of
the true value. Is this reasonable? Try it out with some different priors. I wrote
you a helper function which lets you put in the <span class="math inline">\(2.5\%\)</span> and <span class="math inline">\(97.5\%\)</span> quantiles you
want, and gives you the <span class="math inline">\(\alpha,\beta\)</span> that give you these quantiles:</p>
<div class="sourceCode" id="section-cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb423-1"><a href="section-extended-example-world-population-data.html#section-cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getgammaparams</span>(<span class="dv">1</span>,<span class="dv">10</span>)</span></code></pre></div>
<pre><code> alpha   beta 
3.3582 0.7787 </code></pre>
<p>For example, if you wanted to use a Gamma distribution with lower quantile <span class="math inline">\(0.1\)</span> billion
and upper quantile <span class="math inline">\(15\)</span> billion, you would use</p>
<div class="sourceCode" id="section-cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb425-1"><a href="section-extended-example-world-population-data.html#section-cb425-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getgammaparams</span>(.<span class="dv">1</span>,<span class="dv">15</span>)</span></code></pre></div>
<pre><code>  alpha    beta 
0.99196 0.24480 </code></pre>
<p>and so on.</p>
<p>Try it with any/all unique combinations of
lower quantile <span class="math inline">\(.01,.1,1,2,5\)</span> billion and upper quantile <span class="math inline">\(6,10,15,20,50\)</span> billion.
Is the posterior very sensitive to the choice of prior?</p>
</div>
<div id="section-quantifying-uncertainty-in-estimates-of-world-population-regression-model" class="section level2" number="15.4">
<h2><span class="header-section-number">15.4</span> Quantifying uncertainty in estimates of world population: regression model</h2>
<p>We have done the following linear regression for world population:</p>
<div class="sourceCode" id="section-cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb427-1"><a href="section-extended-example-world-population-data.html#section-cb427-1" aria-hidden="true" tabindex="-1"></a>worldpopplot <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="fu">coef</span>(diffmod)[<span class="dv">2</span>],<span class="at">intercept =</span> <span class="fu">coef</span>(diffmod)[<span class="dv">1</span>])</span></code></pre></div>
<p><img src="book_files/figure-html/plotdiffmodagain1-1.png" width="672" />
The value of the regression line at any year gives an estimate of the population
in that year.</p>
<p>However, statistics is the study of <strong>uncertainty</strong>. We don’t just want to give
a single estimate of population, we want to <strong>quantify uncertainty</strong> in this estimate.
We do so using the probability distribution of the predicted value, and constructing
an interval in which the predicted value has a high probability of falling, under the
model.</p>
<p>The observed world population in year <span class="math inline">\(i\)</span> is:
<span class="math display">\[
Y_{i} = \beta_{0} + \Delta i + \epsilon_{i}
\]</span>
This can be written as
<span class="math display">\[
Y_{i} = \mu_{i} + \epsilon_{i}
\]</span>
where <span class="math inline">\(\mu_{i} = \beta_{0} + \Delta_{i} i\)</span> is the actual world population, and <span class="math inline">\(\epsilon_{i}\)</span>
is some random error. In the linear regression output, we obtain estimates <span class="math inline">\(\hat{\beta}_{0}\)</span> and
<span class="math inline">\(\hat{\Delta}\)</span>. The regression line that is actually plotted is
<span class="math display">\[
\hat{\mu}_{i} = \hat{\beta}_{0} + \hat{\Delta}i
\]</span>
The predicted value of the world population in year <span class="math inline">\(i\)</span> is simply <span class="math inline">\(\hat{\mu}_{i}\)</span>.
Its value along with its standard deviation, <span class="math inline">\(\text{SD}(\hat{\mu}_{i})\)</span>, can be obtained from the regression
output using the <code>predict</code> function. To get the estimated world population and <span class="math inline">\(95\%\)</span>
confidence interval for 2010, for example, you could do</p>
<div class="sourceCode" id="section-cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb428-1"><a href="section-extended-example-world-population-data.html#section-cb428-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(diffmod,<span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="dv">2010</span>),<span class="at">se.fit =</span> <span class="cn">TRUE</span>,<span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>)<span class="sc">$</span>fit</span></code></pre></div>
<pre><code>      fit     lwr     upr
1 6914203 6877901 6950504</code></pre>
<p>There is a problem, though. A subtle problem. A confidence interval is interpreted as
“if we repeated the experiment over and over again and calculated this interval, <span class="math inline">\(95\%\)</span>
of the intervals we calculated would contain the true value.” This means that for
the interval we just calculated, if we were to go into some parallel universe over
and over again and measure the population of the world from 1950 – 2020 and build
this regression model and calculate this interval, the intervals would contain
the true population of the world <span class="math inline">\(95\%\)</span> of the time.</p>
<p>That’s really confusing.</p>
<p>What may instead calculate an interval which has a <span class="math inline">\(95\%\)</span> chance of containing the
<em>measured</em> world population value for 2010 (say), accounting for both uncertainty
in the estimated world population and the variability in the measurement of world
population on any given year. If we went back and measured the population for 2010
over and over again, we think that <span class="math inline">\(95\%\)</span> of such measurements would fall within
this interval. We call this a <strong>prediction interval</strong> instead of a confidence interval.
It is based off both the variability in <span class="math inline">\(\hat{\mu}_{i}\)</span> and the variability in
<span class="math inline">\(\epsilon_{i}\)</span>. It is obtained as</p>
<div class="sourceCode" id="section-cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb430-1"><a href="section-extended-example-world-population-data.html#section-cb430-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(diffmod,<span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="dv">2010</span>),<span class="at">se.fit =</span> <span class="cn">TRUE</span>,<span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)<span class="sc">$</span>fit</span></code></pre></div>
<pre><code>      fit     lwr     upr
1 6914203 6716913 7111492</code></pre>
<p>Notice how it is <strong>wider</strong> than the confidence interval, because it accounts for more
types of uncertainty.</p>
<p>Let’s plot the confidence intervals on our plot:</p>
<div class="sourceCode" id="section-cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb432-1"><a href="section-extended-example-world-population-data.html#section-cb432-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: removing the &quot;newdata&quot; argument gives</span></span>
<span id="section-cb432-2"><a href="section-extended-example-world-population-data.html#section-cb432-2" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions on the original values</span></span>
<span id="section-cb432-3"><a href="section-extended-example-world-population-data.html#section-cb432-3" aria-hidden="true" tabindex="-1"></a>worldpoponlyworld <span class="ot">&lt;-</span> <span class="fu">filter</span>(worldpop,country<span class="sc">==</span><span class="st">&#39;WORLD&#39;</span>)</span>
<span id="section-cb432-4"><a href="section-extended-example-world-population-data.html#section-cb432-4" aria-hidden="true" tabindex="-1"></a>preddat <span class="ot">&lt;-</span> <span class="fu">predict</span>(diffmod,<span class="at">se.fit =</span> <span class="cn">TRUE</span>,<span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>)<span class="sc">$</span>fit <span class="sc">%&gt;%</span></span>
<span id="section-cb432-5"><a href="section-extended-example-world-population-data.html#section-cb432-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="section-cb432-6"><a href="section-extended-example-world-population-data.html#section-cb432-6" aria-hidden="true" tabindex="-1"></a>preddat<span class="sc">$</span>year <span class="ot">&lt;-</span> worldpoponlyworld<span class="sc">$</span>year</span>
<span id="section-cb432-7"><a href="section-extended-example-world-population-data.html#section-cb432-7" aria-hidden="true" tabindex="-1"></a>worldpoppred <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(worldpoponlyworld,preddat,<span class="at">by =</span> <span class="st">&quot;year&quot;</span>)</span>
<span id="section-cb432-8"><a href="section-extended-example-world-population-data.html#section-cb432-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(worldpoppred)</span></code></pre></div>
<pre><code>Rows: 71
Columns: 6
$ country    &lt;chr&gt; &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD…
$ year       &lt;dbl&gt; 1950, 1951, 1952, 1953, 1954, 1955, 1956, 1957, 1958, 1959, 1960, 1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969, 1970, 1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980, …
$ population &lt;dbl&gt; 2536431, 2584034, 2630862, 2677609, 2724847, 2773020, 2822443, 2873306, 2925687, 2979576, 3034950, 3091844, 3150421, 3211001, 3273978, 3339584, 3407923, 3478770, 3551599, 3625681, 370043…
$ fit        &lt;dbl&gt; 2241597, 2319473, 2397350, 2475227, 2553104, 2630980, 2708857, 2786734, 2864611, 2942488, 3020364, 3098241, 3176118, 3253995, 3331871, 3409748, 3487625, 3565502, 3643378, 3721255, 379913…
$ lwr        &lt;dbl&gt; 2196050, 2274892, 2353727, 2432554, 2511372, 2590181, 2668980, 2747768, 2826545, 2905310, 2984062, 3062800, 3141524, 3220230, 3298920, 3377591, 3456242, 3534871, 3613477, 3692058, 377061…
$ upr        &lt;dbl&gt; 2287143, 2364054, 2440973, 2517900, 2594836, 2671780, 2748735, 2825700, 2902676, 2979665, 3056666, 3133682, 3210712, 3287759, 3364823, 3441905, 3519008, 3596132, 3673280, 3750453, 382765…</code></pre>
<div class="sourceCode" id="section-cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb434-1"><a href="section-extended-example-world-population-data.html#section-cb434-1" aria-hidden="true" tabindex="-1"></a>predplotconfint <span class="ot">&lt;-</span> worldpoppred <span class="sc">%&gt;%</span></span>
<span id="section-cb434-2"><a href="section-extended-example-world-population-data.html#section-cb434-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year,<span class="at">y =</span> fit)) <span class="sc">+</span></span>
<span id="section-cb434-3"><a href="section-extended-example-world-population-data.html#section-cb434-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="section-cb434-4"><a href="section-extended-example-world-population-data.html#section-cb434-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Shaded region for the interval</span></span>
<span id="section-cb434-5"><a href="section-extended-example-world-population-data.html#section-cb434-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lwr,<span class="at">ymax =</span> upr),<span class="at">fill =</span> <span class="st">&quot;darkgrey&quot;</span>) <span class="sc">+</span></span>
<span id="section-cb434-6"><a href="section-extended-example-world-population-data.html#section-cb434-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="section-cb434-7"><a href="section-extended-example-world-population-data.html#section-cb434-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> population)) <span class="sc">+</span></span>
<span id="section-cb434-8"><a href="section-extended-example-world-population-data.html#section-cb434-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="section-cb434-9"><a href="section-extended-example-world-population-data.html#section-cb434-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;World population with estimate and 95% CI&quot;</span>,</span>
<span id="section-cb434-10"><a href="section-extended-example-world-population-data.html#section-cb434-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="section-cb434-11"><a href="section-extended-example-world-population-data.html#section-cb434-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;World Population (Billions)&quot;</span>) <span class="sc">+</span></span>
<span id="section-cb434-12"><a href="section-extended-example-world-population-data.html#section-cb434-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1950</span>,<span class="dv">2020</span>,<span class="at">by=</span><span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="section-cb434-13"><a href="section-extended-example-world-population-data.html#section-cb434-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) x<span class="sc">*</span><span class="fl">1e-06</span>)</span>
<span id="section-cb434-14"><a href="section-extended-example-world-population-data.html#section-cb434-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="section-cb434-15"><a href="section-extended-example-world-population-data.html#section-cb434-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="section-cb434-16"><a href="section-extended-example-world-population-data.html#section-cb434-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="section-cb434-17"><a href="section-extended-example-world-population-data.html#section-cb434-17" aria-hidden="true" tabindex="-1"></a>predplotconfint</span></code></pre></div>
<p><img src="book_files/figure-html/plotconfdiffmod1-1.png" width="672" />
Notice how the interval is really narrow, and doesn’t contain most of the actual
measured values. This is because it is an interval for the true, unknown value
of the world population, not the actual measured values themselves.</p>
<p><strong>Exercise</strong>: create the same plot but with a <strong>prediction interval</strong>. I got the
following:</p>
<div class="sourceCode" id="section-cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb435-1"><a href="section-extended-example-world-population-data.html#section-cb435-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: removing the &quot;newdata&quot; argument gives</span></span>
<span id="section-cb435-2"><a href="section-extended-example-world-population-data.html#section-cb435-2" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions on the original values</span></span>
<span id="section-cb435-3"><a href="section-extended-example-world-population-data.html#section-cb435-3" aria-hidden="true" tabindex="-1"></a>worldpoponlyworld <span class="ot">&lt;-</span> <span class="fu">filter</span>(worldpop,country<span class="sc">==</span><span class="st">&#39;WORLD&#39;</span>)</span>
<span id="section-cb435-4"><a href="section-extended-example-world-population-data.html#section-cb435-4" aria-hidden="true" tabindex="-1"></a>preddat <span class="ot">&lt;-</span> <span class="fu">predict</span>(diffmod,<span class="at">se.fit =</span> <span class="cn">TRUE</span>,<span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)<span class="sc">$</span>fit <span class="sc">%&gt;%</span></span>
<span id="section-cb435-5"><a href="section-extended-example-world-population-data.html#section-cb435-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code></pre></div>
<pre><code>Warning in predict.lm(diffmod, se.fit = TRUE, interval = &quot;prediction&quot;): predictions on current data refer to _future_ responses</code></pre>
<div class="sourceCode" id="section-cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb437-1"><a href="section-extended-example-world-population-data.html#section-cb437-1" aria-hidden="true" tabindex="-1"></a>preddat<span class="sc">$</span>year <span class="ot">&lt;-</span> worldpoponlyworld<span class="sc">$</span>year</span>
<span id="section-cb437-2"><a href="section-extended-example-world-population-data.html#section-cb437-2" aria-hidden="true" tabindex="-1"></a>worldpoppred <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(worldpoponlyworld,preddat,<span class="at">by =</span> <span class="st">&quot;year&quot;</span>)</span>
<span id="section-cb437-3"><a href="section-extended-example-world-population-data.html#section-cb437-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(worldpoppred)</span></code></pre></div>
<pre><code>Rows: 71
Columns: 6
$ country    &lt;chr&gt; &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD…
$ year       &lt;dbl&gt; 1950, 1951, 1952, 1953, 1954, 1955, 1956, 1957, 1958, 1959, 1960, 1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969, 1970, 1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980, …
$ population &lt;dbl&gt; 2536431, 2584034, 2630862, 2677609, 2724847, 2773020, 2822443, 2873306, 2925687, 2979576, 3034950, 3091844, 3150421, 3211001, 3273978, 3339584, 3407923, 3478770, 3551599, 3625681, 370043…
$ fit        &lt;dbl&gt; 2241597, 2319473, 2397350, 2475227, 2553104, 2630980, 2708857, 2786734, 2864611, 2942488, 3020364, 3098241, 3176118, 3253995, 3331871, 3409748, 3487625, 3565502, 3643378, 3721255, 379913…
$ lwr        &lt;dbl&gt; 2042399, 2120494, 2198583, 2276666, 2354743, 2432814, 2510878, 2588937, 2666989, 2745035, 2823075, 2901108, 2979135, 3057156, 3135171, 3213179, 3291181, 3369176, 3447166, 3525148, 360312…
$ upr        &lt;dbl&gt; 2440795, 2518453, 2596117, 2673788, 2751464, 2829147, 2906836, 2984531, 3062232, 3139940, 3217654, 3295374, 3373100, 3450833, 3528572, 3606317, 3684069, 3761827, 3839591, 3917362, 399513…</code></pre>
<div class="sourceCode" id="section-cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb439-1"><a href="section-extended-example-world-population-data.html#section-cb439-1" aria-hidden="true" tabindex="-1"></a>predplotpredint <span class="ot">&lt;-</span> worldpoppred <span class="sc">%&gt;%</span></span>
<span id="section-cb439-2"><a href="section-extended-example-world-population-data.html#section-cb439-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year,<span class="at">y =</span> fit)) <span class="sc">+</span></span>
<span id="section-cb439-3"><a href="section-extended-example-world-population-data.html#section-cb439-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="section-cb439-4"><a href="section-extended-example-world-population-data.html#section-cb439-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Shaded region for the interval</span></span>
<span id="section-cb439-5"><a href="section-extended-example-world-population-data.html#section-cb439-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lwr,<span class="at">ymax =</span> upr),<span class="at">fill =</span> <span class="st">&quot;darkgrey&quot;</span>) <span class="sc">+</span></span>
<span id="section-cb439-6"><a href="section-extended-example-world-population-data.html#section-cb439-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="section-cb439-7"><a href="section-extended-example-world-population-data.html#section-cb439-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> population)) <span class="sc">+</span></span>
<span id="section-cb439-8"><a href="section-extended-example-world-population-data.html#section-cb439-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="section-cb439-9"><a href="section-extended-example-world-population-data.html#section-cb439-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;World population with estimate and 95% PI&quot;</span>,</span>
<span id="section-cb439-10"><a href="section-extended-example-world-population-data.html#section-cb439-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="section-cb439-11"><a href="section-extended-example-world-population-data.html#section-cb439-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;World Population (Billions)&quot;</span>) <span class="sc">+</span></span>
<span id="section-cb439-12"><a href="section-extended-example-world-population-data.html#section-cb439-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1950</span>,<span class="dv">2020</span>,<span class="at">by=</span><span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="section-cb439-13"><a href="section-extended-example-world-population-data.html#section-cb439-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) x<span class="sc">*</span><span class="fl">1e-06</span>)</span>
<span id="section-cb439-14"><a href="section-extended-example-world-population-data.html#section-cb439-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="section-cb439-15"><a href="section-extended-example-world-population-data.html#section-cb439-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="section-cb439-16"><a href="section-extended-example-world-population-data.html#section-cb439-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="section-cb439-17"><a href="section-extended-example-world-population-data.html#section-cb439-17" aria-hidden="true" tabindex="-1"></a>predplotpredint</span></code></pre></div>
<p><img src="book_files/figure-html/plotpreddiffmod1-1.png" width="672" /></p>
<p>Note how the interval is <em>much</em> wider, and contains about 19/20 <span class="math inline">\(95\%\)</span> of the measured
values.</p>
<p><strong>Exercise</strong>: create the same two plots but for the <strong>rate model</strong> (the other
regression model we did). I got:</p>
<pre><code>Warning in predict.lm(logmodel, se.fit = TRUE, interval = &quot;prediction&quot;): predictions on current data refer to _future_ responses</code></pre>
<p><img src="book_files/figure-html/plotratemod1-1.png" width="672" /></p>
<p>Comment on the difference in width of the two intervals.</p>
</div>
<div id="section-bayesian-estimate-of-world-population" class="section level2" number="15.5">
<h2><span class="header-section-number">15.5</span> Bayesian estimate of world population</h2>
<p>We previously looked at the model</p>
<p><span class="math display">\[\begin{equation}\begin{aligned}
Y &amp;\sim \text{Poisson}(\lambda)
\lambda &amp;\sim\text{Gamma}(3.358,0.778)
\implies \lambda | Y &amp;\sim \Gamma(3.358 + Y,0.788 + 1)
\end{aligned}\end{equation}\]</span>
where <span class="math inline">\(Y\)</span> is the measured value of world population in Billions, <span class="math inline">\(\lambda\)</span> is the real value
of world population in Billions, and the prior on <span class="math inline">\(\lambda\)</span> was chosen so that
<span class="math inline">\(P(1 \leq \lambda \leq 10) = 95\%\)</span>. Previously we derived the posterior distribution,
but we didn’t actually use it to estimate or quantify uncertainty in <span class="math inline">\(\lambda\)</span>.
We’ll do that now.</p>
<div id="section-estimation-and-uncertainty-quantification" class="section level3" number="15.5.1">
<h3><span class="header-section-number">15.5.1</span> Estimation and uncertainty quantification</h3>
<p>The posterior distribution gives us both estimation and uncertainty quantification,
but it’s up to us to decide how to use it. There are three common ways to use a
posterior for point estimation: the <strong>posterior mode</strong>,
<span class="math display">\[
\hat{\lambda}_{\texttt{mode}} = \text{argmax}_{\lambda}\pi(\lambda | Y),
\]</span>
the <strong>posterior mean</strong>,
<span class="math display">\[
\hat{\lambda}_{\texttt{mean}} = E(\lambda|Y),
\]</span>
and the <strong>posterior median</strong>, which is the value <span class="math inline">\(\hat{\lambda}_{\texttt{med}}\)</span> which
satisfies
<span class="math display">\[
P(\lambda &lt; \hat{\lambda}_{\texttt{med}}|Y) = 0.5
\]</span>
You can determine an expression for each of these posterior summaries using
your usual probability techniques.</p>
<p><strong>Exercise</strong>: show that <span class="math display">\[\hat{\lambda}_{\texttt{mode}} = \frac{\alpha + Y - 1}{\beta + 1}\]</span>
where <span class="math inline">\((\alpha,\beta)\)</span> are the prior parameters (i.e. <span class="math inline">\(\lambda\)</span> has a <span class="math inline">\(\text{Gamma}(\alpha,\beta)\)</span>
prior).</p>
<p><strong>Exercise</strong>: show that <span class="math display">\[\hat{\lambda}_{\texttt{mean}} = \frac{\alpha + Y}{\beta + 1}.\]</span></p>
<p>The posterior median does not have a closed-form expression in this example, although
we can still compute it using <code>R</code>.</p>
<p>Let’s compute these three statistics:</p>
<div class="sourceCode" id="section-cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb441-1"><a href="section-extended-example-world-population-data.html#section-cb441-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior params</span></span>
<span id="section-cb441-2"><a href="section-extended-example-world-population-data.html#section-cb441-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">3.358</span></span>
<span id="section-cb441-3"><a href="section-extended-example-world-population-data.html#section-cb441-3" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.778</span></span>
<span id="section-cb441-4"><a href="section-extended-example-world-population-data.html#section-cb441-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Y: observed world population</span></span>
<span id="section-cb441-5"><a href="section-extended-example-world-population-data.html#section-cb441-5" aria-hidden="true" tabindex="-1"></a>observedpop <span class="ot">&lt;-</span> worldpop <span class="sc">%&gt;%</span> <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&#39;WORLD&#39;</span>,year <span class="sc">==</span> <span class="dv">2010</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(population)</span>
<span id="section-cb441-6"><a href="section-extended-example-world-population-data.html#section-cb441-6" aria-hidden="true" tabindex="-1"></a>observedpop <span class="ot">&lt;-</span> observedpop <span class="sc">*</span> <span class="fl">1e-06</span> <span class="co"># Convert to billions, from thousands</span></span>
<span id="section-cb441-7"><a href="section-extended-example-world-population-data.html#section-cb441-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior mode</span></span>
<span id="section-cb441-8"><a href="section-extended-example-world-population-data.html#section-cb441-8" aria-hidden="true" tabindex="-1"></a>lambda_mode <span class="ot">&lt;-</span> (alpha <span class="sc">+</span> observedpop <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (beta <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="section-cb441-9"><a href="section-extended-example-world-population-data.html#section-cb441-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior mean</span></span>
<span id="section-cb441-10"><a href="section-extended-example-world-population-data.html#section-cb441-10" aria-hidden="true" tabindex="-1"></a>lambda_mean <span class="ot">&lt;-</span> (alpha <span class="sc">+</span> observedpop) <span class="sc">/</span> (beta <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="section-cb441-11"><a href="section-extended-example-world-population-data.html#section-cb441-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior median</span></span>
<span id="section-cb441-12"><a href="section-extended-example-world-population-data.html#section-cb441-12" aria-hidden="true" tabindex="-1"></a>lambda_med <span class="ot">&lt;-</span> <span class="fu">qgamma</span>(.<span class="dv">5</span>,alpha <span class="sc">+</span> observedpop,beta<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="section-cb441-13"><a href="section-extended-example-world-population-data.html#section-cb441-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at them all</span></span>
<span id="section-cb441-14"><a href="section-extended-example-world-population-data.html#section-cb441-14" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(</span>
<span id="section-cb441-15"><a href="section-extended-example-world-population-data.html#section-cb441-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;observed&#39;</span> <span class="ot">=</span> observedpop,</span>
<span id="section-cb441-16"><a href="section-extended-example-world-population-data.html#section-cb441-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;post_mode&#39;</span> <span class="ot">=</span> lambda_mode,</span>
<span id="section-cb441-17"><a href="section-extended-example-world-population-data.html#section-cb441-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;post_mean&#39;</span> <span class="ot">=</span> lambda_mean,</span>
<span id="section-cb441-18"><a href="section-extended-example-world-population-data.html#section-cb441-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;post_med&#39;</span> <span class="ot">=</span> lambda_med</span>
<span id="section-cb441-19"><a href="section-extended-example-world-population-data.html#section-cb441-19" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code> observed post_mode post_mean  post_med 
   6.9568    5.2389    5.8014    5.6150 </code></pre>
<p>Compare these to their corresponding <em>prior</em> values:</p>
<div class="sourceCode" id="section-cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb443-1"><a href="section-extended-example-world-population-data.html#section-cb443-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior params</span></span>
<span id="section-cb443-2"><a href="section-extended-example-world-population-data.html#section-cb443-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">3.358</span></span>
<span id="section-cb443-3"><a href="section-extended-example-world-population-data.html#section-cb443-3" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.778</span></span>
<span id="section-cb443-4"><a href="section-extended-example-world-population-data.html#section-cb443-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior mode</span></span>
<span id="section-cb443-5"><a href="section-extended-example-world-population-data.html#section-cb443-5" aria-hidden="true" tabindex="-1"></a>prior_mode <span class="ot">&lt;-</span> (alpha <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (beta)</span>
<span id="section-cb443-6"><a href="section-extended-example-world-population-data.html#section-cb443-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior mean</span></span>
<span id="section-cb443-7"><a href="section-extended-example-world-population-data.html#section-cb443-7" aria-hidden="true" tabindex="-1"></a>prior_mean <span class="ot">&lt;-</span> (alpha) <span class="sc">/</span> (beta)</span>
<span id="section-cb443-8"><a href="section-extended-example-world-population-data.html#section-cb443-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior median</span></span>
<span id="section-cb443-9"><a href="section-extended-example-world-population-data.html#section-cb443-9" aria-hidden="true" tabindex="-1"></a>prior_med <span class="ot">&lt;-</span> <span class="fu">qgamma</span>(.<span class="dv">5</span>,alpha,beta)</span>
<span id="section-cb443-10"><a href="section-extended-example-world-population-data.html#section-cb443-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at them all</span></span>
<span id="section-cb443-11"><a href="section-extended-example-world-population-data.html#section-cb443-11" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(</span>
<span id="section-cb443-12"><a href="section-extended-example-world-population-data.html#section-cb443-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;observed&#39;</span> <span class="ot">=</span> observedpop,</span>
<span id="section-cb443-13"><a href="section-extended-example-world-population-data.html#section-cb443-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;prior_mode&#39;</span> <span class="ot">=</span> prior_mode,</span>
<span id="section-cb443-14"><a href="section-extended-example-world-population-data.html#section-cb443-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;prior_mean&#39;</span> <span class="ot">=</span> prior_mean,</span>
<span id="section-cb443-15"><a href="section-extended-example-world-population-data.html#section-cb443-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;prior_med&#39;</span> <span class="ot">=</span> prior_med</span>
<span id="section-cb443-16"><a href="section-extended-example-world-population-data.html#section-cb443-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>  observed prior_mode prior_mean  prior_med 
    6.9568     3.0308     4.3162     3.8961 </code></pre>
<p>Each statistic is pulled towards its corresponding prior value. The skewness in
the Gamma distribution means that the mode and median are less than the mean.
The observed data affects not only the location but also the shape of the posterior
relative to the prior. The observed value being higher than the prior mean and
mode causes them to be pulled up, but the median is actually pulled down.</p>
<p>Since computing the posterior seems harder than working with a likelihood, and
since coming up with a point estimator based on the posterior seems harder than
maximizing a likelihood, you might be wondering why we’re bothering with Bayesian
inference at all. One compelling answer comes from <strong>uncertainty quantification</strong>.
Using the non-Bayesian methods, it was difficult to come up with a way to quantify
uncertainty. We did a lot of work and came up with an interval that “if you were
to repeat the experiment over and over and calculate many such intervals, <span class="math inline">\(95\%\)</span>
of them would cover the true value of the parameter.” This is difficult to explain
and interpret, and also, when you move into more complicated statistical procedures,
it becomes difficult or impossible to derive such a confidence interval. Because of this,
some of the most popular modern statistical procedures use Bayesian inference to
compute uncertainty estimates (even nominally frequentist techniques), or don’t
compute them at all. Since Statistics is the science of uncertainty, this means
Bayesian inference is a lot more mainstream than it might appear to be when taught
in introductory courses such as this.</p>
<p>The reason is that computing uncertainty intervals in Bayesian stats is, for the
most part, pretty straightforward. Uncertainty for <span class="math inline">\(\lambda|Y\)</span> is quantified by
means of a <strong>credible interval</strong>. A <span class="math inline">\(95\%\)</span> (or some other level) credible interval
is <em>any</em> pair of numbers <span class="math inline">\((L,U)\)</span> which satisfy
<span class="math display">\[
P(L \leq \lambda \leq U | Y) = 95\%.
\]</span>
The interpretation is straightforward: given the observed data, <span class="math inline">\(\lambda\)</span> has a
<span class="math inline">\(95\%\)</span> posterior probability of being between <span class="math inline">\(L\)</span> and <span class="math inline">\(U\)</span>.</p>
<p>You can use any <span class="math inline">\(L\)</span> and <span class="math inline">\(U\)</span> that satisfy this, but the common choice is to just
use the <span class="math inline">\(2.5\%\)</span> and <span class="math inline">\(97.5\%\)</span> posterior quantiles, in analogy to the construction
of frequentist confidence intervals. Less common but still sometimes done is to
compute one sided intervals, taking <span class="math inline">\(L\)</span> or <span class="math inline">\(U\)</span> to be the endpoint of the parameter
space (which might be <span class="math inline">\(\pm\infty\)</span>). Here are three calculations and visualizations
of posterior credible intervals:</p>
<div class="sourceCode" id="section-cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb445-1"><a href="section-extended-example-world-population-data.html#section-cb445-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lower interval</span></span>
<span id="section-cb445-2"><a href="section-extended-example-world-population-data.html#section-cb445-2" aria-hidden="true" tabindex="-1"></a>lowerint <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">qgamma</span>(.<span class="dv">95</span>,alpha<span class="sc">+</span>observedpop,beta<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="section-cb445-3"><a href="section-extended-example-world-population-data.html#section-cb445-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Upper interval</span></span>
<span id="section-cb445-4"><a href="section-extended-example-world-population-data.html#section-cb445-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Top point should be Inf, had to use big finite value for plotting</span></span>
<span id="section-cb445-5"><a href="section-extended-example-world-population-data.html#section-cb445-5" aria-hidden="true" tabindex="-1"></a>upperint <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">qgamma</span>(.<span class="dv">05</span>,alpha<span class="sc">+</span>observedpop,beta<span class="sc">+</span><span class="dv">1</span>),<span class="dv">15</span>) <span class="co"># Should be Inf</span></span>
<span id="section-cb445-6"><a href="section-extended-example-world-population-data.html#section-cb445-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Middle interval, most common</span></span>
<span id="section-cb445-7"><a href="section-extended-example-world-population-data.html#section-cb445-7" aria-hidden="true" tabindex="-1"></a>middleint <span class="ot">&lt;-</span> <span class="fu">qgamma</span>(<span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>),alpha<span class="sc">+</span>observedpop,beta<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="section-cb445-8"><a href="section-extended-example-world-population-data.html#section-cb445-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot them</span></span>
<span id="section-cb445-9"><a href="section-extended-example-world-population-data.html#section-cb445-9" aria-hidden="true" tabindex="-1"></a>baseplot <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">15</span>)) <span class="sc">%&gt;%</span></span>
<span id="section-cb445-10"><a href="section-extended-example-world-population-data.html#section-cb445-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="section-cb445-11"><a href="section-extended-example-world-population-data.html#section-cb445-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="section-cb445-12"><a href="section-extended-example-world-population-data.html#section-cb445-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dgamma,<span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape =</span> alpha<span class="sc">+</span>observedpop,<span class="at">rate =</span> beta<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="section-cb445-13"><a href="section-extended-example-world-population-data.html#section-cb445-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="section-cb445-14"><a href="section-extended-example-world-population-data.html#section-cb445-14" aria-hidden="true" tabindex="-1"></a>lowerplot <span class="ot">&lt;-</span> baseplot <span class="sc">+</span> </span>
<span id="section-cb445-15"><a href="section-extended-example-world-population-data.html#section-cb445-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dgamma,</span>
<span id="section-cb445-16"><a href="section-extended-example-world-population-data.html#section-cb445-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape =</span> alpha<span class="sc">+</span>observedpop,<span class="at">rate =</span> beta<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="section-cb445-17"><a href="section-extended-example-world-population-data.html#section-cb445-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> lowerint,</span>
<span id="section-cb445-18"><a href="section-extended-example-world-population-data.html#section-cb445-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;area&quot;</span>,</span>
<span id="section-cb445-19"><a href="section-extended-example-world-population-data.html#section-cb445-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="section-cb445-20"><a href="section-extended-example-world-population-data.html#section-cb445-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Lower one-sided 95% posterior credible interval&quot;</span>,</span>
<span id="section-cb445-21"><a href="section-extended-example-world-population-data.html#section-cb445-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(lambda),<span class="at">y =</span> <span class="st">&quot;Posterior Density&quot;</span>)</span>
<span id="section-cb445-22"><a href="section-extended-example-world-population-data.html#section-cb445-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="section-cb445-23"><a href="section-extended-example-world-population-data.html#section-cb445-23" aria-hidden="true" tabindex="-1"></a>upperplot <span class="ot">&lt;-</span> baseplot <span class="sc">+</span> </span>
<span id="section-cb445-24"><a href="section-extended-example-world-population-data.html#section-cb445-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dgamma,</span>
<span id="section-cb445-25"><a href="section-extended-example-world-population-data.html#section-cb445-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape =</span> alpha<span class="sc">+</span>observedpop,<span class="at">rate =</span> beta<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="section-cb445-26"><a href="section-extended-example-world-population-data.html#section-cb445-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> upperint,</span>
<span id="section-cb445-27"><a href="section-extended-example-world-population-data.html#section-cb445-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;area&quot;</span>,</span>
<span id="section-cb445-28"><a href="section-extended-example-world-population-data.html#section-cb445-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="section-cb445-29"><a href="section-extended-example-world-population-data.html#section-cb445-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Upper one-sided 95% posterior credible interval&quot;</span>,</span>
<span id="section-cb445-30"><a href="section-extended-example-world-population-data.html#section-cb445-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(lambda),<span class="at">y =</span> <span class="st">&quot;Posterior Density&quot;</span>)</span>
<span id="section-cb445-31"><a href="section-extended-example-world-population-data.html#section-cb445-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="section-cb445-32"><a href="section-extended-example-world-population-data.html#section-cb445-32" aria-hidden="true" tabindex="-1"></a>middleplot <span class="ot">&lt;-</span> baseplot <span class="sc">+</span> </span>
<span id="section-cb445-33"><a href="section-extended-example-world-population-data.html#section-cb445-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dgamma,</span>
<span id="section-cb445-34"><a href="section-extended-example-world-population-data.html#section-cb445-34" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape =</span> alpha<span class="sc">+</span>observedpop,<span class="at">rate =</span> beta<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="section-cb445-35"><a href="section-extended-example-world-population-data.html#section-cb445-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> middleint,</span>
<span id="section-cb445-36"><a href="section-extended-example-world-population-data.html#section-cb445-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;area&quot;</span>,</span>
<span id="section-cb445-37"><a href="section-extended-example-world-population-data.html#section-cb445-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="section-cb445-38"><a href="section-extended-example-world-population-data.html#section-cb445-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Two-sided 95% posterior credible interval&quot;</span>,</span>
<span id="section-cb445-39"><a href="section-extended-example-world-population-data.html#section-cb445-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(lambda),<span class="at">y =</span> <span class="st">&quot;Posterior Density&quot;</span>)</span>
<span id="section-cb445-40"><a href="section-extended-example-world-population-data.html#section-cb445-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="section-cb445-41"><a href="section-extended-example-world-population-data.html#section-cb445-41" aria-hidden="true" tabindex="-1"></a>lowerplot <span class="sc">/</span> middleplot <span class="sc">/</span> upperplot</span></code></pre></div>
<p><img src="book_files/figure-html/postquants1-1.png" width="672" /></p>
</div>
<div id="section-estimation-by-sampling" class="section level3" number="15.5.2">
<h3><span class="header-section-number">15.5.2</span> Estimation by sampling</h3>
<p>Usually in practice you won’t know the posterior distribution exactly, but
you might have a sample from it. Alternatively, you might just want to calculate
any estimates you want without having to do tedious math. Bayesian inference can
be done using only a sample from the posterior. In fact, this is very desirable:
all of your data analytic skills can be carried over and used for inference. We
will briefly touch on this here.</p>
<p>Suppose we have a sample from the posterior:</p>
<div class="sourceCode" id="section-cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb446-1"><a href="section-extended-example-world-population-data.html#section-cb446-1" aria-hidden="true" tabindex="-1"></a>sample_from_the_posterior <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">1000</span>,alpha<span class="sc">+</span>observedpop,beta<span class="sc">+</span><span class="dv">1</span>)</span></code></pre></div>
<p>You can compute an estimate of any quantity you like from this sample, without
having to do math. Check it out and compare to what we did before:</p>
<div class="sourceCode" id="section-cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb447-1"><a href="section-extended-example-world-population-data.html#section-cb447-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean</span></span>
<span id="section-cb447-2"><a href="section-extended-example-world-population-data.html#section-cb447-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(sample_from_the_posterior)</span></code></pre></div>
<pre><code>[1] 5.8378</code></pre>
<div class="sourceCode" id="section-cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb449-1"><a href="section-extended-example-world-population-data.html#section-cb449-1" aria-hidden="true" tabindex="-1"></a>lambda_mean</span></code></pre></div>
<pre><code>[1] 5.8014</code></pre>
<div class="sourceCode" id="section-cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb451-1"><a href="section-extended-example-world-population-data.html#section-cb451-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ok, the mode is a bit trickier (actually in practice this is the one</span></span>
<span id="section-cb451-2"><a href="section-extended-example-world-population-data.html#section-cb451-2" aria-hidden="true" tabindex="-1"></a><span class="co"># that I would always calculate using math or brute-force optimization):</span></span>
<span id="section-cb451-3"><a href="section-extended-example-world-population-data.html#section-cb451-3" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">round</span>(sample_from_the_posterior,<span class="dv">3</span>)</span>
<span id="section-cb451-4"><a href="section-extended-example-world-population-data.html#section-cb451-4" aria-hidden="true" tabindex="-1"></a>sst <span class="ot">&lt;-</span> <span class="fu">table</span>(ss)</span>
<span id="section-cb451-5"><a href="section-extended-example-world-population-data.html#section-cb451-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sst[sst <span class="sc">==</span> <span class="fu">max</span>(sst)])</span></code></pre></div>
<pre><code>[1] &quot;4.589&quot; &quot;4.671&quot; &quot;5.706&quot; &quot;6.593&quot;</code></pre>
<div class="sourceCode" id="section-cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb453-1"><a href="section-extended-example-world-population-data.html#section-cb453-1" aria-hidden="true" tabindex="-1"></a>lambda_mode</span></code></pre></div>
<pre><code>[1] 5.2389</code></pre>
<div class="sourceCode" id="section-cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb455-1"><a href="section-extended-example-world-population-data.html#section-cb455-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Difficult to calculate and not that accurate</span></span>
<span id="section-cb455-2"><a href="section-extended-example-world-population-data.html#section-cb455-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Everything else is pretty good though:</span></span>
<span id="section-cb455-3"><a href="section-extended-example-world-population-data.html#section-cb455-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantiles and median</span></span>
<span id="section-cb455-4"><a href="section-extended-example-world-population-data.html#section-cb455-4" aria-hidden="true" tabindex="-1"></a>mm <span class="ot">&lt;-</span> <span class="fu">median</span>(sample_from_the_posterior)</span>
<span id="section-cb455-5"><a href="section-extended-example-world-population-data.html#section-cb455-5" aria-hidden="true" tabindex="-1"></a>q2<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">quantile</span>(sample_from_the_posterior,.<span class="dv">025</span>)</span>
<span id="section-cb455-6"><a href="section-extended-example-world-population-data.html#section-cb455-6" aria-hidden="true" tabindex="-1"></a>q97<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">quantile</span>(sample_from_the_posterior,.<span class="dv">975</span>)</span>
<span id="section-cb455-7"><a href="section-extended-example-world-population-data.html#section-cb455-7" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(q2<span class="fl">.5</span>,mm,q97<span class="fl">.5</span>)</span></code></pre></div>
<pre><code>  2.5%         97.5% 
2.8977 5.7171 9.9938 </code></pre>
<div class="sourceCode" id="section-cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb457-1"><a href="section-extended-example-world-population-data.html#section-cb457-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(middleint[<span class="dv">1</span>],lambda_med,middleint[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>[1] 2.8194 5.6150 9.8411</code></pre>
<p>Sample-based Bayesian inference is a subject of entire upper year courses!</p>
<p><strong>Exercise</strong>: these estimates and intervals are for the entire world population,
and for 2010. Do the following:</p>
<ul>
<li><p>Pick any country, and year (perhaps the current year, or the year you were born or first
attended university),</p></li>
<li><p>Use Bayesian inference to estimate the population of that country in that year.
Come up with a suitable prior (still use the Gamma, but change the parameters),
and give a point and interval estimate based upon the posterior distribution.</p></li>
</ul>
</div>
</div>
<div id="section-predicting-world-population" class="section level2" number="15.6">
<h2><span class="header-section-number">15.6</span> Predicting world population</h2>
<p>Finally, let’s predict world population through 2100 and see how our results
compare to the predictions given by the WHO.</p>
<p>In section 1 of this chapter we read in the files containing the WHO’s predictions
for world population until 2100:</p>
<div class="sourceCode" id="section-cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb459-1"><a href="section-extended-example-world-population-data.html#section-cb459-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(worldpop_pred)</span></code></pre></div>
<pre><code>Rows: 4,012
Columns: 5
$ country            &lt;chr&gt; &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;WORLD&quot;, &quot;Burundi&quot;, &quot;Burundi&quot;, &quot;Bu…
$ year               &lt;dbl&gt; 2020, 2025, 2030, 2035, 2040, 2045, 2050, 2055, 2060, 2065, 2070, 2075, 2080, 2085, 2090, 2095, 2100, 2020, 2025, 2030, 2035, 2040, 2045, 2050, 2055, 2060, 2065, 2070, 2075, 2080…
$ population         &lt;dbl&gt; 7794799, 8184437, 8548487, 8887524, 9198847, 9481803, 9735034, 9958099, 10151470, 10317879, 10459240, 10577288, 10673904, 10750662, 10809892, 10851860, 10875394, 11891, 13764, 15…
$ population_lower95 &lt;dbl&gt; 7794799, 8144343, 8460182, 8746077, 8996324, 9213142, 9396006, 9534887, 9636991, 9703980, 9739584, 9748508, 9726522, 9677887, 9618846, 9529601, 9424391, 11891, 13554, 15194, 1679…
$ population_upper95 &lt;dbl&gt; 7794799, 8223574, 8636041, 9029502, 9396987, 9744879, 10078535, 10392599, 10690489, 10976553, 11243358, 11500320, 11743120, 11988844, 12227664, 12448936, 12663070, 11891, 13960, …</code></pre>
<p>The <code>population</code> variable contains their predicted world population for each <code>year</code>
and the <code>population_lower95</code> and <code>population_upper95</code> contain the endpoints of
a <span class="math inline">\(95\%\)</span> prediction interval for population. Let’s plot their predictions:</p>
<div class="sourceCode" id="section-cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb461-1"><a href="section-extended-example-world-population-data.html#section-cb461-1" aria-hidden="true" tabindex="-1"></a>whopredplot <span class="ot">&lt;-</span> worldpop_pred <span class="sc">%&gt;%</span></span>
<span id="section-cb461-2"><a href="section-extended-example-world-population-data.html#section-cb461-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&#39;WORLD&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="section-cb461-3"><a href="section-extended-example-world-population-data.html#section-cb461-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year)) <span class="sc">+</span></span>
<span id="section-cb461-4"><a href="section-extended-example-world-population-data.html#section-cb461-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="section-cb461-5"><a href="section-extended-example-world-population-data.html#section-cb461-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> population<span class="sc">*</span><span class="fl">1e-06</span>)) <span class="sc">+</span></span>
<span id="section-cb461-6"><a href="section-extended-example-world-population-data.html#section-cb461-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> population_lower95<span class="sc">*</span><span class="fl">1e-06</span>,<span class="at">ymax =</span> population_upper95<span class="sc">*</span><span class="fl">1e-06</span>),<span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="section-cb461-7"><a href="section-extended-example-world-population-data.html#section-cb461-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;WHO predicted world population with 95% prediction interval&quot;</span>,</span>
<span id="section-cb461-8"><a href="section-extended-example-world-population-data.html#section-cb461-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="section-cb461-9"><a href="section-extended-example-world-population-data.html#section-cb461-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;World population (Billions)&quot;</span>)</span>
<span id="section-cb461-10"><a href="section-extended-example-world-population-data.html#section-cb461-10" aria-hidden="true" tabindex="-1"></a>whopredplot</span></code></pre></div>
<p><img src="book_files/figure-html/plotwhopred1-1.png" width="672" />
It doesn’t look like the WHO used a simple linear model like we did. We can plot
<em>our</em> predictions with their associated prediction intervals like this:</p>
<div class="sourceCode" id="section-cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb462-1"><a href="section-extended-example-world-population-data.html#section-cb462-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict for the same years as the WHO</span></span>
<span id="section-cb462-2"><a href="section-extended-example-world-population-data.html#section-cb462-2" aria-hidden="true" tabindex="-1"></a>datatopredict <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">sort</span>(<span class="fu">unique</span>(worldpop_pred<span class="sc">$</span>year)))</span>
<span id="section-cb462-3"><a href="section-extended-example-world-population-data.html#section-cb462-3" aria-hidden="true" tabindex="-1"></a>preddat <span class="ot">&lt;-</span> <span class="fu">predict</span>(diffmod,<span class="at">newdata =</span> datatopredict,<span class="at">se.fit =</span> <span class="cn">TRUE</span>,<span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)<span class="sc">$</span>fit <span class="sc">%&gt;%</span></span>
<span id="section-cb462-4"><a href="section-extended-example-world-population-data.html#section-cb462-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="section-cb462-5"><a href="section-extended-example-world-population-data.html#section-cb462-5" aria-hidden="true" tabindex="-1"></a>preddat<span class="sc">$</span>year <span class="ot">&lt;-</span> datatopredict<span class="sc">$</span>year</span>
<span id="section-cb462-6"><a href="section-extended-example-world-population-data.html#section-cb462-6" aria-hidden="true" tabindex="-1"></a>worldpoppred <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(datatopredict,preddat,<span class="at">by =</span> <span class="st">&quot;year&quot;</span>)</span>
<span id="section-cb462-7"><a href="section-extended-example-world-population-data.html#section-cb462-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(worldpoppred)</span></code></pre></div>
<pre><code>Rows: 17
Columns: 4
$ year &lt;dbl&gt; 2020, 2025, 2030, 2035, 2040, 2045, 2050, 2055, 2060, 2065, 2070, 2075, 2080, 2085, 2090, 2095, 2100
$ fit  &lt;dbl&gt; 7692970, 8082354, 8471738, 8861122, 9250505, 9639889, 10029273, 10418657, 10808041, 11197425, 11586808, 11976192, 12365576, 12754960, 13144344, 13533728, 13923111
$ lwr  &lt;dbl&gt; 7493772, 7881972, 8270023, 8657928, 9045689, 9433310, 9820795, 10208147, 10595371, 10982469, 11369446, 11756306, 12143054, 12529692, 12916224, 13302656, 13688990
$ upr  &lt;dbl&gt; 7892168, 8282736, 8673452, 9064315, 9455322, 9846468, 10237751, 10629167, 11020711, 11412380, 11804171, 12196078, 12588099, 12980228, 13372463, 13764799, 14157233</code></pre>
<div class="sourceCode" id="section-cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="section-cb464-1"><a href="section-extended-example-world-population-data.html#section-cb464-1" aria-hidden="true" tabindex="-1"></a>predplotpredint <span class="ot">&lt;-</span> worldpoppred <span class="sc">%&gt;%</span></span>
<span id="section-cb464-2"><a href="section-extended-example-world-population-data.html#section-cb464-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year,<span class="at">y =</span> fit)) <span class="sc">+</span></span>
<span id="section-cb464-3"><a href="section-extended-example-world-population-data.html#section-cb464-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="section-cb464-4"><a href="section-extended-example-world-population-data.html#section-cb464-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Shaded region for the interval</span></span>
<span id="section-cb464-5"><a href="section-extended-example-world-population-data.html#section-cb464-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lwr,<span class="at">ymax =</span> upr),<span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="section-cb464-6"><a href="section-extended-example-world-population-data.html#section-cb464-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="section-cb464-7"><a href="section-extended-example-world-population-data.html#section-cb464-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="section-cb464-8"><a href="section-extended-example-world-population-data.html#section-cb464-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;World population with estimate and 95% PI&quot;</span>,</span>
<span id="section-cb464-9"><a href="section-extended-example-world-population-data.html#section-cb464-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="section-cb464-10"><a href="section-extended-example-world-population-data.html#section-cb464-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;World Population (Billions)&quot;</span>) <span class="sc">+</span></span>
<span id="section-cb464-11"><a href="section-extended-example-world-population-data.html#section-cb464-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2020</span>,<span class="dv">2100</span>,<span class="at">by=</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="section-cb464-12"><a href="section-extended-example-world-population-data.html#section-cb464-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) x<span class="sc">*</span><span class="fl">1e-06</span>,<span class="at">breaks =</span> (<span class="dv">8</span><span class="sc">:</span><span class="dv">14</span>)<span class="sc">*</span><span class="fl">1e06</span>)</span>
<span id="section-cb464-13"><a href="section-extended-example-world-population-data.html#section-cb464-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="section-cb464-14"><a href="section-extended-example-world-population-data.html#section-cb464-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="section-cb464-15"><a href="section-extended-example-world-population-data.html#section-cb464-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="section-cb464-16"><a href="section-extended-example-world-population-data.html#section-cb464-16" aria-hidden="true" tabindex="-1"></a>predplotpredint <span class="sc">|</span> whopredplot</span></code></pre></div>
<p><img src="book_files/figure-html/plotourpreds1-1.png" width="672" />
Our model is simpler than whatever the WHO did: we predict that population is
going to go up by the same amount each year for the next 80 years. Does that seem
reasonable? Because we impose such a stringent assumption on the phenomenon
we’re trying to model, we get really confident predictions, as measured by the
width of the prediction interval. But, this is not necessarily good: we might be
confidently incorrect! We probably are; the WHO knows what they are doing, and they
built a model which allows for a curvy relationship between time and population,
but with much wider uncertainty bands. Predictive modelling is an art as well as
a science.</p>
<p><strong>Exercise</strong>: try it yourself. Use our previous “log” model which assumed a constant
<em>rate</em> of population growth over time. I got the following:</p>
<pre><code>Rows: 17
Columns: 4
$ year &lt;dbl&gt; 2020, 2025, 2030, 2035, 2040, 2045, 2050, 2055, 2060, 2065, 2070, 2075, 2080, 2085, 2090, 2095, 2100
$ fit  &lt;dbl&gt; 15.939, 16.022, 16.104, 16.186, 16.269, 16.351, 16.433, 16.515, 16.598, 16.680, 16.762, 16.845, 16.927, 17.009, 17.092, 17.174, 17.256
$ lwr  &lt;dbl&gt; 15.874, 15.956, 16.038, 16.120, 16.201, 16.283, 16.365, 16.446, 16.528, 16.610, 16.691, 16.773, 16.854, 16.936, 17.017, 17.098, 17.180
$ upr  &lt;dbl&gt; 16.005, 16.087, 16.170, 16.253, 16.336, 16.419, 16.502, 16.584, 16.668, 16.751, 16.834, 16.917, 17.000, 17.083, 17.166, 17.250, 17.333</code></pre>
<p><img src="book_files/figure-html/plotourpreds2-1.png" width="672" />
Woah! This model looks even worse. However, it is a bit more flexible (just a bit) than
the simple linear model, and the prediction interval is even wider.</p>
<p><strong>Exercise</strong>: pick your favourite country and year, and predict its population to
2100 and compare with the WHO. Are your predictions more or less reasonable than
what we did for the total world population?</p>
<div id="section-why-arent-our-predictions-accurate" class="section level3" number="15.6.1">
<h3><span class="header-section-number">15.6.1</span> Why aren’t our predictions accurate?</h3>
<p>The WHO uses decades (centuries?) of demographic theory and research, combined
with data on mortality, fertility, and other demographic factors to make its
predictions. They are constantly changing as new information and theories become
available. In contrast, we just took some numbers and plugged them into a textbook
statistical procedure. It would be troubling if we got anything remotely comparable
to what the WHO got using this approach.</p>
<p>Keep this in mind as you approach your future projects and industry or academic
work. This example was useful for teaching the mechanics of prediction, but
there is an upper limit to how good you can get without domain-specific knowledge
and additional data sources. In upper year courses you’ll learn about new types
of fancy predictive (and other) models, which is great, but it always always always
pays to think about the problem harder too! Better statistical techniques are
not a replacement for better science.</p>
<p>With that, you’re done STA238. Hope you enjoyed the course, and maybe see you
in future courses too :).</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="section-assigned-exercises-from-mips.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="section-short-tutorial-on-pulling-data-for-assignment-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book.pdf", "book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
